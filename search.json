[{"path":"index.html","id":"introduction","chapter":"üìñ Introduction","heading":"üìñ Introduction","text":"\n\n\n\n\n\nhello","code":""},{"path":"index.html","id":"motivation","chapter":"üìñ Introduction","heading":"üéØ Motivation","text":"book meant guide mining biological knowledge elucidate interpret molecular mechanisms using suite R packages, including ChIPseeker, clusterProfiler, DOSE, enrichplot, GOSemSim, meshes ReactomePA. Hence, starting read book, assume working knowledge use R.","code":""},{"path":"index.html","id":"citation","chapter":"üìñ Introduction","heading":"üìù Citation","text":"use software suite published research, please cite appropriate paper(s) list:T Wu#, E Hu#, S Xu, M Chen, P Guo, Z Dai, T Feng, L Zhou, W Tang, L Zhan, X Fu, S Liu, X Bo*, G Yu*. clusterProfiler 4.0: universal enrichment tool interpreting omics data. Innovation. 2021, 2(3):100141.\ndoi: 10.1016/j.xinn.2021.100141G Yu*. Gene Ontology Semantic Similarity Analysis Using GOSemSim. : Kidder B. (eds) Stem Cell Transcriptional Networks. Methods Molecular Biology. 2020, 2117:207-215. Humana, New York, NY.\ndoi: 10.1007/978-1-0716-0301-7_11G Yu*. Using meshes MeSH term enrichment semantic analyses. Bioinformatics. 2018, 34(21):3766‚Äì3767.\ndoi: 10.1093/bioinformatics/bty410G Yu, QY *. ReactomePA: R/Bioconductor package reactome pathway analysis visualization. Molecular BioSystems. 2016, 12(2):477-479.\ndoi: 10.1039/C5MB00663EG Yu*, LG Wang, QY *. ChIPseeker: R/Bioconductor package ChIP peak annotation, comparison visualization. Bioinformatics. 2015, 31(14):2382-2383.\ndoi: 10.1093/bioinformatics/btv145G Yu*, LG Wang, GR Yan, QY *. DOSE: R/Bioconductor package Disease Ontology Semantic Enrichment analysis. Bioinformatics. 2015, 31(4):608-609.\ndoi: 10.1093/bioinformatics/btu684G Yu, LG Wang, Y Han QY *. clusterProfiler: R package comparing biological themes among gene clusters. OMICS: Journal Integrative Biology. 2012, 16(5):284-287.\ndoi: 10.1089/omi.2011.0118G Yu, F Li, Y Qin, X Bo*, Y Wu, S Wang*. GOSemSim: R package measuring semantic similarity among GO terms gene products. Bioinformatics. 2010, 26(7):976-978.\ndoi: 10.1093/bioinformatics/btq064","code":""},{"path":"index.html","id":"book-structure","chapter":"üìñ Introduction","heading":"üìö Book structure","text":"Part 1 (Semantic similarity analysis) describes GOSemSim, DOSE meshes packages measuring semantic similarity genes gene products based Gene Ontology, Disease Ontology Medical Subject Headings.Part 2 (Enrichment analysis) introduces -reprensentation analysis gene set enrichment analysis using clusterProfiler (supports GO, KEGG, MSigDb, WikiPathway, many others via universal interface), DOSE (, Disease-Gene Network, Network Cancer Genes), meshes (MeSH), ReactomePA (Reactome pathway). Functional enrichment analysis Genomic coordination supported via ChIPseeker comparison among multiple conditions also supported clusterProfiler. implemented number visualization methods enrichplot package help users interpret results.Part 3 (Miscellaneous topics) describes useful utilities including translating gene IDs manipulating enrichment results.","code":""},{"path":"index.html","id":"want-to-help","chapter":"üìñ Introduction","heading":"üíñ Want to help?","text":"book‚Äôs source code hosted GitHub, https://github.com/YuLab-SMU/biomedical-knowledge-mining-book. feedback book welcome. Feel free open issue GitHub send pull request notice typos issues (‚Äôm native English speaker ;) ).","code":""},{"path":"semantic-similarity-overview.html","id":"semantic-similarity-overview","chapter":"1 Overview of semantic similarity analysis","heading":"1 Overview of semantic similarity analysis","text":"Functional similarity gene products can estimated controlled\nbiological vocabularies, Gene Ontology (GO), Disease Ontology () Medical Subject Headings (MeSH).Four methods including Resnik (Philip 1999), Jiang (Jiang Conrath 1997), Lin (Lin 1998) Schlicker (Schlicker et al. 2006) presented determine semantic similarity two GO terms based annotation statistics common ancestor terms. Wang (Wang et al. 2007)\nproposed method measure similarity based graph structure GO. methods advantages \nweaknesses can applied ontologies similar structure (.e.¬†directed acyclic graph).","code":""},{"path":"semantic-similarity-overview.html","id":"information-content-based-methods","chapter":"1 Overview of semantic similarity analysis","heading":"1.1 Information content-based methods","text":"Four methods proposed Resnik (Philip 1999),\nJiang (Jiang Conrath 1997), Lin (Lin 1998)\nSchlicker (Schlicker et al. 2006) information content (IC) based, depend frequencies two GO terms involved closest common ancestor term specific corpus GO\nannotations. information content GO term computed \nnegative log probability term occurring GO corpus. rarely used term contains greater amount information.frequency term t defined :\\[p(t) = \\frac{n_{t'}}{N} | t' \\\\left\\{t, \\; children\\: \\: t \\right\\}\\]\\(n_{t'}\\) number term \\(t'\\), \\(N\\) total number terms GO corpus.Thus information content defined :\\[IC(t) = -\\log(p(t))\\]GO allow multiple parents concept, two terms can share\nparents multiple paths. IC-based methods calculate similarity two GO terms based information content closest common ancestor term, also called informative common ancestor (MICA).","code":""},{"path":"semantic-similarity-overview.html","id":"resnik-method","chapter":"1 Overview of semantic similarity analysis","heading":"1.1.1 Resnik method","text":"Resnik method defined :\\[sim_{Resnik}(t_1,t_2) = IC(MICA)\\]","code":""},{"path":"semantic-similarity-overview.html","id":"lin-method","chapter":"1 Overview of semantic similarity analysis","heading":"1.1.2 Lin method","text":"Lin method defined :\\[sim_{Lin}(t_1,t_2) = \\frac{2IC(MICA)}{IC(t_1)+IC(t_2)}\\]","code":""},{"path":"semantic-similarity-overview.html","id":"rel-method","chapter":"1 Overview of semantic similarity analysis","heading":"1.1.3 Rel method","text":"Relevance method, proposed Schlicker, combine Resnik‚Äôs Lin‚Äôs method defined :\\[sim_{Rel}(t_1,t_2) = \\frac{2IC(MICA)(1-p(MICA))}{IC(t_1)+IC(t_2)}\\]","code":""},{"path":"semantic-similarity-overview.html","id":"jiang-method","chapter":"1 Overview of semantic similarity analysis","heading":"1.1.4 Jiang method","text":"Jiang Conrath‚Äôs method defined :\\[sim_{Jiang}(t_1,t_2) = 1-\\min(1, IC(t_1) + IC(t_2) - 2IC(MICA))\\]","code":""},{"path":"semantic-similarity-overview.html","id":"graph-based-method","chapter":"1 Overview of semantic similarity analysis","heading":"1.2 Graph-based method","text":"Graph-based methods using topology GO graph structure \ncompute semantic similarity. Formally, GO term can represented\n\\(DAG_{}=(,T_{},E_{})\\) \\(T_{}\\) set GO terms \n\\(DAG_{}\\), including term ancestor terms GO\ngraph, \\(E_{}\\) set edges connecting GO terms \n\\(DAG_{}\\).","code":""},{"path":"semantic-similarity-overview.html","id":"wang-method","chapter":"1 Overview of semantic similarity analysis","heading":"1.2.1 Wang method","text":"encode semantic GO term measurable format enable quantitative comparison, Wang(Wang et al. 2007) firstly defined semantic value term aggregate contribution terms \\(DAG_{}\\) semantics term , terms closer term \\(DAG_{}\\) contribute semantics. Thus, defined contribution GO term \\(t\\) semantic GO term \\(\\) S-value GO term \\(t\\) related term \\(\\).term \\(t\\) \\(DAG_{}\\), S-value related term \\(\\), \\(S_{}(\\textit{t})\\) defined :\\[\\left\\{\\begin{array}{l} S_{}()=1 \\\\ S_{}(\\textit{t})=\\max\\{w_{e} \\times S_{}(\\textit{t}') | \\textit{t}' \\children \\: (\\textit{t}) \\} \\; \\: \\textit{t} \\ne \\end{array} \\right.\\]\\(w_{e}\\) semantic contribution factor edge \\(e \\E_{}\\) linking term \\(t\\) child term \\(t'\\).\nTerm \\(\\) contributes defined 1. obtaining S-values terms \\(DAG_{}\\),\nsemantic value term , \\(SV()\\), calculated :\\[SV()=\\displaystyle\\sum_{t \\T_{}} S_{}(t)\\]Thus given two GO terms B, semantic similarity two terms defined :\\[sim_{Wang}(, B) = \\frac{\\displaystyle\\sum_{t \\T_{} \\cap T_{B}}{S_{}(t) + S_{B}(t)}}{SV() + SV(B)}\\]\\(S_{}(\\textit{t})\\) S-value GO term \\(t\\) related term \\(\\)\n\\(S_{B}(\\textit{t})\\) S-value GO term \\(t\\) related term \\(B\\).method proposed Wang (Wang et al. 2007) determines semantic\nsimilarity two GO terms based locations terms\nGO graph relations ancestor terms.","code":""},{"path":"semantic-similarity-overview.html","id":"combine-methods","chapter":"1 Overview of semantic similarity analysis","heading":"1.3 Combine methods","text":"Since gene product can annotated multiple GO terms, semantic similarity among gene products needs aggregated different semantic similarity scores multiple GO terms associated genes, including max, avg, rcmax BMA.","code":""},{"path":"semantic-similarity-overview.html","id":"max","chapter":"1 Overview of semantic similarity analysis","heading":"1.3.1 max","text":"max method calculates maximum semantic similarity score pairs GO terms two GO term sets.\\[sim_{max}(g_1, g_2) = \\displaystyle\\max_{1 \\le \\le m, 1 \\le j \\le n} sim(go_{1i}, go_{2j})\\]","code":""},{"path":"semantic-similarity-overview.html","id":"avg","chapter":"1 Overview of semantic similarity analysis","heading":"1.3.2 avg","text":"avg calculates average semantic similarity score pairs GO terms.\\[sim_{avg}(g_1, g_2) = \\frac{\\displaystyle\\sum_{=1}^m\\sum_{j=1}^nsim(go_{1i}, go_{2j})}{m \\times n}\\]","code":""},{"path":"semantic-similarity-overview.html","id":"rcmax","chapter":"1 Overview of semantic similarity analysis","heading":"1.3.3 rcmax","text":"Similarities among two sets GO terms form matrix, rcmax method uses maximum RowScore ColumnScore, RowScore (ColumnScore) average maximum similarity row (column).\\[sim_{rcmax}(g_1, g_2) = \\max(\\frac{\\displaystyle\\sum_{=1}^m \\max_{1 \\le j \\le n} sim(go_{1i}, go_{2j})}{m},\\frac{\\displaystyle\\sum_{j=1}^n \\max_{1 \\le \\le m} sim(go_{1i},go_{2j})}{n})\\]","code":""},{"path":"semantic-similarity-overview.html","id":"bma","chapter":"1 Overview of semantic similarity analysis","heading":"1.3.4 BMA","text":"BMA method, used Best-Match Average strategy, calculates average maximum similarities row column, defined :\\[sim_{BMA}(g_1, g_2) = \\frac{\\displaystyle\\sum_{1=}^m \\max_{1 \\le j \\le n}sim(go_{1i}, go_{2j}) + \\displaystyle\\sum_{1=j}^n \\max_{1 \\le \\le m}sim(go_{1i}, go_{2j})} {m+n}\\]","code":""},{"path":"semantic-similarity-overview.html","id":"summary","chapter":"1 Overview of semantic similarity analysis","heading":"1.4 Summary","text":"idea behind semantic similarity measurement notion genes similar function similar annotation vocabulary close relationship ontology strucutre. Measuring similarity critical expanding knownledge, since similar objects tend behave similarly, supports many bioinformatics applications infer gene/protein functions, miRNA function, genetic interaction, protein-protein interaction, miRNA-mRNA interaction celluar localization.developed several Bioconductor packages, including GOSemSim (Yu et al. 2010; Yu 2020) computing semantic similarity among GO terms, sets GO terms, gene products gene clusters (see also Chapter 2), DOSE (Yu et al. 2015) Disease Ontology () (see also Chapter 3) meshes (Yu 2018) based Medical Subject Headings (MeSH) (see also Chapter 4).","code":""},{"path":"GOSemSim.html","id":"GOSemSim","chapter":"2 GO semantic similarity analysis","heading":"2 GO semantic similarity analysis","text":"GOSemSim implemented methods described Chapter 1, including four IC-based methods one graph-based method.","code":""},{"path":"GOSemSim.html","id":"semantic-data","chapter":"2 GO semantic similarity analysis","heading":"2.1 Semantic data","text":"measure semantic similarity, need prepare GO annotations including GO structure (.e.¬†GO term relationships) gene GO mapping. IC-based methods, information GO term species specific. need calculate IC GO terms species measure semantic similarity.GOSemSim provides godata() function prepare semantic data support measuring GO gene simiarlity. internally used GO.db package obtain GO strucuture OrgDb gene GO mapping.User can set computeIC=FALSE want use Wang‚Äôs method.","code":"\nlibrary(GOSemSim)\nhsGO <- godata('org.Hs.eg.db', ont=\"MF\")"},{"path":"GOSemSim.html","id":"gosemsim-supported-organisms","chapter":"2 GO semantic similarity analysis","heading":"2.2 Supported organisms","text":"GOSemSim supports organisms OrgDb object available.Bioconductor already provided OrgDb 20 species.can query OrgDb online via AnnotationHub package. example:organism supported AnnotationHub, user can use AnnotationForge package build OrgDb manually.OrgDb, can build annotation data needed GOSemSim via godata() function described previously.","code":"\nlibrary(AnnotationHub)\nhub <- AnnotationHub()\nq <- query(hub, \"Cricetulus\")\nid <- q$ah_id[length(q)]\nCgriseus <- hub[[id]]"},{"path":"GOSemSim.html","id":"go-semantic-simiarlity","chapter":"2 GO semantic similarity analysis","heading":"2.3 GO semantic similarity measurement","text":"goSim() function calculates semantic similarity two GO terms, mgoSim() function calculates semantic similarity two sets GO terms.","code":"\ngoSim(\"GO:0004022\", \"GO:0005515\", semData=hsGO, measure=\"Jiang\")## [1] 0.16\ngoSim(\"GO:0004022\", \"GO:0005515\", semData=hsGO, measure=\"Wang\")## [1] 0.116\ngo1 = c(\"GO:0004022\",\"GO:0004024\",\"GO:0004174\")\ngo2 = c(\"GO:0009055\",\"GO:0005515\")\nmgoSim(go1, go2, semData=hsGO, measure=\"Wang\", combine=NULL)##            GO:0009055 GO:0005515\n## GO:0004022      0.368      0.116\n## GO:0004024      0.335      0.107\n## GO:0004174      0.663      0.119\nmgoSim(go1, go2, semData=hsGO, measure=\"Wang\", combine=\"BMA\")## [1] 0.43"},{"path":"GOSemSim.html","id":"gene-go-semantic-similarity","chapter":"2 GO semantic similarity analysis","heading":"2.4 Gene semantic similarity measurement","text":"basis semantic similarity GO terms, GOSemSim can\nalso compute semantic similarity among sets GO terms, gene products, gene clusters.Suppose gene \\(g_1\\) annotated GO terms sets \\(GO_{1}=\\{go_{11},go_{12} \\cdots go_{1m}\\}\\)\n\\(g_2\\) annotated \\(GO_{2}=\\{go_{21},go_{22} \\cdots go_{2n}\\}\\), GOSemSim implemented four combine methods, including max, avg, rcmax, BMA, aggregate semantic similarity scores multiple GO terms (see also session 1.3). similarities\namong gene products gene clusters annotated multiple GO\nterms also calculated combine methods.GOSemSim provides geneSim() calculate semantic similarity two gene products, mgeneSim() calculate semantic similarity among multiple gene products.default, godata function use ENTREZID keytype, input ID type ENTREZID. User can use ID types ENSEMBL, UNIPROT, REFSEQ, ACCNUM, SYMBOL et al.example, use SYMBOL keytype calculate semantic similarities among several genes using gene symbol input.Users can also use clusterProfiler::bitr translate biological IDs.","code":"\ngeneSim(\"241\", \"251\", semData=hsGO, measure=\"Wang\", combine=\"BMA\")## $geneSim\n## [1] 0.149\n## \n## $GO1\n## [1] \"GO:0004364\" \"GO:0004464\" \"GO:0004602\" \"GO:0005515\" \"GO:0047485\"\n## [6] \"GO:0050544\"\n## \n## $GO2\n## [1] \"GO:0004035\"\nmgeneSim(genes=c(\"835\", \"5261\",\"241\", \"994\"),\n         semData=hsGO, measure=\"Wang\",verbose=FALSE)##        835  5261   241   994\n## 835  1.000 0.478 0.451 0.578\n## 5261 0.478 1.000 0.433 0.499\n## 241  0.451 0.433 1.000 0.452\n## 994  0.578 0.499 0.452 1.000\nmgeneSim(genes=c(\"835\", \"5261\",\"241\", \"994\"),\n       semData=hsGO, measure=\"Rel\",verbose=FALSE)##        835  5261   241   994\n## 835  0.946 0.404 0.253 0.480\n## 5261 0.404 0.906 0.328 0.469\n## 241  0.253 0.328 0.940 0.271\n## 994  0.480 0.469 0.271 0.906\nhsGO2 <- godata('org.Hs.eg.db', keytype = \"SYMBOL\", ont=\"MF\", computeIC=FALSE) \ngenes <- c(\"CDC45\", \"MCM10\", \"CDC20\", \"NMU\", \"MMP1\")\nmgeneSim(genes, semData=hsGO2, measure=\"Wang\", combine=\"BMA\", verbose=FALSE)##       CDC45 MCM10 CDC20   NMU  MMP1\n## CDC45 1.000 0.916 0.578 0.592 0.117\n## MCM10 0.916 1.000 0.605 0.620 0.113\n## CDC20 0.578 0.605 1.000 0.640 0.121\n## NMU   0.592 0.620 0.640 1.000 0.108\n## MMP1  0.117 0.113 0.121 0.108 1.000"},{"path":"GOSemSim.html","id":"gene-cluster-go-semantic-similarity","chapter":"2 GO semantic similarity analysis","heading":"2.5 Gene cluster semantic similarity measurement","text":"GOSemSim also supports calculating semantic similarity two gene clusters using clusterSim() function measuring semantic similarity among multiple gene clusters using mclusterSim() function.","code":"\ngs1 <- c(\"835\", \"5261\",\"241\", \"994\", \"514\", \"533\")\ngs2 <- c(\"578\",\"582\", \"400\", \"409\", \"411\")\nclusterSim(gs1, gs2, semData=hsGO, measure=\"Wang\", combine=\"BMA\")## [1] 0.613\nlibrary(org.Hs.eg.db)\nx <- org.Hs.egGO\nhsEG <- mappedkeys(x)\nset.seed <- 123\nclusters <- list(a=sample(hsEG, 20), b=sample(hsEG, 20), c=sample(hsEG, 20))\nmclusterSim(clusters, semData=hsGO, measure=\"Wang\", combine=\"BMA\")##       a     b     c\n## a 1.000 0.744 0.556\n## b 0.744 1.000 0.630\n## c 0.556 0.630 1.000"},{"path":"DOSE-semantic-similarity.html","id":"DOSE-semantic-similarity","chapter":"3 DO semantic similarity analysis","heading":"3 DO semantic similarity analysis","text":"Public health important driving force behind biological medical research.\nmajor challenge post-genomic era bridging gap fundamental biological research clinical applications.\nRecent research increasingly demonstrated many seemingly dissimilar diseases common molecular mechanisms.\nUnderstanding similarities among disease aids early diagnosis new drug development.Formal knowledge representation gene-disease association demanded purpose.\nOntologies, Gene Ontology (GO), successfully applied represent biological knowledge, many related techniques adopted extract information.\nDisease Ontology () (Schriml et al. 2011) developed create consistent description gene products disease perspectives, essential supporting functional genomics disease context.\nAccurate disease descriptions can discover new relationships genes disease, new functions previous uncharacteried genes alleles.Disease Ontology () (Schriml et al. 2011) aims provide open source ontology integration biomedical data associated human disease. Unlike clinical vocabularies defined disease related concepts disparately, organized directed acyclic graph, laying foundation quantitative computation disease knowledge.developed R package DOSE (Yu et al. 2015) analyzing semantic similarities among terms gene products annotated terms.","code":""},{"path":"DOSE-semantic-similarity.html","id":"do-semantic-similarity","chapter":"3 DO semantic similarity analysis","heading":"3.1 DO term semantic similarity measurement","text":"Four methods determine semantic similarity two terms based Information Content common ancestor term proposed Resnik (Philip 1999), Jiang (Jiang Conrath 1997), Lin (Lin 1998) Schlicker (Schlicker et al. 2006). Wang (Wang et al. 2007) presented method measure similarity based graph structure. methods advantage weakness. DOSE supports methods compute semantic similarity among terms gene products. algorithm details, please refer chapter 1.DOSE, implemented doSim calculating semantic similarity two terms two set terms.doSim function requires three parameter DOID1, DOID2 measure. DOID1 DOID2 vector terms, measure one Resnik, Jiang, Lin, Rel, Wang.also implement plot function simplot() visualize similarity result demonstrated Figure 3.1.\nFigure 3.1: Similarity matrix visualization. simplot() function visualize similarity matrix heatmap.\nParameter color.low colow.high used setting color gradient; labs logical parameter indicating whether show similarity values , digits indicate number decimal places used labs.size control font size similarity values; font.size setting font size axis label coordinate system.","code":"\nlibrary(DOSE)\n\na <- c(\"DOID:14095\", \"DOID:5844\", \"DOID:2044\", \"DOID:8432\", \"DOID:9146\",\n       \"DOID:10588\", \"DOID:3209\", \"DOID:848\", \"DOID:3341\", \"DOID:252\")\nb <- c(\"DOID:9409\", \"DOID:2491\", \"DOID:4467\", \"DOID:3498\", \"DOID:11256\")\ndoSim(a[1], b[1], measure=\"Wang\")## [1] 0.07142995\ndoSim(a[1], b[1], measure=\"Resnik\")## [1] 0\ndoSim(a[1], b[1], measure=\"Lin\")## [1] 0\ns <- doSim(a, b, measure=\"Wang\")\ns##             DOID:9409  DOID:2491  DOID:4467  DOID:3498 DOID:11256\n## DOID:14095 0.07142995 0.05714393 0.03676194 0.03676194 0.52749870\n## DOID:5844  0.14897652 0.11564838 0.02801328 0.02801328 0.06134327\n## DOID:2044  0.14897652 0.11564838 0.02801328 0.02801328 0.06134327\n## DOID:8432  0.17347273 0.13877811 0.03676194 0.03676194 0.07142995\n## DOID:9146  0.07142995 0.05714393 0.03676194 0.03676194 0.17347273\n## DOID:10588 0.13240905 0.18401515 0.02208240 0.02208240 0.05452137\n## DOID:3209  0.14897652 0.11564838 0.02801328 0.02801328 0.06134327\n## DOID:848   0.14897652 0.11564838 0.02801328 0.02801328 0.06134327\n## DOID:3341  0.13240905 0.09998997 0.02208240 0.02208240 0.05452137\n## DOID:252   0.06134327 0.04761992 0.02801328 0.02801328 0.06134327\nsimplot(s,\n        color.low=\"white\", color.high=\"red\",\n        labs=TRUE, digits=2, labs.size=5,\n        font.size=14, xlab=\"\", ylab=\"\")"},{"path":"DOSE-semantic-similarity.html","id":"gene-do-semantic-similarity","chapter":"3 DO semantic similarity analysis","heading":"3.2 Gene semantic similarity measurement","text":"basis semantic similarity terms, DOSE can also compute semantic similarity among gene products. DOSE provides four methods called max, avg, rcmax BMA combine semantic similarity scores multiple terms (described session 1.3). similarities among genes gene clusters annotated multiple terms also calculated combine methods.DOSE implemented geneSim measure semantic similarities among genes.geneSim requires four parameter geneID1, geneID2, measure combine. geneID1 geneID2 vector entrez gene IDs; measure one Resnik, Jiang, Lin, Rel, Wang, combine one max, avg, rcmax BMA.","code":"\ng1 <- c(\"84842\", \"2524\", \"10590\", \"3070\", \"91746\")\ng2 <- c(\"84289\", \"6045\", \"56999\", \"9869\")\n\nDOSE::geneSim(g1[1], g2[1], measure=\"Wang\", combine=\"BMA\")## [1] 0.051\ngs <- DOSE::geneSim(g1, g2, measure=\"Wang\", combine=\"BMA\")\ngs##       84289  6045 56999  9869\n## 84842 0.051 0.135 0.355 0.103\n## 2524  0.284 0.172 0.517 0.517\n## 10590 0.150 0.173 0.242 0.262\n## 3070  0.573 0.517 1.000 1.000\n## 91746 0.351 0.308 0.527 0.496"},{"path":"DOSE-semantic-similarity.html","id":"gene-cluster-do-semantic-similarity","chapter":"3 DO semantic similarity analysis","heading":"3.3 Gene cluster semantic similarity measurement","text":"DOSE also implemented clusterSim calculating semantic similarity two gene clusters mclusterSim calculating semantic similarities among multiple gene clusters.","code":"\nDOSE::clusterSim(g1, g2, measure=\"Wang\", combine=\"BMA\")## [1] 0.549\ng3 <- c(\"57491\", \"6296\", \"51438\", \"5504\", \"27319\", \"1643\")\nclusters <- list(a=g1, b=g2, c=g3)\nDOSE::mclusterSim(clusters, measure=\"Wang\", combine=\"BMA\")##       a     b     c\n## a 1.000 0.549 0.425\n## b 0.549 1.000 0.645\n## c 0.425 0.645 1.000"},{"path":"meshes-semantic-similarity.html","id":"meshes-semantic-similarity","chapter":"4 MeSH semantic similarity analysis","heading":"4 MeSH semantic similarity analysis","text":"MeSH (Medical Subject Headings) NLM (U.S. National Library \nMedicine) controlled vocabulary used manually index articles \nMEDLINE/PubMed. MeSH comprehensive life science vocabulary. MeSH \n19 categories MeSH.db contains 16 . :MeSH terms associated Entrez Gene ID three methods,\ngendoo, gene2pubmed RBBH (Reciprocal Blast Best Hit).","code":""},{"path":"meshes-semantic-similarity.html","id":"meshes-supported-organisms","chapter":"4 MeSH semantic similarity analysis","heading":"4.1 Supported organisms","text":"meshes package (Yu 2018) relies MeSHDb prepare semantic data measuring simiarlity. MeSHDb can downloaded AnnotationHub (see also AHMeSHDbs) 200 species available supported meshes package.First, need load/fetch species-specific MeSH annotation database:semantic data can prepared meshdata() function:","code":"\n#############################\n## BioC 2.14 to BioC 3.13  ##\n#############################\n##\n## library(MeSH.Hsa.eg.db)\n## db <- MeSH.Hsa.eg.db\n##\n##---------------------------\n\n# From BioC 3.14 (Nov. 2021, with R-4.2.0)\nlibrary(AnnotationHub)\nlibrary(MeSHDbi)\nah <- AnnotationHub()\nhsa <- query(ah, c(\"MeSHDb\", \"Homo sapiens\"))\nfile_hsa <- hsa[[1]]\ndb <- MeSHDbi::MeSHDb(file_hsa)\nlibrary(meshes)\nhsamd <- meshdata(db, category='A', computeIC=T, database=\"gendoo\")\n\n## you may want to save the result for future usage\n# \n# save(hsamd, file = \"hsamd.rda\")\n#"},{"path":"meshes-semantic-similarity.html","id":"meshes-semantic-simiarlity","chapter":"4 MeSH semantic similarity analysis","heading":"4.2 MeSH semantic similarity measurement","text":"meshes package (Yu 2018) implemented four IC-based methods (.e.¬†Resnik (Philip 1999), Jiang (Jiang Conrath 1997),\nLin (Lin 1998) Schlicker (Schlicker et al. 2006)) one graph-structure based method (.e.¬†Wang (Wang et al. 2007)), measure MeSH term semantic similarity. algorithm details, please refer Chapter 1.meshSim() function designed measure semantic similarity two MeSH term vectors.","code":"\nmeshSim(\"D000009\", \"D009130\", semData=hsamd, measure=\"Resnik\")## [1] 0.3847944\nmeshSim(\"D000009\", \"D009130\", semData=hsamd, measure=\"Rel\")## [1] 0.633538\nmeshSim(\"D000009\", \"D009130\", semData=hsamd, measure=\"Jiang\")## [1] 0.5587351\nmeshSim(\"D000009\", \"D009130\", semData=hsamd, measure=\"Wang\")## [1] 0.5557103\nmeshSim(c(\"D001369\", \"D002462\"), c(\"D017629\", \"D002890\", \"D008928\"), semData=hsamd, measure=\"Wang\")##           D017629   D002890   D008928\n## D001369 0.2886598 0.1923711 0.2193326\n## D002462 0.6521739 0.2381925 0.2809552"},{"path":"meshes-semantic-similarity.html","id":"gene-meshes-semantic-similarity","chapter":"4 MeSH semantic similarity analysis","heading":"4.3 Gene semantic similarity measurement","text":"geneSim() function designed measure semantic similarity among two gene vectors.","code":"\ngeneSim(\"241\", \"251\", semData=hsamd, measure=\"Wang\", combine=\"BMA\")## [1] 0.216\ngeneSim(c(\"241\", \"251\"), c(\"835\", \"5261\",\"241\", \"994\"), semData=hsamd, measure=\"Wang\", combine=\"BMA\")##       835  5261   241   994\n## 241 0.353 0.143 1.000 0.262\n## 251 0.301 0.347 0.216 0.361"},{"path":"enrichment-overview.html","id":"enrichment-overview","chapter":"5 Overview of enrichment analysis","heading":"5 Overview of enrichment analysis","text":"","code":""},{"path":"enrichment-overview.html","id":"terminology","chapter":"5 Overview of enrichment analysis","heading":"5.1 Terminology","text":"","code":""},{"path":"enrichment-overview.html","id":"gene-sets-and-pathway","chapter":"5 Overview of enrichment analysis","heading":"5.1.1 Gene sets and pathway","text":"gene set unordered collection genes functional related. pathway can interpreted gene set ignoring functional relationships among genes.","code":""},{"path":"enrichment-overview.html","id":"gene-ontology-go","chapter":"5 Overview of enrichment analysis","heading":"5.1.2 Gene Ontology (GO)","text":"Gene Ontology defines concepts/classes used describe gene function, relationships concepts. classifies functions along three aspects:MF: Molecular Function\nmolecular activities gene products\nmolecular activities gene productsCC: Cellular Component\ngene products active\ngene products activeBP: Biological Process\npathways larger processes made activities multiple gene products\npathways larger processes made activities multiple gene productsGO terms organized directed acyclic graph, edge terms represent parent-child relationship.","code":""},{"path":"enrichment-overview.html","id":"kyoto-encyclopedia-of-genes-and-genomes-kegg","chapter":"5 Overview of enrichment analysis","heading":"5.1.3 Kyoto Encyclopedia of Genes and Genomes (KEGG)","text":"KEGG collection manually drawn pathway maps representing molecular interaction reaction networks. pathways cover wide range biochemical processes can divided 7 broad categories:MetabolismGenetic information processingEnvironmental information processingCellular processesOrganismal systemsHuman diseasesDrug development.","code":""},{"path":"enrichment-overview.html","id":"other-gene-sets","chapter":"5 Overview of enrichment analysis","heading":"5.1.4 Other gene sets","text":"GO KEGG frequently used functional analysis. typically first choice long-standing curation availability wide range species.gene sets including limited Disease Ontology (), Disease Gene Network (DisGeNET), wikiPathways, Molecular Signatures Database (MSigDb).","code":""},{"path":"enrichment-overview.html","id":"ora-algorithm","chapter":"5 Overview of enrichment analysis","heading":"5.2 Over Representation Analysis","text":"Representation Analysis (ORA) (Boyle et al. 2004) widely used approach determine whether known biological functions processes -represented (= enriched) experimentally-derived gene list, e.g. list differentially expressed genes (DEGs).p-value can calculated hypergeometric distribution.\\(p = 1 - \\displaystyle\\sum_{= 0}^{k-1}\\frac{{M \\choose }{{N-M} \\choose {n-}}} {{N \\choose n}}\\)equation, N total number genes background distribution,\nM number genes within distribution annotated (either directly indirectly) gene set interest,\nn size list genes interest k number genes within list \nannotated gene set. background distribution default \ngenes annotation. P-values adjusted multiple comparison.Example: Suppose 17,980 genes detected Microarray study 57 genes differentially expressed. Among differential expressed genes, 28 annotated gene set1.whether overlap 25 genes significantly represented gene set can assessed using hypergeometric distribution. corresponding one-sided version Fisher‚Äôs exact test.","code":"\nd <- data.frame(gene.not.interest=c(2613, 15310), gene.in.interest=c(28, 29))\nrow.names(d) <- c(\"In_category\", \"not_in_category\")\nd##                 gene.not.interest gene.in.interest\n## In_category                  2613               28\n## not_in_category             15310               29\nfisher.test(d, alternative = \"greater\")## \n##  Fisher's Exact Test for Count Data\n## \n## data:  d\n## p-value = 1\n## alternative hypothesis: true odds ratio is greater than 1\n## 95 percent confidence interval:\n##  0.110242      Inf\n## sample estimates:\n## odds ratio \n##  0.1767937"},{"path":"enrichment-overview.html","id":"gsea-algorithm","chapter":"5 Overview of enrichment analysis","heading":"5.3 Gene Set Enrichment Analysis","text":"common approach analyzing gene expression profiles identifying differential expressed genes deemed interesting. ORA enrichment analysis based differential expressed genes. approach find genes difference large, detect situation difference small, evidenced coordinated way set related genes. Gene Set Enrichment Analysis (GSEA)(Subramanian et al. 2005) directly addresses limitation.\ngenes can used GSEA; GSEA aggregates per gene statistics across genes within gene set, therefore making possible detect situations genes predefined set change small coordinated way. Since likely many relevant phenotypic differences manifested small consistent changes set genes.Genes ranked based phenotypes. Given priori defined set gene S (e.g., genes shareing category), goal GSEA determine whether members S randomly distributed throughout ranked gene list (L) primarily found top bottom.three key elements GSEA method:Calculation Enrichment Score.\nenrichment score (ES) represent degree set S -represented top bottom ranked list L. score calculated walking list L, increasing running-sum statistic encounter gene S decreasing . magnitude increment depends gene statistics (e.g., correlation gene phenotype). ES maximum deviation zero encountered random walk; corresponds weighted Kolmogorov-Smirnov-like statistic (Subramanian et al. 2005).\nenrichment score (ES) represent degree set S -represented top bottom ranked list L. score calculated walking list L, increasing running-sum statistic encounter gene S decreasing . magnitude increment depends gene statistics (e.g., correlation gene phenotype). ES maximum deviation zero encountered random walk; corresponds weighted Kolmogorov-Smirnov-like statistic (Subramanian et al. 2005).Esimation Significance Level ES.\np-value ES calculated using permutation test. Specifically, permute gene labels gene list L recompute ES gene set permutated data, generate null distribution ES. p-value observed ES calculated relative null distribution.\np-value ES calculated using permutation test. Specifically, permute gene labels gene list L recompute ES gene set permutated data, generate null distribution ES. p-value observed ES calculated relative null distribution.Adjustment Multiple Hypothesis Testing.\nentire gene sets evaluated, estimated significance level adjusted account multiple hypothesis testing also q-values calculated FDR control.\nentire gene sets evaluated, estimated significance level adjusted account multiple hypothesis testing also q-values calculated FDR control.implemented GSEA algorithm proposed Subramanian (Subramanian et al. 2005). Alexey Sergushichev implemented algorithm fast GSEA calculation fgsea (Korotkevich, Sukhov, Sergushichev 2019) package. packages (clusterProfiler, DOSE, meshes ReactomePA), users can use GSEA algorithm implemented DOSE fgsea specifying parameter =\"DOSE\" =\"fgsea\". default, fgsea method used since much faster.","code":""},{"path":"enrichment-overview.html","id":"leading-edge-analysis-and-core-enriched-genes","chapter":"5 Overview of enrichment analysis","heading":"5.4 Leading edge analysis and core enriched genes","text":"Leading edge analysis reports Tags indicate percentage genes contributing enrichment score, List indicate list enrichment score attained Signal enrichment signal strength.also interesting get core enriched genes contribute enrichment. packages (clusterProfiler, DOSE, meshes ReactomePA) support leading edge analysis report core enriched genes GSEA analysis.","code":""},{"path":"clusterprofiler-go.html","id":"clusterprofiler-go","chapter":"6 GO enrichment analysis","heading":"6 GO enrichment analysis","text":"GO comprises three orthogonal ontologies, .e.¬†molecular function (MF), biological\nprocess (BP), cellular component (CC).","code":""},{"path":"clusterprofiler-go.html","id":"clusterProfiler-go-supported-organisms","chapter":"6 GO enrichment analysis","heading":"6.1 Supported organisms","text":"GO analyses (groupGO(), enrichGO() gseGO()) support organisms OrgDb object available (see also session 2.2).user GO annotation data (data.frame format first column gene ID second column GO ID), can use enricher() gseGO() functions perform -representation test gene set enrichment analysis.genes annotated direction annotation, also annotated ancestor GO nodes (indirect annation). user direct annotation, can pass annotation buildGOmap function, infer indirection annotation generate data.frame suitable enricher() gseGO().","code":""},{"path":"clusterprofiler-go.html","id":"go-classification","chapter":"6 GO enrichment analysis","heading":"6.2 GO classification","text":"clusterProfiler, groupGO() designed gene classification based GO distribution specific level. use dataset geneList provided DOSE.gene parameter vector gene IDs (can ID type supported corresponding OrgDb, see also session 16.1). readable set TRUE, input gene IDs converted gene symbols.","code":"\nlibrary(clusterProfiler)\ndata(geneList, package=\"DOSE\")\ngene <- names(geneList)[abs(geneList) > 2]\n\n# Entrez gene ID\nhead(gene)## [1] \"4312\"  \"8318\"  \"10874\" \"55143\" \"55388\" \"991\"\nggo <- groupGO(gene     = gene,\n               OrgDb    = org.Hs.eg.db,\n               ont      = \"CC\",\n               level    = 3,\n               readable = TRUE)\n\nhead(ggo)##                    ID                Description Count GeneRatio geneID\n## GO:0044423 GO:0044423                virion part     0     0/207       \n## GO:0000133 GO:0000133                 polarisome     0     0/207       \n## GO:0000408 GO:0000408          EKC/KEOPS complex     0     0/207       \n## GO:0000417 GO:0000417                HIR complex     0     0/207       \n## GO:0000444 GO:0000444    MIS12/MIND type complex     0     0/207       \n## GO:0000808 GO:0000808 origin recognition complex     0     0/207"},{"path":"clusterprofiler-go.html","id":"clusterprofiler-go-ora","chapter":"6 GO enrichment analysis","heading":"6.3 GO over-representation analysis","text":"clusterProfiler package implemented enrichGO() function gene ontology -representation test.gene ID type supported OrgDb can directly used GO analyses. User need specify keyType parameter specify input gene ID type.Gene ID can mapped gene Symbol using paramter readable=TRUE setReadable() function.","code":"\nego <- enrichGO(gene          = gene,\n                universe      = names(geneList),\n                OrgDb         = org.Hs.eg.db,\n                ont           = \"CC\",\n                pAdjustMethod = \"BH\",\n                pvalueCutoff  = 0.01,\n                qvalueCutoff  = 0.05,\n        readable      = TRUE)\nhead(ego)##                    ID                              Description GeneRatio\n## GO:0005819 GO:0005819                                  spindle    26/201\n## GO:0072686 GO:0072686                          mitotic spindle    17/201\n## GO:0000775 GO:0000775           chromosome, centromeric region    18/201\n## GO:0098687 GO:0098687                       chromosomal region    23/201\n## GO:0000779 GO:0000779 condensed chromosome, centromeric region    14/201\n## GO:0000776 GO:0000776                              kinetochore    15/201\n##              BgRatio       pvalue     p.adjust       qvalue\n## GO:0005819 299/11840 6.490593e-12 1.908234e-09 1.735380e-09\n## GO:0072686 129/11840 5.480692e-11 8.056617e-09 7.326819e-09\n## GO:0000775 156/11840 1.385677e-10 1.206452e-08 1.097168e-08\n## GO:0098687 269/11840 1.641432e-10 1.206452e-08 1.097168e-08\n## GO:0000779  90/11840 3.056082e-10 1.796976e-08 1.634199e-08\n## GO:0000776 109/11840 4.155863e-10 2.036373e-08 1.851911e-08\n##                                                                                                                                                               geneID\n## GO:0005819 CDCA8/CDC20/KIF23/CENPE/ASPM/DLGAP5/SKA1/NUSAP1/TPX2/TACC3/NEK2/CDK1/MAD2L1/KIF18A/BIRC5/KIF11/TRAT1/TTK/AURKB/PRC1/KIFC1/KIF18B/KIF20A/AURKA/CCNB1/KIF4A\n## GO:0072686                                                      KIF23/CENPE/ASPM/SKA1/NUSAP1/TPX2/TACC3/CDK1/MAD2L1/KIF18A/KIF11/TRAT1/AURKB/PRC1/KIFC1/KIF18B/AURKA\n## GO:0000775                                                 CDCA8/CENPE/NDC80/TOP2A/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/CDT1/BIRC5/TTK/NCAPG/AURKB/CCNB1\n## GO:0098687                   CDCA8/CENPE/NDC80/TOP2A/HJURP/SKA1/NEK2/CENPM/RAD51AP1/CENPN/CDK1/ERCC6L/MAD2L1/KIF18A/CDT1/BIRC5/EZH2/TTK/NCAPG/AURKB/CHEK1/CCNB1/MCM5\n## GO:0000779                                                                        CENPE/NDC80/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/CDT1/BIRC5/NCAPG/AURKB/CCNB1\n## GO:0000776                                                                   CENPE/NDC80/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/CDT1/BIRC5/TTK/AURKB/CCNB1\n##            Count\n## GO:0005819    26\n## GO:0072686    17\n## GO:0000775    18\n## GO:0098687    23\n## GO:0000779    14\n## GO:0000776    15\ngene.df <- bitr(gene, fromType = \"ENTREZID\",\n        toType = c(\"ENSEMBL\", \"SYMBOL\"),\n        OrgDb = org.Hs.eg.db)\n\nego2 <- enrichGO(gene         = gene.df$ENSEMBL,\n                OrgDb         = org.Hs.eg.db,\n                keyType       = 'ENSEMBL',\n                ont           = \"CC\",\n                pAdjustMethod = \"BH\",\n                pvalueCutoff  = 0.01,\n                qvalueCutoff  = 0.05)\nhead(ego2, 3)                ##                    ID                    Description GeneRatio   BgRatio\n## GO:0005819 GO:0005819                        spindle    30/233 410/21841\n## GO:0072686 GO:0072686                mitotic spindle    21/233 175/21841\n## GO:0000775 GO:0000775 chromosome, centromeric region    19/233 212/21841\n##                  pvalue     p.adjust       qvalue\n## GO:0005819 9.737364e-17 2.784886e-14 2.121720e-14\n## GO:0072686 2.623396e-16 3.751456e-14 2.858121e-14\n## GO:0000775 1.506065e-12 9.096876e-11 6.930634e-11\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     geneID\n## GO:0005819 ENSG00000134690/ENSG00000117399/ENSG00000137807/ENSG00000138778/ENSG00000066279/ENSG00000126787/ENSG00000154839/ENSG00000262634/ENSG00000137804/ENSG00000088325/ENSG00000013810/ENSG00000117650/ENSG00000170312/ENSG00000164109/ENSG00000121621/ENSG00000089685/ENSG00000138160/ENSG00000163519/ENSG00000112742/ENSG00000178999/ENSG00000198901/ENSG00000237649/ENSG00000233450/ENSG00000056678/ENSG00000204197/ENSG00000186185/ENSG00000112984/ENSG00000087586/ENSG00000134057/ENSG00000090889\n## GO:0072686                                                                                                                                                 ENSG00000137807/ENSG00000138778/ENSG00000066279/ENSG00000154839/ENSG00000262634/ENSG00000137804/ENSG00000088325/ENSG00000013810/ENSG00000170312/ENSG00000164109/ENSG00000121621/ENSG00000138160/ENSG00000163519/ENSG00000178999/ENSG00000198901/ENSG00000237649/ENSG00000233450/ENSG00000056678/ENSG00000204197/ENSG00000186185/ENSG00000087586\n## GO:0000775                                                                                                                                                                                 ENSG00000134690/ENSG00000138778/ENSG00000080986/ENSG00000131747/ENSG00000123485/ENSG00000154839/ENSG00000262634/ENSG00000117650/ENSG00000100162/ENSG00000166451/ENSG00000186871/ENSG00000164109/ENSG00000121621/ENSG00000167513/ENSG00000089685/ENSG00000112742/ENSG00000109805/ENSG00000178999/ENSG00000134057\n##            Count\n## GO:0005819    30\n## GO:0072686    21\n## GO:0000775    19"},{"path":"clusterprofiler-go.html","id":"go-gene-set-enrichment-analysis","chapter":"6 GO enrichment analysis","heading":"6.4 GO Gene Set Enrichment Analysis","text":"clusterProfiler package provides gseGO() function gene set enrichment analysis using gene ontology.format input data, geneList, documented FAQ. Beware gene Set size [minGSSize, maxGSSize] tested.","code":"\nego3 <- gseGO(geneList     = geneList,\n              OrgDb        = org.Hs.eg.db,\n              ont          = \"CC\",\n              minGSSize    = 100,\n              maxGSSize    = 500,\n              pvalueCutoff = 0.05,\n              verbose      = FALSE)"},{"path":"clusterprofiler-go.html","id":"clusterprofiler-go-non-model","chapter":"6 GO enrichment analysis","heading":"6.5 GO analysis for non-model organisms","text":"enrichGO() gseGO() functions require OrgDb object background annotation. organisms don‚Äôt OrgDb provided Bioconductor, users can query one (available) online via AnnotationHub. OrgDb available, users can obtain GO annotation sources, e.g.¬†biomaRt Blast2GO. enricher() GSEA() functions can used perform GO analysis organisms, similar examples using wikiPathways MSigDB. Another solution create OrgDb using AnnotationForge package.","code":""},{"path":"clusterprofiler-go.html","id":"visualize-enriched-go-terms-as-a-directed-acyclic-graph","chapter":"6 GO enrichment analysis","heading":"6.6 Visualize enriched GO terms as a directed acyclic graph","text":"goplot() can accept output enrichGO visualized enriched GO induced graph.\nFigure 6.1: Goplot enrichment analysis.\n","code":"\ngoplot(ego)"},{"path":"clusterprofiler-go.html","id":"clusterprofiler-go-summary","chapter":"6 GO enrichment analysis","heading":"6.7 Summary","text":"GO semantic similarity can calculated GOSemSim (Yu et al. 2010). can use cluster genes/proteins different clusters based functional similarity can also use measure similarities among GO terms reduce redundancy GO enrichment results.","code":""},{"path":"clusterprofiler-kegg.html","id":"clusterprofiler-kegg","chapter":"7 KEGG enrichment analysis","heading":"7 KEGG enrichment analysis","text":"KEGG FTP service freely available academic since 2012, many software packages using -dated KEGG annotation data. clusterProfiler package supports downloading latest online version KEGG data using KEGG website, freely available academic users. KEGG pathway module supported clusterProfiler.","code":""},{"path":"clusterprofiler-kegg.html","id":"clusterProfiler-kegg-supported-organisms","chapter":"7 KEGG enrichment analysis","heading":"7.1 Supported organisms","text":"clusterProfiler package supports organisms KEGG annotation data available KEGG database. User pass abbreviation academic name organism parameter. full list KEGG supported organisms can accessed via http://www.genome.jp/kegg/catalog/org_list.html. KEGG Orthology (KO) Database also supported specifying organism = \"ko\".clusterProfiler package provides search_kegg_organism() function help searching supported organisms.","code":"\nlibrary(clusterProfiler)\nsearch_kegg_organism('ece', by='kegg_code')##     kegg_code                        scientific_name common_name\n## 366       ece Escherichia coli O157:H7 EDL933 (EHEC)        <NA>\necoli <- search_kegg_organism('Escherichia coli', by='scientific_name')\ndim(ecoli)## [1] 65  3\nhead(ecoli)##     kegg_code                        scientific_name common_name\n## 361       eco           Escherichia coli K-12 MG1655        <NA>\n## 362       ecj            Escherichia coli K-12 W3110        <NA>\n## 363       ecd            Escherichia coli K-12 DH10B        <NA>\n## 364       ebw                Escherichia coli BW2952        <NA>\n## 365      ecok            Escherichia coli K-12 MDS42        <NA>\n## 366       ece Escherichia coli O157:H7 EDL933 (EHEC)        <NA>"},{"path":"clusterprofiler-kegg.html","id":"clusterprofiler-kegg-pathway-ora","chapter":"7 KEGG enrichment analysis","heading":"7.2 KEGG pathway over-representation analysis","text":"Input ID type can kegg, ncbi-geneid, ncbi-proteinid uniprot (see also session 16.1.2). Unlike enrichGO(), readable parameter enrichKEGG(). However, users can use setReadable() function OrgDb available species.","code":"\ndata(geneList, package=\"DOSE\")\ngene <- names(geneList)[abs(geneList) > 2]\n\nkk <- enrichKEGG(gene         = gene,\n                 organism     = 'hsa',\n                 pvalueCutoff = 0.05)\nhead(kk)##                ID                                                   Description\n## hsa04110 hsa04110                                                    Cell cycle\n## hsa04114 hsa04114                                                Oocyte meiosis\n## hsa04218 hsa04218                                           Cellular senescence\n## hsa04061 hsa04061 Viral protein interaction with cytokine and cytokine receptor\n## hsa03320 hsa03320                                        PPAR signaling pathway\n## hsa04914 hsa04914                       Progesterone-mediated oocyte maturation\n##          GeneRatio  BgRatio       pvalue     p.adjust       qvalue\n## hsa04110     11/94 124/8091 1.651714e-07 3.419048e-05 3.355587e-05\n## hsa04114     10/94 129/8091 2.175890e-06 2.252047e-04 2.210247e-04\n## hsa04218     10/94 156/8091 1.198811e-05 8.271799e-04 8.118267e-04\n## hsa04061      8/94 100/8091 1.904909e-05 9.857904e-04 9.674932e-04\n## hsa03320      7/94  76/8091 2.595975e-05 1.074734e-03 1.054786e-03\n## hsa04914      7/94 100/8091 1.516194e-04 5.230871e-03 5.133781e-03\n##                                                      geneID Count\n## hsa04110 8318/991/9133/890/983/4085/7272/1111/891/4174/9232    11\n## hsa04114    991/9133/983/4085/51806/6790/891/9232/3708/5241    10\n## hsa04218     2305/4605/9133/890/983/51806/1111/891/776/3708    10\n## hsa04061           3627/10563/6373/4283/6362/6355/9547/1524     8\n## hsa03320                 4312/9415/9370/5105/2167/3158/5346     7\n## hsa04914                    9133/890/983/4085/6790/891/5241     7"},{"path":"clusterprofiler-kegg.html","id":"clusterprofiler-kegg-pathway-gsea","chapter":"7 KEGG enrichment analysis","heading":"7.3 KEGG pathway gene set enrichment analysis","text":"","code":"\nkk2 <- gseKEGG(geneList     = geneList,\n               organism     = 'hsa',\n               minGSSize    = 120,\n               pvalueCutoff = 0.05,\n               verbose      = FALSE)\nhead(kk2)##                ID                              Description setSize\n## hsa05169 hsa05169             Epstein-Barr virus infection     193\n## hsa05166 hsa05166  Human T-cell leukemia virus 1 infection     200\n## hsa04613 hsa04613  Neutrophil extracellular trap formation     130\n## hsa04218 hsa04218                      Cellular senescence     141\n## hsa04510 hsa04510                           Focal adhesion     190\n## hsa05170 hsa05170 Human immunodeficiency virus 1 infection     189\n##          enrichmentScore       NES       pvalue     p.adjust      qvalues rank\n## hsa05169       0.4335010  1.925520 6.472840e-08 4.919358e-06 3.270488e-06 2820\n## hsa05166       0.3926594  1.757442 3.012634e-06 8.065327e-05 5.361990e-05 1955\n## hsa04613       0.4496569  1.890892 3.183682e-06 8.065327e-05 5.361990e-05 2575\n## hsa04218       0.4115945  1.754241 3.701280e-05 6.591880e-04 4.382413e-04 1155\n## hsa04510      -0.4169068 -1.703069 4.336763e-05 6.591880e-04 4.382413e-04 2183\n## hsa05170       0.3711150  1.648181 1.414590e-04 1.610393e-03 1.070621e-03 3178\n##                            leading_edge\n## hsa05169 tags=39%, list=23%, signal=31%\n## hsa05166 tags=26%, list=16%, signal=23%\n## hsa04613 tags=37%, list=21%, signal=30%\n## hsa04218  tags=17%, list=9%, signal=16%\n## hsa04510 tags=27%, list=17%, signal=22%\n## hsa05170 tags=38%, list=25%, signal=29%\n##                                                                                                                                                                                                                                                                                                                                                                                core_enrichment\n## hsa05169 3627/890/6890/9636/898/9134/6502/6772/3126/3112/4609/917/5709/1869/3654/919/915/4067/4938/864/4940/5713/5336/11047/3066/54205/1871/578/1019/637/916/3383/4939/10213/23586/4793/5603/7979/7128/6891/930/5714/3452/6850/5702/4794/7124/3569/7097/5708/2208/8772/3119/5704/7186/5971/3135/1380/958/5610/4792/10018/8819/3134/10379/9641/1147/5718/6300/3109/811/5606/2923/3108/5707/1432\n## hsa05166                                                                                                                      991/9133/890/4085/7850/1111/9232/8061/701/9700/898/4316/9134/3932/3559/3126/3112/4609/3561/917/1869/1029/915/114/2005/5902/55697/1871/1031/2224/292/1019/3689/916/3383/11200/706/3600/6513/3601/468/5604/7124/1030/3569/4049/4055/10393/3119/5901/5971/1959/3135\n## hsa04613                                                                                                                                      820/366/51311/64581/3015/85236/55506/8970/8357/1535/2359/5336/4688/92815/3066/8336/292/1991/3689/8345/5603/4689/5880/10105/1184/6404/3018/6850/5604/3014/7097/1378/8290/1536/834/5605/1183/728/2215/8335/5594/9734/3674/5578/5582/7417/8331/6300\n## hsa04218                                                                                                                                                                                                                                                                 2305/4605/9133/890/983/51806/1111/891/993/3576/1978/898/9134/4609/1869/1029/22808/1871/5499/91860/292/1019/11200/1875\n## hsa04510                                                                                                                   5595/5228/7424/1499/4636/83660/7059/5295/1288/23396/3910/3371/3082/1291/394/3791/7450/596/3685/1280/3675/595/2318/3912/1793/1278/1277/1293/10398/55742/2317/7058/25759/56034/3693/3480/5159/857/1292/3908/3909/63923/3913/1287/3679/7060/3479/10451/80310/1311/1101\n## hsa05170                   9133/9582/983/51806/1111/891/6890/200315/917/3654/919/915/5336/54205/91860/578/995/25939/637/1234/916/5603/2792/5880/6891/6921/3452/5604/7124/9978/7097/7852/8772/1174/7186/3135/164/60489/2787/356/7133/5605/27350/6199/1642/5594/4792/3134/5578/4893/8454/5582/2786/1147/3984/6300/200316/811/5606/2923/4775/162/1432/2784/836/5747/5058/3106/2770/5534/5579/4615"},{"path":"clusterprofiler-kegg.html","id":"clusterprofiler-kegg-module-ora","chapter":"7 KEGG enrichment analysis","heading":"7.4 KEGG module over-representation analysis","text":"KEGG Module collection manually defined function units. situation, KEGG Modules straightforward interpretation.","code":"\nmkk <- enrichMKEGG(gene = gene,\n                   organism = 'hsa',\n                   pvalueCutoff = 1,\n                   qvalueCutoff = 1)\nhead(mkk)                   ##            ID                                             Description GeneRatio\n## M00912 M00912      NAD biosynthesis, tryptophan => quinolinate => NAD       2/9\n## M00095 M00095          C5 isoprenoid biosynthesis, mevalonate pathway       1/9\n## M00053 M00053 Pyrimidine deoxyribonuleotide biosynthesis, CDP => dCTP       1/9\n## M00938 M00938 Pyrimidine deoxyribonuleotide biosynthesis, UDP => dTTP       1/9\n## M00003 M00003            Gluconeogenesis, oxaloacetate => fructose-6P       1/9\n## M00049 M00049     Adenine ribonucleotide biosynthesis, IMP => ADP,ATP       1/9\n##        BgRatio     pvalue   p.adjust     qvalue     geneID Count\n## M00912  12/830 0.00652644 0.03915864 0.03434969 23475/3620     2\n## M00095  10/830 0.10382973 0.21390091 0.18763237       3158     1\n## M00053  11/830 0.11366575 0.21390091 0.18763237       6241     1\n## M00938  14/830 0.14260060 0.21390091 0.18763237       6241     1\n## M00003  18/830 0.17987328 0.21569867 0.18920936       5105     1\n## M00049  22/830 0.21569867 0.21569867 0.18920936      26289     1"},{"path":"clusterprofiler-kegg.html","id":"clusterprofiler-kegg-module-gsea","chapter":"7 KEGG enrichment analysis","heading":"7.5 KEGG module gene set enrichment analysis","text":"","code":"\nmkk2 <- gseMKEGG(geneList = geneList,\n                 organism = 'hsa',\n                 pvalueCutoff = 1)\nhead(mkk2)##            ID                                                      Description\n## M00001 M00001        Glycolysis (Embden-Meyerhof pathway), glucose => pyruvate\n## M00035 M00035                                           Methionine degradation\n## M00002 M00002         Glycolysis, core module involving three-carbon compounds\n## M00938 M00938          Pyrimidine deoxyribonuleotide biosynthesis, UDP => dTTP\n## M00009 M00009                           Citrate cycle (TCA cycle, Krebs cycle)\n## M00104 M00104 Bile acid biosynthesis, cholesterol => cholate/chenodeoxycholate\n##        setSize enrichmentScore       NES      pvalue  p.adjust   qvalues rank\n## M00001      24       0.5739036  1.777650 0.005589333 0.1788587 0.1647382 2886\n## M00035      10       0.6784636  1.646743 0.028210658 0.3072796 0.2830207 1555\n## M00002      11       0.6421781  1.614229 0.037225486 0.3072796 0.2830207 1381\n## M00938      10       0.6648004  1.613580 0.038409946 0.3072796 0.2830207  648\n## M00009      22       0.4504911  1.374948 0.089974293 0.5758355 0.5303748 3514\n## M00104      10      -0.5876900 -1.326415 0.150592217 0.7851100 0.7231276  961\n##                          leading_edge\n## M00001 tags=54%, list=23%, signal=42%\n## M00035 tags=50%, list=12%, signal=44%\n## M00002 tags=55%, list=11%, signal=49%\n## M00938  tags=40%, list=5%, signal=38%\n## M00009 tags=50%, list=28%, signal=36%\n## M00104  tags=50%, list=8%, signal=46%\n##                                                         core_enrichment\n## M00001 5214/3101/2821/7167/2597/5230/2023/5223/5315/3099/5232/2027/5211\n## M00035                                           875/1789/191/1788/1786\n## M00002                                    7167/2597/5230/2023/5223/5315\n## M00938                                              6241/7298/4830/1841\n## M00009            3418/50/4190/3419/2271/3421/55753/3417/1431/6389/4191\n## M00104                                        6342/10998/1581/3295/8309"},{"path":"clusterprofiler-kegg.html","id":"visualize-enriched-kegg-pathways","chapter":"7 KEGG enrichment analysis","heading":"7.6 Visualize enriched KEGG pathways","text":"enrichplot package implemented several methods visualize enriched terms. general methods can used GO, KEGG, MSigDb gene set annotations. , introduce clusterProfiler::browseKEGG() pathview::pathview() functions help users exploring enriched KEGG pathway interested genes.view KEGG pathway, user can use browseKEGG function, open web browser highlight enriched genes.\nFigure 7.1: Explore selected KEGG pathway. Differentially expressed genes enriched selected pathway highlighted.\nUsers can also use pathview() function pathview (Luo Brouwer 2013) visualize enriched KEGG pathways identify clusterProfiler package (Yu et al. 2012).following example illustrate visualize ‚Äúhsa04110‚Äù pathway, enriched previous analysis.\nFigure 7.2: Visualize selected KEGG pathway pathview(). Gene expression values can mapped gradient color scale.\n","code":"\nbrowseKEGG(kk, 'hsa04110')\nlibrary(\"pathview\")\nhsa04110 <- pathview(gene.data  = geneList,\n                     pathway.id = \"hsa04110\",\n                     species    = \"hsa\",\n                     limit      = list(gene=max(abs(geneList)), cpd=1))"},{"path":"wikipathways-analysis.html","id":"wikipathways-analysis","chapter":"8 WikiPathways analysis","heading":"8 WikiPathways analysis","text":"WikiPathways continuously updated pathway database curated community researchers pathway enthusiasts. WikiPathways produces monthly releases gmt files supported organisms data.wikipathways.org. clusterProfiler package (Yu et al. 2012) supports enrichment analysis (either ORA GSEA) WikiPathways using enrichWP() gseWP() functions. functions automatically download parse latest WikiPathways GMT file selected organism.Supported organisms can listed :","code":"\nget_wp_organisms()##  [1] \"Sus scrofa\"               \"Saccharomyces cerevisiae\"\n##  [3] \"Rattus norvegicus\"        \"Populus trichocarpa\"     \n##  [5] \"Pan troglodytes\"          \"Oryza sativa\"            \n##  [7] \"Mus musculus\"             \"Homo sapiens\"            \n##  [9] \"Gallus gallus\"            \"Equus caballus\"          \n## [11] \"Drosophila melanogaster\"  \"Danio rerio\"             \n## [13] \"Canis familiaris\"         \"Caenorhabditis elegans\"  \n## [15] \"Bos taurus\"               \"Arabidopsis thaliana\"    \n## [17] \"Anopheles gambiae\""},{"path":"wikipathways-analysis.html","id":"clusterprofiler-wikipathway-ora","chapter":"8 WikiPathways analysis","heading":"8.1 WikiPathways over-representation analysis","text":"","code":"\ndata(geneList, package=\"DOSE\")\ngene <- names(geneList)[abs(geneList) > 2]\n\nenrichWP(gene, organism = \"Homo sapiens\") ## #\n## # over-representation test\n## #\n## #...@organism     Homo sapiens \n## #...@ontology     WikiPathways \n## #...@keytype      ENTREZID \n## #...@gene     chr [1:207] \"4312\" \"8318\" \"10874\" \"55143\" \"55388\" \"991\" \"6280\" \"2305\" ...\n## #...pvalues adjusted by 'BH' with cutoff <0.05 \n## #...8 enriched terms found\n## 'data.frame':    8 obs. of  9 variables:\n##  $ ID         : chr  \"WP2446\" \"WP2361\" \"WP179\" \"WP3942\" ...\n##  $ Description: chr  \"Retinoblastoma gene in cancer\" \"Gastric cancer network 1\" \"Cell cycle\" \"PPAR signaling pathway\" ...\n##  $ GeneRatio  : chr  \"11/108\" \"6/108\" \"10/108\" \"7/108\" ...\n##  $ BgRatio    : chr  \"88/7847\" \"29/7847\" \"122/7847\" \"67/7847\" ...\n##  $ pvalue     : num  2.65e-08 2.17e-06 6.11e-06 3.39e-05 5.44e-05 ...\n##  $ p.adjust   : num  6.39e-06 2.62e-04 4.91e-04 2.04e-03 2.62e-03 ...\n##  $ qvalue     : num  5.75e-06 2.35e-04 4.42e-04 1.84e-03 2.36e-03 ...\n##  $ geneID     : chr  \"8318/9133/7153/6241/890/983/81620/7272/1111/891/24137\" \"4605/7153/11065/22974/6286/6790\" \"8318/991/9133/890/983/7272/1111/891/4174/9232\" \"4312/9415/9370/5105/2167/3158/5346\" ...\n##  $ Count      : int  11 6 10 7 4 7 8 10\n## #...Citation\n##   Guangchuang Yu, Li-Gen Wang, Yanyan Han and Qing-Yu He.\n##   clusterProfiler: an R package for comparing biological themes among\n##   gene clusters. OMICS: A Journal of Integrative Biology\n##   2012, 16(5):284-287"},{"path":"wikipathways-analysis.html","id":"clusterprofiler-wikipathway-gsea","chapter":"8 WikiPathways analysis","heading":"8.2 WikiPathways gene set enrichment analysis","text":"input gene ID type Entrez gene ID, can use bitr() function convert gene ID. want convert gene IDs output result gene symbols, can use setReadable() function.","code":"\ngseWP(geneList, organism = \"Homo sapiens\")## #\n## # Gene Set Enrichment Analysis\n## #\n## #...@organism     Homo sapiens \n## #...@setType      WikiPathways \n## #...@keytype      ENTREZID \n## #...@geneList     Named num [1:12495] 4.57 4.51 4.42 4.14 3.88 ...\n##  - attr(*, \"names\")= chr [1:12495] \"4312\" \"8318\" \"10874\" \"55143\" ...\n## #...nPerm     \n## #...pvalues adjusted by 'BH' with cutoff <0.05 \n## #...68 enriched terms found\n## 'data.frame':    68 obs. of  11 variables:\n##  $ ID             : chr  \"WP179\" \"WP2446\" \"WP466\" \"WP45\" ...\n##  $ Description    : chr  \"Cell cycle\" \"Retinoblastoma gene in cancer\" \"DNA replication\" \"G1 to S cell cycle control\" ...\n##  $ setSize        : int  111 84 42 62 201 23 76 102 41 63 ...\n##  $ enrichmentScore: num  0.663 0.731 0.792 0.665 0.46 ...\n##  $ NES            : num  2.74 2.89 2.71 2.45 2.08 ...\n##  $ pvalue         : num  1.00e-10 1.00e-10 1.00e-10 3.91e-10 6.61e-10 ...\n##  $ p.adjust       : num  1.85e-08 1.85e-08 1.85e-08 5.41e-08 7.33e-08 ...\n##  $ qvalues        : num  1.54e-08 1.54e-08 1.54e-08 4.52e-08 6.12e-08 ...\n##  $ rank           : num  1234 1333 1002 1111 1326 ...\n##  $ leading_edge   : chr  \"tags=40%, list=10%, signal=36%\" \"tags=51%, list=11%, signal=46%\" \"tags=55%, list=8%, signal=51%\" \"tags=42%, list=9%, signal=38%\" ...\n##  $ core_enrichment: chr  \"8318/991/9133/890/983/7272/1111/891/4174/9232/4171/993/990/5347/9700/898/23594/4998/9134/4175/4173/10926/6502/9\"| __truncated__ \"8318/9133/7153/6241/890/983/81620/7272/1111/891/24137/993/898/4998/10733/9134/4175/4173/6502/5984/994/7298/3015\"| __truncated__ \"8318/55388/81620/4174/4171/990/23594/4998/4175/4173/10926/5984/5111/51053/8317/5427/23649/4176/5982/5557/5558/4172/5424\" \"8318/983/891/4174/4171/993/898/23594/4998/9134/4175/4173/4609/5111/1869/1029/5427/23649/4176/5557/1871/1031/101\"| __truncated__ ...\n## #...Citation\n##   Guangchuang Yu, Li-Gen Wang, Yanyan Han and Qing-Yu He.\n##   clusterProfiler: an R package for comparing biological themes among\n##   gene clusters. OMICS: A Journal of Integrative Biology\n##   2012, 16(5):284-287"},{"path":"reactomepa.html","id":"reactomepa","chapter":"9 Reactome enrichment analysis","heading":"9 Reactome enrichment analysis","text":"ReactomePA designed reactome pathway based analysis (Yu 2016). Reactome open-source, open access, manually curated peer-reviewed pathway database.","code":""},{"path":"reactomepa.html","id":"reactomepa-supported-organisms","chapter":"9 Reactome enrichment analysis","heading":"9.1 Supported organisms","text":"Currently ReactomePA supports several model organisms, including ‚Äòcelegans,‚Äô ‚Äòfly,‚Äô ‚Äòhuman,‚Äô ‚Äòmouse,‚Äô ‚Äòrat,‚Äô ‚Äòyeast‚Äô ‚Äòzebrafish.‚Äô input gene ID Entrez gene ID. recommend using clusterProfiler::bitr() convert biological IDs.","code":""},{"path":"reactomepa.html","id":"reactomepa-ora","chapter":"9 Reactome enrichment analysis","heading":"9.2 Reactome pathway over-representation analysis","text":"Enrichment analysis widely used approach identify biological\nthemes. ReactomePA implemented enrichPathway() uses hypergeometric model assess whether number selected genes associated reactome pathway larger expected.","code":"\nlibrary(ReactomePA)\ndata(geneList)\nde <- names(geneList)[abs(geneList) > 1.5]\nhead(de)## [1] \"4312\"  \"8318\"  \"10874\" \"55143\" \"55388\" \"991\"\nx <- enrichPathway(gene=de, pvalueCutoff = 0.05, readable=TRUE)\nhead(x)##                          ID\n## R-HSA-69620     R-HSA-69620\n## R-HSA-69618     R-HSA-69618\n## R-HSA-2500257 R-HSA-2500257\n## R-HSA-141424   R-HSA-141424\n## R-HSA-141444   R-HSA-141444\n## R-HSA-9648025 R-HSA-9648025\n##                                                                                        Description\n## R-HSA-69620                                                                 Cell Cycle Checkpoints\n## R-HSA-69618                                                             Mitotic Spindle Checkpoint\n## R-HSA-2500257                                              Resolution of Sister Chromatid Cohesion\n## R-HSA-141424                                         Amplification of signal from the kinetochores\n## R-HSA-141444  Amplification  of signal from unattached  kinetochores via a MAD2  inhibitory signal\n## R-HSA-9648025                                           EML4 and NUDC in mitotic spindle formation\n##               GeneRatio   BgRatio       pvalue     p.adjust       qvalue\n## R-HSA-69620      38/328 294/10856 2.142796e-14 1.647810e-11 1.470635e-11\n## R-HSA-69618      22/328 113/10856 2.206937e-12 7.273823e-10 6.491729e-10\n## R-HSA-2500257    23/328 126/10856 2.837642e-12 7.273823e-10 6.491729e-10\n## R-HSA-141424     20/328  96/10856 6.071311e-12 9.337676e-10 8.333673e-10\n## R-HSA-141444     20/328  96/10856 6.071311e-12 9.337676e-10 8.333673e-10\n## R-HSA-9648025    20/328 117/10856 2.674965e-10 3.428414e-08 3.059785e-08\n##                                                                                                                                                                                                                                       geneID\n## R-HSA-69620   CDC45/CDCA8/MCM10/CDC20/CENPE/CCNB2/NDC80/UBE2C/SKA1/CENPM/CENPN/UBE2S/CCNA2/CDK1/ERCC6L/MAD2L1/KIF18A/BIRC5/AURKB/CHEK1/CCNB1/MCM5/MCM2/KIF2C/CDC25A/CDC6/PLK1/BUB1B/GTSE1/EXO1/ZWINT/CENPU/SPC25/CENPI/CCNE1/ORC6/ORC1/TAOK1\n## R-HSA-69618                                                                                             CDCA8/CDC20/CENPE/NDC80/UBE2C/SKA1/CENPM/CENPN/UBE2S/ERCC6L/MAD2L1/KIF18A/BIRC5/AURKB/KIF2C/PLK1/BUB1B/ZWINT/CENPU/SPC25/CENPI/TAOK1\n## R-HSA-2500257                                                                                      CDCA8/CDC20/CENPE/CCNB2/NDC80/SKA1/CENPM/CENPN/CDK1/ERCC6L/MAD2L1/KIF18A/BIRC5/AURKB/CCNB1/KIF2C/PLK1/BUB1B/ZWINT/CENPU/SPC25/CENPI/TAOK1\n## R-HSA-141424                                                                                                        CDCA8/CDC20/CENPE/NDC80/SKA1/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/BIRC5/AURKB/KIF2C/PLK1/BUB1B/ZWINT/CENPU/SPC25/CENPI/TAOK1\n## R-HSA-141444                                                                                                        CDCA8/CDC20/CENPE/NDC80/SKA1/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/BIRC5/AURKB/KIF2C/PLK1/BUB1B/ZWINT/CENPU/SPC25/CENPI/TAOK1\n## R-HSA-9648025                                                                                                       CDCA8/CDC20/CENPE/NDC80/SKA1/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/BIRC5/AURKB/KIF2C/PLK1/BUB1B/ZWINT/CENPU/SPC25/CENPI/TAOK1\n##               Count\n## R-HSA-69620      38\n## R-HSA-69618      22\n## R-HSA-2500257    23\n## R-HSA-141424     20\n## R-HSA-141444     20\n## R-HSA-9648025    20"},{"path":"reactomepa.html","id":"reactomepa-gsea","chapter":"9 Reactome enrichment analysis","heading":"9.3 Reactome pathway gene set enrichment analysis","text":"","code":"\ny <- gsePathway(geneList, \n                pvalueCutoff = 0.2,\n                pAdjustMethod = \"BH\", \n                verbose = FALSE)\nhead(y)##                        ID\n## R-HSA-141424 R-HSA-141424\n## R-HSA-141444 R-HSA-141444\n## R-HSA-162909 R-HSA-162909\n## R-HSA-174143 R-HSA-174143\n## R-HSA-174178 R-HSA-174178\n## R-HSA-174184 R-HSA-174184\n##                                                                                                           Description\n## R-HSA-141424                                                            Amplification of signal from the kinetochores\n## R-HSA-141444                     Amplification  of signal from unattached  kinetochores via a MAD2  inhibitory signal\n## R-HSA-162909                                                                         Host Interactions of HIV factors\n## R-HSA-174143                                                        APC/C-mediated degradation of cell cycle proteins\n## R-HSA-174178 APC/C:Cdh1 mediated degradation of Cdc20 and other APC/C:Cdh1 targeted proteins in late mitosis/early G1\n## R-HSA-174184                                                     Cdc20:Phospho-APC/C mediated degradation of Cyclin A\n##              setSize enrichmentScore      NES pvalue     p.adjust      qvalues\n## R-HSA-141424      81       0.7111667 2.781869  1e-10 4.034984e-09 2.992922e-09\n## R-HSA-141444      81       0.7111667 2.781869  1e-10 4.034984e-09 2.992922e-09\n## R-HSA-162909     122       0.5860187 2.450643  1e-10 4.034984e-09 2.992922e-09\n## R-HSA-174143      79       0.6940241 2.701439  1e-10 4.034984e-09 2.992922e-09\n## R-HSA-174178      65       0.6868145 2.578477  1e-10 4.034984e-09 2.992922e-09\n## R-HSA-174184      64       0.6941964 2.606047  1e-10 4.034984e-09 2.992922e-09\n##              rank                   leading_edge\n## R-HSA-141424  759  tags=31%, list=6%, signal=29%\n## R-HSA-141444  759  tags=31%, list=6%, signal=29%\n## R-HSA-162909 3321 tags=57%, list=27%, signal=43%\n## R-HSA-174143 1851 tags=47%, list=15%, signal=40%\n## R-HSA-174178 1851 tags=46%, list=15%, signal=40%\n## R-HSA-174184 1851 tags=45%, list=15%, signal=39%\n##                                                                                                                                                                                                                                                                                                                                                                 core_enrichment\n## R-HSA-141424                                                                                                                                                                                                                             55143/991/1062/10403/220134/79019/55839/54821/4085/81930/332/9212/11004/5347/701/11130/79682/57405/2491/1058/699/1063/55055/79980/9735\n## R-HSA-141444                                                                                                                                                                                                                             55143/991/1062/10403/220134/79019/55839/54821/4085/81930/332/9212/11004/5347/701/11130/79682/57405/2491/1058/699/1063/55055/79980/9735\n## R-HSA-162909 3159/3932/5688/9688/3055/5709/5698/919/5693/5902/5713/5721/5691/292/1104/5685/1794/9631/5690/5684/5686/5695/11168/10213/940/23198/7979/6396/23165/5699/5714/6921/55706/8815/5702/23636/9978/5905/5708/1174/5692/5704/5901/164/60489/4927/79902/5683/10762/1175/5694/8480/11097/5718/5682/5716/9972/904/81929/162/5707/57122/4869/926/5696/7514/79023/3837/920/9818\n## R-HSA-174143                                                                                                                                                                          991/11065/4751/27338/890/983/4085/9212/6790/891/9232/5347/701/6502/5688/5709/26271/5698/5693/5713/5721/5691/5685/5690/5684/5686/5695/10213/23198/7979/5699/5714/5702/5708/5692/10393/5704\n## R-HSA-174178                                                                                                                                                                                                          991/11065/27338/9212/6790/9232/5347/6502/5688/5709/5698/5693/5713/5721/5691/5685/5690/5684/5686/5695/10213/23198/7979/5699/5714/5702/5708/5692/10393/5704\n## R-HSA-174184                                                                                                                                                                                                                  991/11065/27338/890/983/4085/701/5688/5709/5698/5693/5713/5721/5691/5685/5690/5684/5686/5695/10213/23198/7979/5699/5714/5702/5708/5692/10393/5704"},{"path":"reactomepa.html","id":"pathway-visualization","chapter":"9 Reactome enrichment analysis","heading":"9.4 Pathway Visualization","text":"ReactomePA implemented viewPathway() visualized selected reactome pathway. general purpose visualization methods ORA GSEA results provided enrichplot package documented Chapter 14.\nFigure 9.1: Visualize reactome pathway.\n","code":"\nviewPathway(\"E2F mediated regulation of DNA replication\", \n            readable = TRUE, \n            foldChange = geneList)"},{"path":"dose-enrichment.html","id":"dose-enrichment","chapter":"10 Disease enrichment analysis","heading":"10 Disease enrichment analysis","text":"developed DOSE (Yu et al. 2015) package promote investigation diseases. DOSE provides five methods measuring semantic similarities among terms gene products, hypergeometric model gene set enrichment analysis (GSEA) associating disease gene list extracting disease association insight genome wide expression profiles.","code":""},{"path":"dose-enrichment.html","id":"dose-ora","chapter":"10 Disease enrichment analysis","heading":"10.1 Disease over-representation analysis","text":"DOSE supports enrichment analysis Disease Ontology () (Schriml et al. 2011), Network Cancer Gene (. et al. 2016) Disease Gene Network (DisGeNET) (Janet et al. 2015). addition, several visualization methods provided enrichplot help interpreting semantic enrichment results.","code":""},{"path":"dose-enrichment.html","id":"dose-do-ora","chapter":"10 Disease enrichment analysis","heading":"10.1.1 Over-representation analysis for disease ontology","text":"following example, selected fold change 1.5 differential genes analyzing disease association.enrichDO() function requires entrezgene ID vector input, mostly differential gene list gene expression profile studies. Please refer session 16.1 need conver gene ID types entrezgene ID.ont parameter can ‚Äú‚Äù ‚ÄúDOLite,‚Äù DOLite (Du et al. 2009) constructed aggregate redundant terms. DOLite data updated, recommend user use ont=\"\". pvalueCutoff setting cutoff value p value adjusted p value; pAdjustMethod setting p value correction methods, include Bonferroni correction (‚Äúbonferroni‚Äù), Holm (‚Äúholm‚Äù), Hochberg (‚Äúhochberg‚Äù), Hommel (‚Äúhommel‚Äù), Benjamini & Hochberg (‚ÄúBH‚Äù) Benjamini & Yekutieli (‚Äú‚Äù) qvalueCutoff used control q-values.universe setting background gene universe testing. user explicitly setting parameter, enrichDO() set universe human genes annotation.minGSSize (maxGSSize) indicates terms minGSSize (less maxGSSize) genes annotated tested.readable logical parameter, indicates whether entrezgene IDs mapping gene symbols (see also setReadable).","code":"\nlibrary(DOSE)\ndata(geneList)\ngene <- names(geneList)[abs(geneList) > 1.5]\nhead(gene)## [1] \"4312\"  \"8318\"  \"10874\" \"55143\" \"55388\" \"991\"\nx <- enrichDO(gene          = gene,\n              ont           = \"DO\",\n              pvalueCutoff  = 0.05,\n              pAdjustMethod = \"BH\",\n              universe      = names(geneList),\n              minGSSize     = 5,\n              maxGSSize     = 500,\n              qvalueCutoff  = 0.05,\n              readable      = FALSE)\nhead(x)##                    ID                    Description GeneRatio  BgRatio\n## DOID:170     DOID:170         endocrine gland cancer    48/331 472/6268\n## DOID:10283 DOID:10283                prostate cancer    40/331 394/6268\n## DOID:3459   DOID:3459               breast carcinoma    37/331 357/6268\n## DOID:3856   DOID:3856 male reproductive organ cancer    40/331 404/6268\n## DOID:824     DOID:824                  periodontitis    16/331 109/6268\n## DOID:3905   DOID:3905                 lung carcinoma    43/331 465/6268\n##                  pvalue    p.adjust      qvalue\n## DOID:170   5.662129e-06 0.004784499 0.003826407\n## DOID:10283 3.859157e-05 0.013921739 0.011133923\n## DOID:3459  4.942629e-05 0.013921739 0.011133923\n## DOID:3856  6.821467e-05 0.014410349 0.011524689\n## DOID:824   1.699304e-04 0.018859464 0.015082872\n## DOID:3905  1.749754e-04 0.018859464 0.015082872\n##                                                                                                                                                                                                                                                   geneID\n## DOID:170   10874/7153/1381/6241/11065/10232/332/6286/2146/10112/891/9232/4171/993/5347/4318/3576/1515/4821/8836/3159/7980/5888/333/898/9768/4288/3551/2152/9590/185/7043/3357/2952/5327/3667/1634/1287/4582/7122/3479/4680/6424/80310/652/8839/9547/1524\n## DOID:10283                                          4312/6280/6279/597/3627/332/6286/2146/4321/4521/891/5347/4102/4318/701/3576/79852/10321/6352/4288/3551/2152/247/2952/3487/367/3667/4128/4582/563/3679/4117/7031/3479/6424/10451/80310/652/4036/10551\n## DOID:3459                                                          4312/6280/6279/7153/4751/890/4085/332/6286/6790/891/9232/10855/4171/5347/4318/701/2633/3576/9636/898/8792/4288/2952/4982/4128/4582/7031/3479/771/4250/2066/3169/10647/5304/5241/10551\n## DOID:3856                                           4312/6280/6279/597/3627/332/6286/2146/4321/4521/891/5347/4102/4318/701/3576/79852/10321/6352/4288/3551/2152/247/2952/3487/367/3667/4128/4582/563/3679/4117/7031/3479/6424/10451/80310/652/4036/10551\n## DOID:824                                                                                                                                                                   4312/6279/820/7850/4321/3595/4318/4069/3576/1493/6352/8842/185/2952/5327/4982\n## DOID:3905                          4312/6280/2305/9133/6279/7153/6278/6241/55165/11065/8140/10232/332/6286/3002/9212/4521/891/4171/9928/8061/4318/3576/1978/1894/7980/7083/898/6352/8842/4288/2152/2697/2952/3572/4582/7049/563/3479/1846/3117/2532/2922\n##            Count\n## DOID:170      48\n## DOID:10283    40\n## DOID:3459     37\n## DOID:3856     40\n## DOID:824      16\n## DOID:3905     43"},{"path":"dose-enrichment.html","id":"dose-ncg-ora","chapter":"10 Disease enrichment analysis","heading":"10.1.2 Over-representation analysis for the network of cancer gene","text":"Network Cancer Gene (NCG) (. et al. 2016) manually curated repository cancer genes. NCG release 5.0 (Aug.¬†2015) collects 1,571 cancer genes 175 published studies. DOSE supports analyzing gene list determine whether enriched genes known mutated given cancer type.","code":"\ngene2 <- names(geneList)[abs(geneList) < 3]\nncg <- enrichNCG(gene2) \nhead(ncg)##                                                                      ID\n## pan-cancer_paediatric                             pan-cancer_paediatric\n## triple_negative_breast_cancer             triple_negative_breast_cancer\n## breast_cancer                                             breast_cancer\n## soft_tissue_sarcoma                                 soft_tissue_sarcoma\n## paediatric_high-grade_glioma               paediatric_high-grade_glioma\n## pancreatic_cancer_(all_histologies) pancreatic_cancer_(all_histologies)\n##                                                             Description\n## pan-cancer_paediatric                             pan-cancer_paediatric\n## triple_negative_breast_cancer             triple_negative_breast_cancer\n## breast_cancer                                             breast_cancer\n## soft_tissue_sarcoma                                 soft_tissue_sarcoma\n## paediatric_high-grade_glioma               paediatric_high-grade_glioma\n## pancreatic_cancer_(all_histologies) pancreatic_cancer_(all_histologies)\n##                                     GeneRatio  BgRatio       pvalue\n## pan-cancer_paediatric                161/1782 182/2372 2.748816e-06\n## triple_negative_breast_cancer         71/1782  75/2372 6.564667e-06\n## breast_cancer                        146/1782 171/2372 5.249102e-04\n## soft_tissue_sarcoma                   26/1782  26/2372 5.633144e-04\n## paediatric_high-grade_glioma          25/1782  25/2372 7.524752e-04\n## pancreatic_cancer_(all_histologies)   39/1782  41/2372 7.825494e-04\n##                                         p.adjust       qvalue\n## pan-cancer_paediatric               0.0002226541 0.0001504615\n## triple_negative_breast_cancer       0.0002658690 0.0001796646\n## breast_cancer                       0.0105644165 0.0071390469\n## soft_tissue_sarcoma                 0.0105644165 0.0071390469\n## paediatric_high-grade_glioma        0.0105644165 0.0071390469\n## pancreatic_cancer_(all_histologies) 0.0105644165 0.0071390469\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           geneID\n## pan-cancer_paediatric               2146/55353/4609/1029/3575/22806/3418/3066/2120/30012/867/7468/7545/3195/865/64109/4613/613/11177/7490/238/10736/10054/5771/4893/140885/1785/9760/3417/6597/6476/9126/4869/10320/7307/80204/1050/8028/2312/6608/896/894/2196/4849/7023/5093/5079/5293/5727/55181/171017/51322/5781/3718/55294/60/673/8085/5897/4851/51176/1108/7764/10664/6098/2332/2201/6495/3845/7015/1441/2782/64919/4298/23512/8239/29102/6929/8021/6134/6598/4209/5290/22941/8726/207/3717/2033/10716/4928/6932/694/5156/10019/6886/9968/7080/2623/7874/1654/4149/3020/23219/55252/55729/10735/5728/4853/23451/51341/387/3206/6146/79718/2624/63035/3815/171023/23269/25/9839/23592/5896/7403/2260/54880/3716/9203/57178/6777/5789/4297/29072/90/546/120/25836/8289/4345/9611/5925/4763/1997/1499/7157/3399/5295/1387/4602/51564/1027/4005/2322/2078/678/6403/55709/1277/7494/64061/2625\n## triple_negative_breast_cancer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 6790/898/4609/1029/1789/4436/2120/867/7128/1788/1030/7490/2271/238/675/2047/4914/1316/5291/5293/5781/55294/8085/4851/4170/3845/355/1616/4854/5290/207/2033/4233/29110/2903/5979/5728/4853/2624/3815/10000/7403/2260/55193/472/5789/4297/2065/4286/8626/8405/8289/10499/55164/5925/4763/23405/1499/4921/7157/5295/1387/2078/324/7248/7048/22894/3480/2045/2066/2625\n## breast_cancer                                                                                                                     4751/701/898/639/29028/4609/7399/1029/1520/4436/83990/11200/10849/2072/4771/865/999/1788/26191/1030/10801/83737/6262/1956/672/8590/675/4893/6597/8202/2778/208/51412/896/2132/677/4849/4221/65220/2854/55294/673/4193/8085/4851/57127/841/3265/7764/10664/9721/3845/3956/868/9175/6602/11174/8239/9860/6954/5290/1523/207/2033/2334/3782/8312/9514/5156/186/54897/71/79728/545/143/2064/4089/8471/8314/91/5289/1021/10735/5979/5728/4853/23451/9439/6738/387/55770/79718/4301/171023/23013/51135/80243/4292/149076/10983/6103/7403/54880/4916/55193/9203/1635/1495/2309/472/5076/2909/5789/4297/2065/29072/2263/546/8289/2874/9611/5925/6416/4763/7157/4088/23152/5295/6794/1387/4602/1027/5737/324/595/7188/4681/4214/7494/2099/3480/4485/2891/6926/3169/2625\n## soft_tissue_sarcoma                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             999/6850/4914/4342/2185/55294/2041/4851/2044/4058/5290/4486/5297/5728/3815/2324/7403/546/5925/4763/1499/7157/5159/2045/3667/2066\n## paediatric_high-grade_glioma                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             4609/1029/1019/4613/1030/1956/4914/896/894/673/8493/5290/4233/5156/1021/63035/54880/4916/90/546/4763/7157/5295/595/4915\n## pancreatic_cancer_(all_histologies)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      1029/4771/8997/7159/2011/6597/7307/3710/6710/55294/7091/3845/23654/7046/3096/4089/91/8241/54549/92/23451/63035/7403/55193/23309/472/800/29072/23077/23499/8289/54894/6416/7157/4088/182/7048/2199/26960\n##                                     Count\n## pan-cancer_paediatric                 161\n## triple_negative_breast_cancer          71\n## breast_cancer                         146\n## soft_tissue_sarcoma                    26\n## paediatric_high-grade_glioma           25\n## pancreatic_cancer_(all_histologies)    39"},{"path":"dose-enrichment.html","id":"dose-dgn-ora","chapter":"10 Disease enrichment analysis","heading":"10.1.3 Over-representation analysis for the disease gene network","text":"DisGeNET(Janet et al. 2015) integrative comprehensive resources gene-disease associations several public data sources literature. contains gene-disease associations snp-gene-disease associations.enrichment analysis disease-gene associations supported enrichDGN function analysis snp-gene-disease associations supported enrichDGNv function.","code":"\ndgn <- enrichDGN(gene) \nhead(dgn)##                ID                              Description GeneRatio   BgRatio\n## C0010278 C0010278                         Craniosynostosis    43/497 488/21671\n## C0853879 C0853879             Invasive carcinoma of breast    42/497 473/21671\n## C4733092 C4733092 estrogen receptor-negative breast cancer    34/497 356/21671\n## C3642347 C3642347              Basal-Like Breast Carcinoma    28/497 245/21671\n## C3642345 C3642345               Luminal A Breast Carcinoma    22/497 153/21671\n## C0036202 C0036202                              Sarcoidosis    36/497 413/21671\n##                pvalue     p.adjust       qvalue\n## C0010278 4.609534e-14 2.267976e-10 1.636811e-10\n## C0853879 7.105190e-14 2.267976e-10 1.636811e-10\n## C4733092 2.446675e-12 4.864593e-09 3.510804e-09\n## C3642347 3.047991e-12 4.864593e-09 3.510804e-09\n## C3642345 7.034749e-12 8.438458e-09 6.090082e-09\n## C0036202 7.930882e-12 8.438458e-09 6.090082e-09\n##                                                                                                                                                                                                                           geneID\n## C0010278 4312/8318/6280/1062/6279/6278/3627/820/27299/6362/81620/2146/3002/29968/990/4318/4069/3576/6890/23594/26279/1493/6352/4998/2152/2697/185/4330/5327/4982/1300/3667/2200/9607/3572/563/7031/3479/6424/1846/3117/1308/2625\n## C0853879        4312/7153/6278/9787/9582/51203/890/983/5080/2146/1111/9232/10855/4171/6664/4102/2173/4318/701/3576/1978/8836/53335/1894/7980/8792/8842/2151/185/2952/367/4982/4582/6926/3479/1602/23158/2066/3169/5304/2625/5241\n## C4733092                                         2305/6278/79733/6241/81930/81620/2146/3620/29968/11004/8061/3576/1894/2491/7083/8792/214/5327/367/4982/3667/4582/27324/3479/1846/80129/4137/8839/3169/1408/5304/2625/5241/10551\n## C3642347                                                                          2305/1062/4605/9833/7368/11065/10232/55765/5163/2146/2568/3620/6790/6664/29127/2173/4318/3576/3159/8792/6663/27324/3479/1846/18/3169/2625/5241\n## C3642345                                                                                                         2305/9833/7153/55355/1111/3161/4318/3576/2001/6663/4288/2152/185/4128/4582/27324/80129/3169/5304/8614/2625/5241\n## C0036202                               4312/6280/6279/10403/3627/6373/4283/27299/6362/3002/4321/6355/6364/29851/4318/5004/4069/3576/26227/6890/6352/4485/23541/185/7043/6863/2952/4982/25802/4582/2053/3479/3117/2167/80736/1524\n##          Count\n## C0010278    43\n## C0853879    42\n## C4733092    34\n## C3642347    28\n## C3642345    22\n## C0036202    36\nsnp <- c(\"rs1401296\", \"rs9315050\", \"rs5498\", \"rs1524668\", \"rs147377392\",\n         \"rs841\", \"rs909253\", \"rs7193343\", \"rs3918232\", \"rs3760396\",\n         \"rs2231137\", \"rs10947803\", \"rs17222919\", \"rs386602276\", \"rs11053646\",\n         \"rs1805192\", \"rs139564723\", \"rs2230806\", \"rs20417\", \"rs966221\")\ndgnv <- enrichDGNv(snp)\nhead(dgnv)##                ID               Description GeneRatio    BgRatio       pvalue\n## C0010054 C0010054 Coronary Arteriosclerosis      6/17 440/194515 1.568917e-12\n## C0151744 C0151744       Myocardial Ischemia      4/17 103/194515 1.754840e-10\n## C0031099 C0031099             Periodontitis      4/17 116/194515 2.839985e-10\n## C0007785 C0007785       Cerebral Infarction      4/17 123/194515 3.599531e-10\n## C0003850 C0003850          Arteriosclerosis      4/17 267/194515 8.145389e-09\n## C0004153 C0004153           Atherosclerosis      4/17 281/194515 9.996713e-09\n##              p.adjust qvalue\n## C0010054 2.761295e-10     NA\n## C0151744 1.544259e-08     NA\n## C0031099 1.583793e-08     NA\n## C0007785 1.583793e-08     NA\n## C0003850 2.867177e-07     NA\n## C0004153 2.932369e-07     NA\n##                                                             geneID Count\n## C0010054 rs5498/rs147377392/rs11053646/rs1805192/rs2230806/rs20417     6\n## C0151744                   rs5498/rs147377392/rs11053646/rs1805192     4\n## C0031099                         rs5498/rs909253/rs1805192/rs20417     4\n## C0007785                rs147377392/rs11053646/rs1805192/rs2230806     4\n## C0003850                        rs5498/rs1805192/rs2230806/rs20417     4\n## C0004153                        rs5498/rs1805192/rs2230806/rs20417     4"},{"path":"dose-enrichment.html","id":"dose-gsea","chapter":"10 Disease enrichment analysis","heading":"10.2 Disease gene set enrichment analysis","text":"","code":""},{"path":"dose-enrichment.html","id":"gsedo-fuction","chapter":"10 Disease enrichment analysis","heading":"10.2.1 gseDO fuction","text":"following example, order speedup compilation document, gene sets size 120 tested 100 permutations performed.","code":"\nlibrary(DOSE)\ndata(geneList)\ny <- gseDO(geneList,\n           minGSSize     = 120,\n           pvalueCutoff  = 0.2,\n           pAdjustMethod = \"BH\",\n           verbose       = FALSE)\nhead(y, 3)##                        ID                          Description setSize\n## DOID:0050338 DOID:0050338 primary bacterial infectious disease     214\n## DOID:104         DOID:104         bacterial infectious disease     243\n## DOID:399         DOID:399                         tuberculosis     140\n##              enrichmentScore      NES       pvalue     p.adjust      qvalues\n## DOID:0050338       0.4569856 2.045798 1.017529e-09 1.597521e-07 6.212285e-08\n## DOID:104           0.4286201 1.946746 4.678471e-09 3.672600e-07 1.428165e-07\n## DOID:399           0.4999969 2.131248 1.068866e-08 5.593732e-07 2.175236e-07\n##              rank                   leading_edge\n## DOID:0050338 1850 tags=35%, list=15%, signal=30%\n## DOID:104     1808 tags=32%, list=14%, signal=28%\n## DOID:399     1808 tags=36%, list=14%, signal=31%\n##                                                                                                                                                                                                                                                                                                                                                                                            core_enrichment\n## DOID:0050338                 4312/597/3627/6373/820/3620/6364/29851/4318/3576/26227/6890/952/1493/6352/3934/54210/3932/5551/3559/6347/6402/639/94025/3126/3001/6351/1236/5698/3948/919/3458/959/7296/79139/3804/4159/942/3329/9235/1234/7096/3383/4068/6367/5806/100/3659/4360/939/6891/4210/671/7422/929/26191/6504/27087/4282/7124/5027/5329/3569/4049/7097/56244/7852/1378/5133/5743/348/1118/3119/7415\n## DOID:104     4312/597/3627/6373/820/3620/6364/29851/4318/3576/26227/6890/952/1493/6352/3934/54210/10663/3932/5551/3559/6772/6347/6402/639/94025/3126/3001/6351/1236/3654/5698/3948/919/3458/959/7296/79139/3804/4159/942/3329/9235/3689/1234/7096/3383/4068/6367/5806/100/3659/4360/939/6891/4210/671/7422/929/26191/6504/27087/4282/7124/5027/5329/3569/4049/7097/56244/7852/1378/5133/5743/348/1118/3119\n## DOID:399                                                                                                                                             4312/597/3627/820/6364/29851/4318/3576/26227/1493/6352/3934/5551/3559/6347/94025/3001/6351/3948/919/3458/959/4159/942/9235/7096/3383/4068/6367/5806/100/3659/4360/939/671/929/26191/27087/4282/7124/5027/3569/7097/56244/7852/1378/5133/348/1118/3119"},{"path":"dose-enrichment.html","id":"gsencg-fuction","chapter":"10 Disease enrichment analysis","heading":"10.2.2 gseNCG fuction","text":"","code":"\nncg <- gseNCG(geneList,\n              minGSSize     = 120,\n              pvalueCutoff  = 0.2,\n              pAdjustMethod = \"BH\",\n              verbose       = FALSE)\nncg <- setReadable(ncg, 'org.Hs.eg.db')\nhead(ncg, 3) ## [1] ID              Description     setSize         enrichmentScore\n## [5] NES             pvalue          p.adjust        qvalues        \n## <0 rows> (or 0-length row.names)"},{"path":"dose-enrichment.html","id":"gsedgn-fuction","chapter":"10 Disease enrichment analysis","heading":"10.2.3 gseDGN fuction","text":"","code":"\ndgn <- gseDGN(geneList,\n              minGSSize     = 120,\n              pvalueCutoff  = 0.2,\n              pAdjustMethod = \"BH\",\n              verbose       = FALSE)\ndgn <- setReadable(dgn, 'org.Hs.eg.db')\nhead(dgn, 3) ##                ID                  Description setSize enrichmentScore\n## C0024266 C0024266 Lymphocytic Choriomeningitis     120       0.5712593\n## C0151779 C0151779           Cutaneous Melanoma     415       0.3963772\n## C0205682 C0205682              Waist-Hip Ratio     401      -0.4425633\n##                NES pvalue p.adjust      qvalues rank\n## C0024266  2.389462  1e-10 2.69e-08 1.731579e-08 2579\n## C0151779  1.933238  1e-10 2.69e-08 1.731579e-08 1864\n## C0205682 -1.938310  1e-10 2.69e-08 1.731579e-08 2011\n##                            leading_edge\n## C0024266 tags=48%, list=21%, signal=38%\n## C0151779 tags=27%, list=15%, signal=24%\n## C0205682 tags=28%, list=16%, signal=24%\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 core_enrichment\n## C0024266                                                                                                                                                                                                                                                                                                                                                                                S100A9/CXCL10/CXCL9/EZH2/GZMB/ICOS/USP18/CXCL8/CTLA4/TREM1/PRF1/ADM/CA9/STAT1/CCL2/SELL/CDKN2A/IL7/IL7R/IFNG/CCR5/IL27RA/SH2D1A/FCER1G/CDK2AP2/CPVL/CD27/PSMB10/PTPN22/SLAMF1/KDM1A/TNF/IL6/FGL2/TLR2/RPAIN/NELFCD/PDCD1/WAS/HIF1A/ATP5F1B/FCGR2B/EGR2/STX11/CXCR3/TYROBP/YME1L1/SOSTDC1/PTPN2/TRAF1/HNF1A/IRF9/PML/NR0B2/IL2/TOX/AGFG1\n## C0151779                                                          MMP1/CDCA8/S100A8/TOP2A/PBK/ISG20/NEK2/CCL18/PDK1/EZH2/AURKB/CHAF1B/KIF18B/MMP12/LAG3/DTL/PTTG1/SOX11/CDKN3/PRAME/PLK1/FABP7/MMP9/GBP1/CXCL8/CTLA4/SOX10/PROM1/MKI67/FANCA/MCM6/MCM4/PITX1/DBF4/IL2RA/TYMS/PLA2G2A/MYC/PCNA/NDRG1/CDKAL1/BLM/E2F1/OCA2/CD163/CDKN2A/NME1/TCF21/KMO/VCAM1/RUNX3/IFNG/MCM7/KYNU/STIP1/CCDC88C/GSTP1/CHAF1A/MSH2/CYP27B1/MAGEA1/CDKN2C/PRDM16/MX2/CDK4/GAPDH/MCM3/ICAM1/CCL22/CHEK2/CXCL5/ERCC4/SPP1/TEAD4/MTAP/HCP5/MRC1/TUBB3/CD27/S100B/CSPG4/PLP2/NBN/VEGFA/IFNW1/CDK16/CDH1/CCNF/CBLIF/SOX4/PARP1/SLC16A1/DNMT1/MAP2K1/ATG5/TNF/NXT1/CDKN2B/RBX1/IL6/TLR2/CXCR4/PDCD1/PTGS2/HIF1A/JMJD6/XRCC3/HLA-DQB1/PVR/CASP10/TGFA/EGFR\n## C0205682 RETREG3/JMJD1C/SH2B1/BDNF/ARHGEF26/PDE5A/BPTF/SMAD3/TTC39A/ATP2B1/ARID4A/HOXC4/NID1/LAMA4/LRRC36/NUDT18/ANKRD28/HECTD4/COL11A1/MEIS1/INSR/CUL9/NRIP3/BCL2/CD34/EZH1/DYM/NDST1/COL15A1/VGLL3/CCND1/ZCCHC10/HOXC6/RAB26/QTRT1/MEIS2/ARID5B/AHNAK/FGF1/CAPRIN2/LAMB1/CPEB3/ELOVL4/CDADC1/PDE8B/ZNF268/NRP1/SYTL2/NR5A2/DGLUCY/SEMA3B/NID2/SIK3/PRR5L/FGF2/COL8A1/RAPGEF3/RBM6/CDH13/JCAD/NAV3/TRIM8/PPIEL/PTPRG/NBL1/CALCRL/PPL/LPL/BCKDHB/MAPKBP1/CNTLN/BBS4/P4HTM/FTO/PDZRN4/PDGFC/SGCD/NRXN3/AFF3/IGF1R/ABCC8/MPPED2/COL5A1/COL6A2/LOXL1/CYP21A2/LTBP2/TTC28/PATJ/PCSK5/WNT4/TTC12/NISCH/ASTN2/TCEA2/MN1/SETBP1/TAOK1/MAST4/ITGA7/ITGBL1/COL14A1/C1QTNF3/ZNF423/IQCH/MYH11/ADH1B/ABLIM3/MAPT/STC2/TFAP2B/CYBRD1/SCUBE2"},{"path":"meshes-enrichment.html","id":"meshes-enrichment","chapter":"11 MeSH enrichment analysis","heading":"11 MeSH enrichment analysis","text":"meshes package (Yu 2018) supports enrichment analysis (-representation analysis gene set\nenrichment analysis) gene list whole expression profile using MeSH\nannotation. Data source gendoo, gene2pubmed RBBH \nsupported. User can select interesting category test. 16\ncategories MeSH supported. analysis supports 200 species (see also Chapter 4 details).","code":""},{"path":"meshes-enrichment.html","id":"meshes-ora","chapter":"11 MeSH enrichment analysis","heading":"11.1 MeSH over-representation analysis","text":"First, need load/fetch species-specific MeSH annotation database:example, use data source gendoo C (Diseases) category.","code":"\n#############################\n## BioC 2.14 to BioC 3.13  ##\n#############################\n##\n## library(MeSH.Hsa.eg.db)\n## db <- MeSH.Hsa.eg.db\n##\n##---------------------------\n\n# From BioC 3.14 (Nov. 2021, with R-4.2.0)\nlibrary(AnnotationHub)\nah <- AnnotationHub()\nhsa <- query(ah, c(\"MeSHDb\", \"Homo sapiens\"))\nfile_hsa <- hsa[[1]]\ndb <- MeSHDbi::MeSHDb(file_hsa)\nlibrary(meshes)\ndata(geneList, package=\"DOSE\")\nde <- names(geneList)[1:100]\nx <- enrichMeSH(de, MeSHDb = db, database='gendoo', category = 'C')\nhead(x)##              ID            Description GeneRatio   BgRatio       pvalue\n## D000705 D000705               Anaphase    26/100 232/26076 4.495523e-31\n## D019926 D019926               Cyclin B    30/100 428/26076 1.061989e-29\n## D018386 D018386           Kinetochores    24/100 224/26076 3.337217e-28\n## D020090 D020090 Chromosome Segregation    26/100 362/26076 5.663108e-26\n## D011123 D011123             Polyploidy    16/100 169/26076 3.951760e-18\n## D016547 D016547                   <NA>    22/100 476/26076 6.849607e-18\n##             p.adjust       qvalue\n## D000705 2.036472e-27 1.360487e-27\n## D019926 2.405404e-26 1.606957e-26\n## D018386 5.039198e-25 3.366491e-25\n## D020090 6.413470e-23 4.284588e-23\n## D011123 3.580295e-15 2.391855e-15\n## D016547 5.171453e-15 3.454845e-15\n##                                                                                                                                                              geneID\n## D000705                    991/2305/9493/1062/9133/10403/7153/6241/55165/11065/220134/22974/4751/983/54821/10232/4085/81930/332/3832/7272/9212/1111/9055/10112/6790\n## D019926 991/2305/9493/1062/3868/4605/9133/10403/7153/23397/9787/11065/55872/83461/22974/890/983/10232/4085/5080/81620/332/3832/7272/64151/8208/1111/9055/10112/6790\n## D018386                             55143/991/1062/10403/7153/9787/11065/220134/22974/10460/4751/79019/55839/983/54821/4085/81930/332/3832/7272/9212/1111/9055/6790\n## D020090                   55143/991/2305/9493/1062/9133/10403/7153/9787/11065/51203/22974/10460/4751/79019/55839/983/54821/4085/81930/332/7272/64151/9212/1111/6790\n## D011123                                                                             55143/991/2305/9493/1062/4605/9133/7153/890/10232/4085/81620/332/9212/1111/6790\n## D016547                                        55143/2305/9493/1062/10403/7153/23397/9787/22974/983/4085/81930/332/3832/64151/9212/1111/9055/3833/146909/10112/6790\n##         Count\n## D000705    26\n## D019926    30\n## D018386    24\n## D020090    26\n## D011123    16\n## D016547    22"},{"path":"meshes-enrichment.html","id":"meshes-gsea","chapter":"11 MeSH enrichment analysis","heading":"11.2 MeSH gene set enrichment analysis","text":"following example, use data source gene2pubmed test category G (Phenomena Processes).User can use visualization methods implemented enrichplot visualize enrichment results. visualization methods, ‚Äôs much easier interpret enriched results.","code":"\ny <- gseMeSH(geneList, MeSHDb = db, database = 'gene2pubmed', category = \"G\")\nhead(y)##              ID        Description setSize enrichmentScore      NES pvalue\n## D000705 D000705           Anaphase     482       0.4830831 2.402905  1e-10\n## D000782 D000782         Aneuploidy     279       0.4471502 2.118962  1e-10\n## D002842 D002842         Chromatids     204       0.5069599 2.307263  1e-10\n## D007108 D007108   Immune Tolerance     476       0.4136918 2.053376  1e-10\n## D007111 D007111 Immunity, Cellular     488       0.3821435 1.902697  1e-10\n## D011123 D011123         Polyploidy     170       0.5607059 2.527232  1e-10\n##             p.adjust      qvalues rank                   leading_edge\n## D000705 8.108333e-09 5.991228e-09 1499 tags=23%, list=12%, signal=21%\n## D000782 8.108333e-09 5.991228e-09  535  tags=17%, list=4%, signal=17%\n## D002842 8.108333e-09 5.991228e-09 1354 tags=23%, list=11%, signal=21%\n## D007108 8.108333e-09 5.991228e-09 2119 tags=34%, list=17%, signal=30%\n## D007111 8.108333e-09 5.991228e-09 1824 tags=27%, list=15%, signal=24%\n## D011123 8.108333e-09 5.991228e-09 1905 tags=34%, list=15%, signal=29%\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         core_enrichment\n## D000705                                                                                                                                                                                                                                                     991/2305/9493/1062/10403/7153/6241/55165/11065/220134/22974/4751/890/983/54821/10232/4085/81930/81620/332/3832/7272/9212/1111/9055/3833/10112/6790/891/24137/9232/4001/9928/1164/11004/990/5347/29127/701/11130/57405/10615/1894/8438/9700/5888/4288/29899/6502/1058/54478/699/4609/1063/5688/5709/26271/55055/51053/641/5698/3925/4860/5693/58516/5713/85377/3930/79980/9735/5721/5691/54205/5499/51224/10051/5685/78995/1019/23481/5479/5690/5684/5885/5686/5695/79017/11200/55131/203068/7027/2072/10213/191/23185/9425/7283/23198/1652/10808/6732/9100/5822/86/10436/999/5699/5714/1994\n## D000782                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              4312/991/1062/10403/7153/11065/22974/10460/4751/79019/55839/890/983/4085/332/7272/9212/8208/1111/6790/891/24137/9232/4171/11004/5347/701/11130/79682/2491/9700/5888/7083/898/4288/10733/2237/6502/1058/699/4609/5111/51053/1869/1029/1763/136/4904\n## D002842                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        8318/55143/991/1062/7153/11065/10635/983/54821/4085/9212/8208/9232/11004/5347/55215/701/10615/79075/9700/5888/2237/54962/5984/3838/1058/699/4609/5111/10212/4176/10036/79980/5982/9735/995/10051/55379/26502/4172/5885/11168/203068/5983/10592/8914/4683\n## D007108 4312/6280/6279/8685/7153/983/6362/3002/50852/3620/891/4174/4001/4171/3595/29851/4318/4061/3576/8792/1493/6352/7037/3934/4175/54210/3932/5551/3559/6772/51311/6347/712/639/94025/914/64581/3126/3112/10437/3561/5111/6351/9688/917/1236/10859/6590/3654/5698/3897/1051/3574/3575/919/915/22806/4067/8564/3806/7412/864/3495/11260/3458/959/6634/3903/3824/3162/925/5031/4436/942/80328/8876/969/995/1991/10288/9235/2956/1019/3689/5788/1234/916/467/259197/3383/4068/5885/30009/5806/6375/3600/3659/6696/940/23586/2219/939/4678/6360/5880/7128/5588/3965/9308/7422/865/10148/930/6282/4624/5047/1994/929/142/26191/6504/5467/6628/945/3601/4282/6850/6427/7124/912/5027/3569/7097/6749/11335/56244/83737/7852/613/2208/5133/5743/7454/6731/3119/5817/7186/2213/5971/7490/8625/3135/60489/9021/3596/834/4192/356/7305/7133/26986/958/5724/27350\n## D007111                                                                                                                                                                      8685/597/3627/820/983/6362/332/55765/3002/3620/10578/3595/11004/3576/6890/1521/952/1493/6352/4288/7037/4111/5551/3559/768/6772/6347/6402/914/64581/10437/4609/3001/5341/6351/1236/10859/4830/136/3574/3575/4904/919/4860/3806/7412/2730/4938/2821/3458/959/6564/2676/3824/5670/2950/3162/5449/925/4953/4436/1594/942/80328/578/1116/2224/11262/10288/9235/6361/9997/5788/1234/2023/916/259197/3383/4068/962/6367/30009/3394/5806/6375/7295/100/53637/3600/6696/923/940/23586/3735/6285/1464/7128/5588/3965/6891/9308/8914/81622/7422/10148/8477/930/5367/6504/3452/945/3601/6850/7124/912/51560/5996/5027/3569/4049/10875/7097/2048/7852/5133/7454/3091/3119/5817/3820/843\n## D011123                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 2305/4605/9133/7153/79733/890/983/4085/81620/332/2146/7272/9212/51659/1111/6790/891/9232/990/5347/701/1978/9700/898/23594/6502/699/4609/5111/10397/26271/51053/1869/1029/4830/3925/5693/2810/8607/58/1019/11200/2072/7283/7422/5315/865/86/63967/5604/9978/4049/3619/7454/58477/1956/28985/6119"},{"path":"universal-api.html","id":"universal-api","chapter":"12 Universal enrichment analysis","heading":"12 Universal enrichment analysis","text":"clusterProfiler package (Yu et al. 2012) supports hypergeometric test gene set enrichment analyses many ontology/pathway, ‚Äôs still enough users may want analyze data unsupported organisms, slim version GO, novel functional annotation (e.g.¬†GO via BlastGO KEGG via KAAS), unsupported ontologies/pathways customized annotations.clusterProfiler package provides enricher() function hypergeometric test GSEA() function gene set enrichment analysis designed accept user defined annotation. accept two additional parameters TERM2GENE TERM2NAME. indicated parameter names, TERM2GENE data.frame first column term ID second column corresponding mapped gene TERM2NAME data.frame first column term ID second column corresponding term name. TERM2NAME optional.","code":""},{"path":"universal-api.html","id":"input-data","chapter":"12 Universal enrichment analysis","heading":"12.1 Input data","text":"representation analysis, need gene vector, vector gene IDs. gene IDs can obtained differential expression analysis (e.g. DESeq2 package).gene set enrichment analysis, need ranked list genes. DOSE provides example dataset geneList derived R package breastCancerMAINZ contained 200 samples, including 29 samples grade , 136 samples grade II 35 samples grade III. computed ratios geometric means grade III samples versus geometric means grade samples. Logarithm ratios (base 2) stored geneList dataset. want prepare geneList, please refer FAQ.can load sample data R via:Suppose define fold change greater 2 DEGs:","code":"\ndata(geneList, package=\"DOSE\")\nhead(geneList)##     4312     8318    10874    55143    55388      991 \n## 4.572613 4.514594 4.418218 4.144075 3.876258 3.677857\ngene <- names(geneList)[abs(geneList) > 2]\nhead(gene)## [1] \"4312\"  \"8318\"  \"10874\" \"55143\" \"55388\" \"991\""},{"path":"universal-api.html","id":"cell-marker","chapter":"12 Universal enrichment analysis","heading":"12.2 Cell Marker","text":"","code":"\ncell_marker_data <- vroom::vroom('http://bio-bigdata.hrbmu.edu.cn/CellMarker/download/Human_cell_markers.txt')\n\n## instead of `cellName`, users can use other features (e.g. `cancerType`)\ncells <- cell_marker_data %>%\n    dplyr::select(cellName, geneID) %>%\n    dplyr::mutate(geneID = strsplit(geneID, ', ')) %>%\n    tidyr::unnest()"},{"path":"universal-api.html","id":"cell-marker-ora","chapter":"12 Universal enrichment analysis","heading":"12.2.1 Cell Marker over-presentaton analysis","text":"","code":"\nx <- enricher(gene, TERM2GENE = cells)\nhead(x)##                                            ID            Description GeneRatio\n## Neural progenitor cell Neural progenitor cell Neural progenitor cell    33/153\n## MKI67+ progenitor cell MKI67+ progenitor cell MKI67+ progenitor cell    20/153\n## DCLK1+ progenitor cell DCLK1+ progenitor cell DCLK1+ progenitor cell     7/153\n##                          BgRatio       pvalue     p.adjust       qvalue\n## Neural progenitor cell 176/11582 3.395466e-29 3.259648e-27 2.716373e-27\n## MKI67+ progenitor cell 111/11582 1.426062e-17 6.845100e-16 5.704250e-16\n## DCLK1+ progenitor cell  99/11582 3.298755e-04 1.055601e-02 8.796679e-03\n##                                                                                                                                                                                              geneID\n## Neural progenitor cell 991/9493/9833/9133/10403/7153/259266/6241/9787/11065/55355/55872/51203/83461/22974/10460/79019/55839/890/983/4085/5080/332/3832/9212/51659/9055/891/4174/9232/1602/2018/4137\n## MKI67+ progenitor cell                                                                       991/9133/10403/7153/259266/6241/9787/11065/51203/22974/10460/890/983/332/9212/9055/891/9232/2167/51705\n## DCLK1+ progenitor cell                                                                                                                                        1307/730/54829/10234/79901/57758/4969\n##                        Count\n## Neural progenitor cell    33\n## MKI67+ progenitor cell    20\n## DCLK1+ progenitor cell     7"},{"path":"universal-api.html","id":"cell-marker-gsea","chapter":"12 Universal enrichment analysis","heading":"12.2.2 Cell Marker gene set enrichment analysis","text":"","code":"\ny <- GSEA(geneList, TERM2GENE = cells)\nhead(y)##                                                            ID\n## FGFR1HighNME5- epithelial cell FGFR1HighNME5- epithelial cell\n## FOXN4+ cell                                       FOXN4+ cell\n## Leydig precursor cell                   Leydig precursor cell\n## Neural progenitor cell                 Neural progenitor cell\n## Paneth cell                                       Paneth cell\n## Ciliated epithelial cell             Ciliated epithelial cell\n##                                                   Description setSize\n## FGFR1HighNME5- epithelial cell FGFR1HighNME5- epithelial cell     131\n## FOXN4+ cell                                       FOXN4+ cell      63\n## Leydig precursor cell                   Leydig precursor cell     184\n## Neural progenitor cell                 Neural progenitor cell     149\n## Paneth cell                                       Paneth cell     261\n## Ciliated epithelial cell             Ciliated epithelial cell     217\n##                                enrichmentScore       NES       pvalue\n## FGFR1HighNME5- epithelial cell      -0.5739472 -2.249412 1.000000e-10\n## FOXN4+ cell                          0.7136090  2.703078 1.000000e-10\n## Leydig precursor cell               -0.5710583 -2.324742 1.000000e-10\n## Neural progenitor cell               0.7160571  3.127855 1.000000e-10\n## Paneth cell                          0.5381280  2.509634 1.000000e-10\n## Ciliated epithelial cell            -0.5012031 -2.084643 2.644335e-10\n##                                   p.adjust      qvalues rank\n## FGFR1HighNME5- epithelial cell 3.30000e-09 1.915789e-09 1404\n## FOXN4+ cell                    3.30000e-09 1.915789e-09 1419\n## Leydig precursor cell          3.30000e-09 1.915789e-09 2609\n## Neural progenitor cell         3.30000e-09 1.915789e-09  684\n## Paneth cell                    3.30000e-09 1.915789e-09 2187\n## Ciliated epithelial cell       7.27192e-09 4.221657e-09 1440\n##                                                  leading_edge\n## FGFR1HighNME5- epithelial cell tags=39%, list=11%, signal=35%\n## FOXN4+ cell                    tags=51%, list=11%, signal=45%\n## Leydig precursor cell          tags=45%, list=21%, signal=36%\n## Neural progenitor cell          tags=47%, list=5%, signal=45%\n## Paneth cell                    tags=45%, list=18%, signal=38%\n## Ciliated epithelial cell       tags=29%, list=12%, signal=27%\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         core_enrichment\n## FGFR1HighNME5- epithelial cell                                                                                                                                                                                                                                                                                                                                            3931/6586/23284/7106/5919/316/8829/4060/10559/8642/2846/58494/79987/8835/8076/64221/5118/83700/79776/50509/1513/7058/4313/55314/91851/10536/2674/3305/5159/443/3908/5101/2690/55733/2550/6857/10631/81035/4330/83468/576/2200/5157/7049/51380/1307/196740/2532/1308/8483/4239\n## FOXN4+ cell                                                                                                                                                                                                                                                                                                                                                                                                                                                                   79733/4751/79019/983/81620/4069/8836/3070/10733/81831/3932/10926/56938/7298/6491/262/1029/1719/8894/5902/10950/5496/2023/124222/10263/51142/11168/3638/51491/8751/6637/86\n## Leydig precursor cell                                                                                                                                                                                   7169/120/2949/22871/79822/7070/3624/10761/3671/80114/6326/25959/2013/9902/8654/4017/4811/26010/1291/92689/126393/7474/7168/27303/51454/1306/678/8425/7837/590/5919/23635/8829/1831/30008/1277/7078/4747/6591/56944/8406/1281/11167/1290/9037/2946/283298/1009/4313/6320/3075/6387/5159/1289/1292/116039/3908/5101/1909/83716/5376/633/6857/10631/54674/54587/30846/83468/3487/8404/2200/1634/1287/3479/5348/2006/7373/730/10234/4239/79901/4969\n## Neural progenitor cell                                                                                                                                                                                                                                            991/9493/9833/9133/10403/7153/259266/6241/9787/11065/55355/55872/51203/83461/22974/10460/79019/55839/890/983/4085/5080/332/3832/9212/51659/9055/891/4174/9232/4171/1033/1164/11004/51512/11130/79682/26227/57405/10615/3149/23594/56992/9768/11339/3070/4288/1163/4175/4173/2237/29028/3838/54478/3015/699/81611/1063/5111/26271/51053/10535/1719/8543/9289/4176/1841/7112/58516/3148\n## Paneth cell                    597/3627/8140/1844/4283/7850/2921/7941/4318/4069/3576/1075/10797/56833/713/1230/200315/712/51338/64581/57823/10437/8767/5341/91543/6351/3055/6614/10859/330/9332/313/51765/1051/22797/4067/80896/864/5226/9046/5336/8942/3162/4688/29887/5641/11314/79888/942/6916/1439/1116/10288/7127/4064/1794/483/963/3689/5788/3383/962/23250/3937/2207/3394/5552/54504/1514/79879/64092/409/7805/4360/3936/4689/5880/7128/10105/9308/51296/10148/10287/8477/6503/929/945/10261/4794/9775/8013/5912/7124/5329/10875/7097/7852/1378/5743/6398/7454/3119/951/6039/1240/5142/1536/3071/834/8676/7305/7133/3310/958/5724/728/11309/3059\n## Ciliated epithelial cell                                                                                                                                                                                                                                                          9666/1490/9284/7840/51281/126070/5021/55779/80823/79781/11001/81890/79645/79411/8777/4753/2701/2259/9854/8100/323/55152/51364/9940/23345/216/146542/22832/582/57728/4246/7220/55064/79819/54681/5002/79884/10610/26018/79659/6542/53832/7033/8938/23245/26960/55638/9576/114327/54585/1287/9358/55259/643314/64799/6038/80129/4857/80736/2066/79083/79846/11122/79838"},{"path":"universal-api.html","id":"msigdb-analysis","chapter":"12 Universal enrichment analysis","heading":"12.3 MSigDb analysis","text":"Molecular Signatures Database collection annotated gene sets. contains 8 major collections:H: hallmark gene setsC1: positional gene setsC2: curated gene setsC3: motif gene setsC4: computational gene setsC5: GO gene setsC6: oncogenic signaturesC7: immunologic signaturesUsers can download GMT files Broad Institute use read.gmt() function parse file used enricher() GSEA().R package, msigdbr, already packed MSigDB gene sets tidy data format can used directly clusterProfiler (Yu et al. 2012).supports several specices:can retrieve human gene sets:specific collection. use C6, oncogenic gene sets example:","code":"\nlibrary(msigdbr)\nmsigdbr_show_species()##  [1] \"Anolis carolinensis\"             \"Bos taurus\"                     \n##  [3] \"Caenorhabditis elegans\"          \"Canis lupus familiaris\"         \n##  [5] \"Danio rerio\"                     \"Drosophila melanogaster\"        \n##  [7] \"Equus caballus\"                  \"Felis catus\"                    \n##  [9] \"Gallus gallus\"                   \"Homo sapiens\"                   \n## [11] \"Macaca mulatta\"                  \"Monodelphis domestica\"          \n## [13] \"Mus musculus\"                    \"Ornithorhynchus anatinus\"       \n## [15] \"Pan troglodytes\"                 \"Rattus norvegicus\"              \n## [17] \"Saccharomyces cerevisiae\"        \"Schizosaccharomyces pombe 972h-\"\n## [19] \"Sus scrofa\"                      \"Xenopus tropicalis\"\nm_df <- msigdbr(species = \"Homo sapiens\")\nhead(m_df, 2) %>% as.data.frame##   gs_cat      gs_subcat        gs_name gene_symbol entrez_gene    ensembl_gene\n## 1     C3 MIR:MIR_Legacy AAACCAC_MIR140       ABCC4       10257 ENSG00000125257\n## 2     C3 MIR:MIR_Legacy AAACCAC_MIR140    ABRAXAS2       23172 ENSG00000165660\n##   human_gene_symbol human_entrez_gene human_ensembl_gene  gs_id gs_pmid\n## 1             ABCC4             10257    ENSG00000125257 M12609        \n## 2          ABRAXAS2             23172    ENSG00000165660 M12609        \n##   gs_geoid gs_exact_source gs_url\n## 1                                \n## 2                                \n##                                                                                                                                                                                           gs_description\n## 1 Genes having at least one occurence of the motif AAACCAC in their 3' untranslated region. The motif represents putative target (that is, seed match) of human mature miRNA hsa-miR-140 (v7.1 miRBase).\n## 2 Genes having at least one occurence of the motif AAACCAC in their 3' untranslated region. The motif represents putative target (that is, seed match) of human mature miRNA hsa-miR-140 (v7.1 miRBase).\nm_t2g <- msigdbr(species = \"Homo sapiens\", category = \"C6\") %>% \n  dplyr::select(gs_name, entrez_gene)\nhead(m_t2g)## # A tibble: 6 √ó 2\n##   gs_name              entrez_gene\n##   <chr>                      <int>\n## 1 AKT_UP_MTOR_DN.V1_DN       25864\n## 2 AKT_UP_MTOR_DN.V1_DN          95\n## 3 AKT_UP_MTOR_DN.V1_DN      137872\n## 4 AKT_UP_MTOR_DN.V1_DN         134\n## 5 AKT_UP_MTOR_DN.V1_DN       55326\n## 6 AKT_UP_MTOR_DN.V1_DN       55326"},{"path":"universal-api.html","id":"msigdb-ora","chapter":"12 Universal enrichment analysis","heading":"12.3.1 MSigDb over-presentaton analysis","text":"","code":"\nem <- enricher(gene, TERM2GENE=m_t2g)\nhead(em)##                                            ID            Description GeneRatio\n## RPS14_DN.V1_DN                 RPS14_DN.V1_DN         RPS14_DN.V1_DN    22/183\n## GCNP_SHH_UP_LATE.V1_UP GCNP_SHH_UP_LATE.V1_UP GCNP_SHH_UP_LATE.V1_UP    16/183\n## PRC2_EZH2_UP.V1_DN         PRC2_EZH2_UP.V1_DN     PRC2_EZH2_UP.V1_DN    15/183\n## VEGF_A_UP.V1_DN               VEGF_A_UP.V1_DN        VEGF_A_UP.V1_DN    15/183\n## RB_P107_DN.V1_UP             RB_P107_DN.V1_UP       RB_P107_DN.V1_UP    10/183\n## E2F1_UP.V1_UP                   E2F1_UP.V1_UP          E2F1_UP.V1_UP    12/183\n##                          BgRatio       pvalue     p.adjust       qvalue\n## RPS14_DN.V1_DN         186/10915 4.716365e-13 7.970657e-11 6.503619e-11\n## GCNP_SHH_UP_LATE.V1_UP 181/10915 5.815455e-08 4.914059e-06 4.009603e-06\n## PRC2_EZH2_UP.V1_DN     192/10915 7.635020e-07 3.446929e-05 2.812505e-05\n## VEGF_A_UP.V1_DN        193/10915 8.158412e-07 3.446929e-05 2.812505e-05\n## RB_P107_DN.V1_UP       130/10915 6.428560e-05 2.024672e-03 1.652021e-03\n## E2F1_UP.V1_UP          188/10915 7.522623e-05 2.024672e-03 1.652021e-03\n##                                                                                                                                        geneID\n## RPS14_DN.V1_DN         10874/55388/991/9493/1062/4605/9133/23397/79733/9787/55872/83461/54821/51659/9319/9055/10112/4174/5105/2532/7021/79901\n## GCNP_SHH_UP_LATE.V1_UP                                      55388/7153/79733/6241/9787/51203/983/9212/1111/9319/9055/3833/6790/4174/3169/1580\n## PRC2_EZH2_UP.V1_DN                                          8318/55388/4605/23397/9787/55355/10460/6362/81620/2146/7272/9212/11182/3887/24137\n## VEGF_A_UP.V1_DN                                                   8318/9493/1062/9133/10403/6241/9787/4085/332/3832/7272/891/23362/2167/10234\n## RB_P107_DN.V1_UP                                                                         8318/23397/79733/6241/4085/8208/9055/24137/4174/1307\n## E2F1_UP.V1_UP                                                                  55388/7153/23397/79733/9787/2146/2842/9212/8208/1111/9055/3833\n##                        Count\n## RPS14_DN.V1_DN            22\n## GCNP_SHH_UP_LATE.V1_UP    16\n## PRC2_EZH2_UP.V1_DN        15\n## VEGF_A_UP.V1_DN           15\n## RB_P107_DN.V1_UP          10\n## E2F1_UP.V1_UP             12"},{"path":"universal-api.html","id":"msigdb-gsea","chapter":"12 Universal enrichment analysis","heading":"12.3.2 MSigDb gene set enrichment analysis","text":"-presentaton analysis, use oncogenic gene sets (.e.¬†C6) test whether DE genes involved process leads cancer. example, use C3 category test whether genes /-regulated sharing specific motif using GSEA approach.","code":"\nC3_t2g <- msigdbr(species = \"Homo sapiens\", category = \"C3\") %>% \n  dplyr::select(gs_name, entrez_gene)\nhead(C3_t2g)## # A tibble: 6 √ó 2\n##   gs_name        entrez_gene\n##   <chr>                <int>\n## 1 AAACCAC_MIR140       10257\n## 2 AAACCAC_MIR140       23172\n## 3 AAACCAC_MIR140          81\n## 4 AAACCAC_MIR140          81\n## 5 AAACCAC_MIR140          90\n## 6 AAACCAC_MIR140        8754\nem2 <- GSEA(geneList, TERM2GENE = C3_t2g)\nhead(em2)##                                        ID          Description setSize\n## E2F1_Q3                           E2F1_Q3              E2F1_Q3     187\n## HSD17B8_TARGET_GENES HSD17B8_TARGET_GENES HSD17B8_TARGET_GENES     401\n## E2F1_Q6                           E2F1_Q6              E2F1_Q6     185\n## SGCGSSAAA_E2F1DP2_01 SGCGSSAAA_E2F1DP2_01 SGCGSSAAA_E2F1DP2_01     129\n## E2F_Q4                             E2F_Q4               E2F_Q4     193\n## E2F_Q6                             E2F_Q6               E2F_Q6     190\n##                      enrichmentScore      NES       pvalue     p.adjust\n## E2F1_Q3                    0.4983913 2.203638 1.000000e-10 1.655000e-07\n## HSD17B8_TARGET_GENES       0.6368099 3.075013 1.000000e-10 1.655000e-07\n## E2F1_Q6                    0.4906657 2.172309 1.585570e-10 1.749413e-07\n## SGCGSSAAA_E2F1DP2_01       0.5408182 2.285356 1.207636e-09 9.993184e-07\n## E2F_Q4                     0.4685394 2.087470 1.704036e-09 1.128072e-06\n## E2F_Q6                     0.4672345 2.077292 2.664743e-09 1.302665e-06\n##                           qvalues rank                   leading_edge\n## E2F1_Q3              1.312105e-07 2045 tags=36%, list=16%, signal=30%\n## HSD17B8_TARGET_GENES 1.312105e-07 1042  tags=36%, list=8%, signal=34%\n## E2F1_Q6              1.386957e-07 1819 tags=34%, list=15%, signal=30%\n## SGCGSSAAA_E2F1DP2_01 7.922725e-07 1797 tags=38%, list=14%, signal=33%\n## E2F_Q4               8.943498e-07 1663 tags=29%, list=13%, signal=26%\n## E2F_Q6               1.032770e-06 1663 tags=29%, list=13%, signal=25%\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             core_enrichment\n## E2F1_Q3                                                                                                                                                                                                                                                                                                                                                                                                                                                 79733/6241/983/5080/2146/8715/4171/993/990/56992/9768/4998/10733/7037/4175/54962/54954/29028/3015/2643/85236/5111/64785/26271/51053/1869/3925/114/5427/4176/7112/4436/1871/79915/9088/6632/284403/7290/2597/7398/4172/5424/124222/1633/10849/9824/4678/6646/29902/63967/56886/6059/23234/1786/204/51087/23636/2048/83463/10393/79173/688/3007/79677/9462/56946/9221\n## HSD17B8_TARGET_GENES 55143/55388/991/2305/9493/1062/4605/9833/9133/10403/7153/23397/79733/259266/6241/55165/9787/11065/55355/9582/220134/55872/83461/10460/4751/10635/55839/890/9415/983/54821/4085/9837/5080/332/7272/64151/2842/9212/51659/9319/9055/3833/146909/10112/51514/4174/9232/1033/9928/3161/11004/993/4603/79801/990/5347/55215/701/55723/51512/55635/9156/11130/10024/57405/10615/1894/2491/8438/9700/5888/7083/898/3149/56992/9768/4288/10733/1163/4175/5307/2237/29899/55010/59336/56942/5984/29028/3838/1058/54478/3015/699/6491/81611/1063/27346/64785/9401/26271/51026/641/1869/10535/1029/28998/1763/8970/54892/55159/864/93594/1789/4176/7111/3148/116832/9585/9735/55732/81624/23310/1871/1031/79915/995/10051/30012/1104/80178/78995/7468/284403/5230/8549/7884/5558/4172/5424/79866/3182/56902/83990\n## E2F1_Q6                                                                                                                                                                                                                                                                                                                                                                                                                                                                          79733/6241/983/5080/81620/2146/4171/993/990/3159/9768/4998/4175/4173/29028/3015/4609/85236/5111/64785/26271/51053/1869/3925/5427/4176/7112/5902/4436/1871/79915/9088/6632/284403/7290/2597/4172/5424/124222/1633/10849/7374/9824/2189/4678/2289/6646/29902/50/63967/56886/23234/6839/1786/204/51087/23636/11335/1174/83463/10492/79173/688\n## SGCGSSAAA_E2F1DP2_01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     79733/6241/4171/993/990/3159/9768/4175/4173/29028/3015/4609/85236/5111/64785/26271/51053/1869/5427/4176/5902/4436/1871/79915/9088/6632/284403/7290/4172/5424/124222/1633/7374/2189/4678/2289/50/63967/56886/23234/6839/1786/204/51087/23636/1174/83463/10492/79173\n## E2F_Q4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 8318/79733/6241/983/5080/81620/2146/4171/993/990/5888/9768/4175/4173/29028/3015/85236/5111/64785/26271/51053/1869/3925/5427/23649/4176/7112/5902/4436/1871/79915/9088/6632/284403/7290/2597/4172/5424/124222/1633/10849/7473/7374/9824/7353/4678/6646/50/63967/56886/23234/1786/204/6427/51087/23636\n## E2F_Q6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      8318/79733/6241/983/5080/81620/2146/4171/993/990/5888/9768/4175/4173/29028/3015/85236/5111/64785/26271/51053/1869/3925/5427/23649/4176/7112/5902/4436/1871/79915/9088/6632/284403/7290/2597/4172/5424/124222/1633/10849/7374/9824/7353/4678/6646/50/63967/56886/23234/1786/204/6427/51087/23636"},{"path":"chipseeker-enrichment.html","id":"chipseeker-enrichment","chapter":"13 Functional enrichment analysis of genomic coordinations","heading":"13 Functional enrichment analysis of genomic coordinations","text":"Functional analysis using NGS data (eg, RNA-Seq ChIP-Seq) can performed linking coding non-coding regions coding genes via ChIPseeker (Yu, Wang, 2015) package, can annotates genomic regions nearest genes, host genes, flanking genes respectivly. addtion, provides function, seq2gene, simultaneously considering host genes, promoter region flanking gene intergenic region may control via cis-regulation. function maps genomic regions genes many--many manner facilitate functional analysis. details, please refer ChIPseeker (Yu, Wang, 2015).","code":""},{"path":"clusterprofiler-comparecluster.html","id":"clusterprofiler-comparecluster","chapter":"14 Biological theme comparison","heading":"14 Biological theme comparison","text":"clusterProfiler package developed biological theme comparison (Yu et al. 2012; Wu et al. 2021), provides function, compareCluster, automatically calculate enriched functional profiles gene clusters aggregate results single object. Comparing functional profiles can reveal functional consensus differences among different experiments helps identifying differential functional modules omics datasets.","code":""},{"path":"clusterprofiler-comparecluster.html","id":"comparing-multiple-gene-lists","chapter":"14 Biological theme comparison","heading":"14.1 Comparing multiple gene lists","text":"compareCluster() function applies selected function (via fun parameter) perform enrichment analysis gene list.Users can use named list gene IDs input passed geneCluster parameter.","code":"\ndata(gcSample)\nstr(gcSample) ## List of 8\n##  $ X1: chr [1:216] \"4597\" \"7111\" \"5266\" \"2175\" ...\n##  $ X2: chr [1:805] \"23450\" \"5160\" \"7126\" \"26118\" ...\n##  $ X3: chr [1:392] \"894\" \"7057\" \"22906\" \"3339\" ...\n##  $ X4: chr [1:838] \"5573\" \"7453\" \"5245\" \"23450\" ...\n##  $ X5: chr [1:929] \"5982\" \"7318\" \"6352\" \"2101\" ...\n##  $ X6: chr [1:585] \"5337\" \"9295\" \"4035\" \"811\" ...\n##  $ X7: chr [1:582] \"2621\" \"2665\" \"5690\" \"3608\" ...\n##  $ X8: chr [1:237] \"2665\" \"4735\" \"1327\" \"3192\" ...\nck <- compareCluster(geneCluster = gcSample, fun = enrichKEGG)\nck <- setReadable(ck, OrgDb = org.Hs.eg.db, keyType=\"ENTREZID\")\nhead(ck) ##   Cluster       ID                            Description GeneRatio  BgRatio\n## 1      X2 hsa04110                             Cell cycle    18/384 124/8091\n## 2      X2 hsa05169           Epstein-Barr virus infection    23/384 202/8091\n## 3      X2 hsa05340               Primary immunodeficiency     8/384  38/8091\n## 4      X3 hsa04512               ECM-receptor interaction     9/187  88/8091\n## 5      X3 hsa04060 Cytokine-cytokine receptor interaction    17/187 295/8091\n## 6      X3 hsa04151             PI3K-Akt signaling pathway    19/187 354/8091\n##         pvalue    p.adjust      qvalue\n## 1 1.999785e-05 0.006099344 0.005704649\n## 2 8.119542e-05 0.012382301 0.011581030\n## 3 3.336022e-04 0.033916228 0.031721476\n## 4 1.839116e-04 0.045884681 0.042872735\n## 5 4.579455e-04 0.045884681 0.042872735\n## 6 5.155582e-04 0.045884681 0.042872735\n##                                                                                                                          geneID\n## 1                          CDC20/E2F1/CCNA2/E2F3/BUB1B/CDC6/DBF4/PKMYT1/CDC7/ESPL1/CCNE2/CDKN2A/SFN/BUB1/CHEK2/ORC6/CDC14B/MCM4\n## 2 LYN/ICAM1/TNFAIP3/E2F1/CCNA2/E2F3/BAK1/RUNX3/BID/IKBKE/TAP2/FAS/CCNE2/RELB/CD3E/ENTPD3/SYK/TRAF3/IKBKB/CD247/NEDD4/CD40/STAT1\n## 3                                                                                     ADA/TAP2/LCK/CD79A/CD3E/CD8A/CD40/DCLRE1C\n## 4                                                                         THBS1/HSPG2/COL9A3/ITGB7/CHAD/ITGA7/LAMA4/ITGB8/ITGB5\n## 5                CXCL1/TNFRSF11B/LIFR/XCL1/GDF5/TNFRSF17/TNFRSF11A/IL5RA/EPOR/CSF2RA/TNFRSF25/BMP7/BMP4/GDF11/IL21R/IL23A/TGFB2\n## 6                    CCND2/THBS1/STK11/FGF2/COL9A3/ITGB7/FGF7/ERBB4/CHAD/FGF18/CDK6/PCK1/ITGA7/HGF/EPOR/LAMA4/IKBKB/ITGB8/ITGB5\n##   Count\n## 1    18\n## 2    23\n## 3     8\n## 4     9\n## 5    17\n## 6    19"},{"path":"clusterprofiler-comparecluster.html","id":"formula-interface-of-comparecluster","chapter":"14 Biological theme comparison","heading":"14.2 Formula interface of compareCluster","text":"alternaitve using named list, compareCluster() function also supports passing formula describe complicated experimental designs (e.g., \\(Gene \\sim time + treatment\\)).","code":"\nmydf <- data.frame(Entrez=names(geneList), FC=geneList)\nmydf <- mydf[abs(mydf$FC) > 1,]\nmydf$group <- \"upregulated\"\nmydf$group[mydf$FC < 0] <- \"downregulated\"\nmydf$othergroup <- \"A\"\nmydf$othergroup[abs(mydf$FC) > 2] <- \"B\"\n\nformula_res <- compareCluster(Entrez~group+othergroup, data=mydf, fun=\"enrichKEGG\")\n  \nhead(formula_res)##           Cluster         group othergroup       ID\n## 1 downregulated.A downregulated          A hsa04974\n## 2 downregulated.A downregulated          A hsa04510\n## 3 downregulated.A downregulated          A hsa04151\n## 4 downregulated.A downregulated          A hsa04512\n## 5 downregulated.B downregulated          B hsa03320\n## 6   upregulated.A   upregulated          A hsa04110\n##                        Description GeneRatio  BgRatio       pvalue     p.adjust\n## 1 Protein digestion and absorption    16/319 103/8091 2.330255e-06 6.501412e-04\n## 2                   Focal adhesion    20/319 201/8091 1.224881e-04 1.708709e-02\n## 3       PI3K-Akt signaling pathway    28/319 354/8091 3.251014e-04 3.023443e-02\n## 4         ECM-receptor interaction    11/319  88/8091 6.380818e-04 4.450620e-02\n## 5           PPAR signaling pathway      5/43  76/8091 4.664219e-05 7.276181e-03\n## 6                       Cell cycle    20/220 124/8091 1.020639e-10 2.551598e-08\n##         qvalue\n## 1 6.181308e-04\n## 2 1.624579e-02\n## 3 2.874581e-02\n## 4 4.231490e-02\n## 5 6.824488e-03\n## 6 2.288380e-08\n##                                                                                                                                             geneID\n## 1                                                                 1281/50509/1290/477/1294/1360/1289/1292/1296/23428/1359/1300/1287/6505/2006/7373\n## 2                                         55742/2317/7058/25759/56034/3693/3480/5159/857/1292/3908/3909/63923/3913/1287/3679/7060/3479/10451/80310\n## 3 55970/5618/7058/10161/56034/3693/4254/3480/4908/5159/1292/3908/2690/3909/8817/9223/4915/3551/2791/63923/3913/9863/3667/1287/3679/7060/3479/80310\n## 4                                                                                          7058/3693/3339/1292/3908/3909/63923/3913/1287/3679/7060\n## 5                                                                                                                         9370/5105/2167/3158/5346\n## 6                                                  4171/993/990/5347/701/9700/898/23594/4998/9134/4175/4173/10926/6502/994/699/4609/5111/1869/1029\n##   Count\n## 1    16\n## 2    20\n## 3    28\n## 4    11\n## 5     5\n## 6    20"},{"path":"clusterprofiler-comparecluster.html","id":"visualization-of-profile-comparison","chapter":"14 Biological theme comparison","heading":"14.3 Visualization of profile comparison","text":"can visualize result using dotplot() method.\nFigure 14.1: Comparing enrichment results multiple gene lists. () Using named list gene clusters, results displayed multiple columns one represents enrichment result gene cluster. (B) Using formula interface, columns represent gene clusters defined formula.\nfomula interface allows complicated gene cluster definition. Figure 14.1B, gene clusters defined two variables (.e.¬†group divides genes upregulated downregulated othergroup divides genes two categories B.). dotplot() function allows us use one variable divide result different facet plot result variables facet panel (Figure 14.2).\nFigure 14.2: Comparing enrichment results multiple gene lists defined multiple variable. results visualized dot plot x-axis representing one level conditions (group variable) facet panel indicating another level conditions (othergroup variable).\ndefault, top 5 (significant) categories cluster\nplotted. User can changes parameter showCategory \nspecify many categories cluster plotted, \nshowCategory set NULL, whole result \nplotted.dotplot() function tries make comparison among different clusters informative reasonable. extracting e.g. 10 categories clusters, clusterProfiler tries collect overlap categories among clusters. example, term enriched gene clusters (e.g., g1 g2) 10 significant categories g1 g2. clusterProfiler capture information include term g2 cluster make comparison dotplot reasonable. users want ignore information, can set includeAll = FALSE dotplot(), recommended.dotplot() function accepts parameter setting scale dot sizes. default parameter setting geneRatio, corresponding GeneRatio column output. setting count, comparison based gene counts, setting rowPercentage, dot sizes normalized count/(sum row). Users can also map dot size derived variable (see Chapter 16).provide full information, also provide number identified genes category (numbers parentheses) setting rowPercentage number gene clusters cluster label (numbers parentheses) setting geneRatio, shown Figure 14.1.p-values indicate categories likely biological meanings. dots plot color-coded based corresponding adjusted p-values. Color gradient ranging red blue correspond order increasing adjusted p-values. , red indicate low p-values (high enrichment), blue indicate high p-values (low enrichment). Adjusted p-values filtered threshold giving parameter pvalueCutoff, FDR can estimated qvalue.","code":"\ndotplot(ck)\ndotplot(formula_res)\ndotplot(formula_res, x=\"group\") + facet_grid(~othergroup)"},{"path":"clusterprofiler-comparecluster.html","id":"summary-1","chapter":"14 Biological theme comparison","heading":"14.4 Summary","text":"comparison function designed framework comparing gene clusters kind ontology associations, groupGO, enrichGO, enrichKEGG, enrichMKEGG, enrichWP enricher provided package, also biological biomedical ontologies, including limited enrichPathway, enrichDO, enrichNCG, enrichDGN enrichMeSH.(Yu et al. 2012), analyzed publicly available expression dataset breast tumour tissues 200 patients (GSE11121, Gene Expression Omnibus) (Schmidt et al. 2008). identified 8 gene clusters differentially expressed genes, using compareCluster() function compare gene clusters enriched biological process. (Wu et al. 2021), analyzed GSE8057 dataset contains expression data ovarian cancer cells multiple time points two treatment conditions. Eight groups DEG lists analyzed simultaneously using compareCluster() WikiPathways. result indicates two drgus distinct effects begining consistent effects later stages (Fig. 4 (Wu et al. 2021)).","code":""},{"path":"enrichplot.html","id":"enrichplot","chapter":"15 Visualization of functional enrichment result","heading":"15 Visualization of functional enrichment result","text":"enrichplot package implements several visualization methods help interpreting enrichment results. supports visualizing enrichment results obtained DOSE (Yu et al. 2015), clusterProfiler (Yu et al. 2012),\nReactomePA (Yu 2016) meshes (Yu 2018). representation analysis (ORA) gene set enrichment analysis (GSEA) supported.Several visualization methods first implemented DOSE rewrote scratch using ggplot2. want use old methods, can use doseplot package.","code":""},{"path":"enrichplot.html","id":"bar-plot","chapter":"15 Visualization of functional enrichment result","heading":"15.1 Bar Plot","text":"Bar plot widely used method visualize enriched terms. depicts enrichment scores (e.g. p values) gene count ratio bar height\ncolor.\nFigure 15.1: Bar plot enriched terms.\n","code":"\nlibrary(DOSE)\ndata(geneList)\nde <- names(geneList)[abs(geneList) > 2]\n\nedo <- enrichDGN(de)\nlibrary(enrichplot)\nbarplot(edo, showCategory=20) "},{"path":"enrichplot.html","id":"dot-plot","chapter":"15 Visualization of functional enrichment result","heading":"15.2 Dot plot","text":"Dot plot similar bar plot capability encode another score dot size.\nFigure 15.2: Dot plot enriched terms.\n","code":"\nedo2 <- gseDO(geneList)\ndotplot(edo, showCategory=30) + ggtitle(\"dotplot for ORA\")\ndotplot(edo2, showCategory=30) + ggtitle(\"dotplot for GSEA\")"},{"path":"enrichplot.html","id":"gene-concept-network","chapter":"15 Visualization of functional enrichment result","heading":"15.3 Gene-Concept Network","text":"barplot() dotplot() displayed significant enriched terms,\nusers may want know genes involved significant\nterms.\norder consider potentially biological complexities gene may belong multiple annotation categories provide information numeric changes available, developed cnetplot() function extract complex association.\ncnetplot() depicts linkages genes biological concepts (e.g. GO terms KEGG pathways) network. GSEA result also supported\ncore enriched genes displayed.\nFigure 15.3: Network plot enriched terms.\nlike label subset nodes, can use node_label parameter, supports 4 possible selections (.e.¬†‚Äúcategory,‚Äù ‚Äúgene,‚Äù ‚Äú‚Äù ‚Äúnone‚Äù), demonstrated Figure 15.4.\nFigure 15.4: Labelling nodes selected subset. gene category (), gene name (B), gene category gene name (C, default) label (D).\ncnetplot function can used general method visualize data relationships network diagram. Users can use named list input demonstrated Figure 15.5.\nFigure 15.5: Using cnetplot visualize data relationships. relationships network diagram () associated data color nodes (B).\n","code":"\n## convert gene ID to Symbol\nedox <- setReadable(edo, 'org.Hs.eg.db', 'ENTREZID')\np1 <- cnetplot(edox, foldChange=geneList)\n## categorySize can be scaled by 'pvalue' or 'geneNum'\np2 <- cnetplot(edox, categorySize=\"pvalue\", foldChange=geneList)\np3 <- cnetplot(edox, foldChange=geneList, circular = TRUE, colorEdge = TRUE)\ncowplot::plot_grid(p1, p2, p3, ncol=3, labels=LETTERS[1:3], rel_widths=c(.8, .8, 1.2))\np1 <- cnetplot(edox, node_label=\"category\") \np2 <- cnetplot(edox, node_label=\"gene\") \np3 <- cnetplot(edox, node_label=\"all\") \np4 <- cnetplot(edox, node_label=\"none\") \ncowplot::plot_grid(p1, p2, p3, p4, ncol=2, labels=LETTERS[1:4])\nset.seed(123)\nx <- list(A = letters[1:10], B=letters[5:12], C=letters[sample(1:26, 15)])\np1 <- cnetplot(x)\n\nset.seed(123)\nd <- setNames(rnorm(26), letters)\np2 <- cnetplot(x, foldChange=d) + \n    scale_color_gradient2(name='associated data', low='darkgreen', high='firebrick')\n\ncowplot::plot_grid(p1, p2, ncol=2, labels=LETTERS[1:2], label_size=20)    "},{"path":"enrichplot.html","id":"heatmap-like-functional-classification","chapter":"15 Visualization of functional enrichment result","heading":"15.4 Heatmap-like functional classification","text":"heatplot similar cnetplot, displaying relationships \nheatmap. gene-concept network may become complicated user want \nshow large number significant terms. heatplot can simplify result\neasy identify expression patterns.\nFigure 15.6: Heatmap plot enriched terms. default (), foldChange=geneList (B)\n","code":"\np1 <- heatplot(edox)\np2 <- heatplot(edox, foldChange=geneList)\ncowplot::plot_grid(p1, p2, ncol=1, labels=LETTERS[1:2])"},{"path":"enrichplot.html","id":"enrichment-map","chapter":"15 Visualization of functional enrichment result","heading":"15.5 Enrichment Map","text":"Enrichment map organizes enriched terms network edges connecting\noverlapping gene sets. way, mutually overlapping gene sets tend \ncluster together, making easy identify functional module.emapplot function supports results obtained hypergeometric test gene set enrichment analysis. cex_category parameter can used resize nodes, demonstrated Figure 15.7 B, layout parameter can adjust layout, demonstrated Figure 15.7 C D.\nFigure 15.7: Plot results obtained hypergeometric test gene set enrichment analysis. default (), cex_category=1.5 (B), layout=\"kk\" (C) cex_category=1.5,layout=\"kk\" (D).\n","code":"\nedo <- pairwise_termsim(edo)\np1 <- emapplot(edo)\np2 <- emapplot(edo, cex_category=1.5)\np3 <- emapplot(edo, layout=\"kk\")\np4 <- emapplot(edo, cex_category=1.5,layout=\"kk\") \ncowplot::plot_grid(p1, p2, p3, p4, ncol=2, labels=LETTERS[1:4])"},{"path":"enrichplot.html","id":"biological-theme-comparison","chapter":"15 Visualization of functional enrichment result","heading":"15.6 Biological theme comparison","text":"emapplot function also supports results obtained compareCluster function clusterProfiler package. addition cex_category layout parameters, number circles bottom left corner can adjusted using legend_n parameteras, demonstrated Figure 15.8 B. proportion clusters pie chart can adjusted using pie parameter, pie=\"count\", proportion clusters pie chart determined number genes, demonstrated Figure 15.8 C D.\nFigure 15.8: Plot results obtained compareCluster function clusterProfiler package. default (), legend_n=2 (B), pie=\"count\" (C) pie=\"count\", cex_category=1.5, layout=\"kk\" (D).\n","code":"\nlibrary(clusterProfiler)\ndata(gcSample)\nxx <- compareCluster(gcSample, fun=\"enrichKEGG\",\n                     organism=\"hsa\", pvalueCutoff=0.05)\nxx <- pairwise_termsim(xx)                     \np1 <- emapplot(xx)\np2 <- emapplot(xx, legend_n=2) \np3 <- emapplot(xx, pie=\"count\")\np4 <- emapplot(xx, pie=\"count\", cex_category=1.5, layout=\"kk\")\ncowplot::plot_grid(p1, p2, p3, p4, ncol=2, labels=LETTERS[1:4])"},{"path":"enrichplot.html","id":"upset-plot","chapter":"15 Visualization of functional enrichment result","heading":"15.7 UpSet Plot","text":"upsetplot alternative cnetplot visualizing complex\nassociation genes gene sets. emphasizes gene overlapping\namong different gene sets.\nFigure 15.9: Upsetplot -representation analysis.\n-representation analysis, upsetplot calculate overlaps among different gene sets demonstrated Figure 15.9. GSEA result, plot fold change distributions different categories (e.g.¬†unique pathway, overlaps among different pathways).\nFigure 15.10: Upsetplot gene set enrichment analysis.\n","code":"\nupsetplot(edo)\nupsetplot(kk2) "},{"path":"enrichplot.html","id":"ridgeline-plot-for-expression-distribution-of-gsea-result","chapter":"15 Visualization of functional enrichment result","heading":"15.8 ridgeline plot for expression distribution of GSEA result","text":"ridgeplot visualize expression distributions core enriched genes\nGSEA enriched categories. helps users interpret /-regulated pathways.\nFigure 15.11: Ridgeplot gene set enrichment analysis.\n","code":"\nridgeplot(edo2)"},{"path":"enrichplot.html","id":"running-score-and-preranked-list-of-gsea-result","chapter":"15 Visualization of functional enrichment result","heading":"15.9 running score and preranked list of GSEA result","text":"Running score preranked list traditional methods visualizing GSEA\nresult. enrichplot package supports visualize\ndistribution gene set enrichment score.\nFigure 15.12: gseaplot GSEA result(= \"runningScore\"). = \"runningScore\" (), = \"preranked\" (B), default (C)\nAnother method plot GSEA result gseaplot2 function:\nFigure 15.13: Gseaplot2 GSEA result.\ngseaplot2 also supports multile gene sets displayed figure:\nFigure 15.14: Gseaplot2 GSEA result multile gene sets.\nUser can also displaying pvalue table plot via pvalue_table\nparameter:\nFigure 15.15: Gseaplot2 GSEA result multile gene sets(add pvalue_table).\nUser can specify subplots display subset plots:\nFigure 15.16: Gseaplot2 GSEA result multile gene sets(add subplots). subplots = 1 (),subplots = 1:2 (B)\ngsearank function plot ranked list genes belong specific\ngene set.\nFigure 15.17: Ranked list genes belong specific gene set.\nMultiple gene sets can aligned using cowplot:\nFigure 15.18: Gsearank multiple gene sets.\n","code":"\np1 <- gseaplot(edo2, geneSetID = 1, by = \"runningScore\", title = edo2$Description[1])\np2 <- gseaplot(edo2, geneSetID = 1, by = \"preranked\", title = edo2$Description[1])\np3 <- gseaplot(edo2, geneSetID = 1, title = edo2$Description[1])\ncowplot::plot_grid(p1, p2, p3, ncol=1, labels=LETTERS[1:3])\ngseaplot2(edo2, geneSetID = 1, title = edo2$Description[1])\ngseaplot2(edo2, geneSetID = 1:3)\ngseaplot2(edo2, geneSetID = 1:3, pvalue_table = TRUE,\n          color = c(\"#E495A5\", \"#86B875\", \"#7DB0DD\"), ES_geom = \"dot\")\np1 <- gseaplot2(edo2, geneSetID = 1:3, subplots = 1)\np2 <- gseaplot2(edo2, geneSetID = 1:3, subplots = 1:2)\ncowplot::plot_grid(p1, p2, ncol=1, labels=LETTERS[1:2])\ngsearank(edo2, 1, title = edo2[1, \"Description\"])\nlibrary(ggplot2)\nlibrary(cowplot)\n\npp <- lapply(1:3, function(i) {\n    anno <- edo2[i, c(\"NES\", \"pvalue\", \"p.adjust\")]\n    lab <- paste0(names(anno), \"=\",  round(anno, 3), collapse=\"\\n\")\n\n    gsearank(edo2, i, edo2[i, 2]) + xlab(NULL) +ylab(NULL) +\n        annotate(\"text\", 10000, edo2[i, \"enrichmentScore\"] * .75, label = lab, hjust=0, vjust=0)\n})\nplot_grid(plotlist=pp, ncol=1)"},{"path":"enrichplot.html","id":"pubmed-trend-of-enriched-terms","chapter":"15 Visualization of functional enrichment result","heading":"15.10 pubmed trend of enriched terms","text":"One problem enrichment analysis find pathways \ninvestigation. , provide pmcplot function plot number/proportion\npublications trend based query result PubMed Central. course,\nusers can use pmcplot scenarios. text can queried PMC\nvalid input pmcplot.\nFigure 15.19: Pmcplot enrichment analysis.\n","code":"\nterms <- edo$Description[1:5]\np <- pmcplot(terms, 2010:2020)\np2 <- pmcplot(terms, 2010:2020, proportion=FALSE)\nplot_grid(p, p2, ncol=2)"},{"path":"clusterProfiler-dplyr.html","id":"clusterProfiler-dplyr","chapter":"16 dplyr verbs for manipulating enrichment result","heading":"16 dplyr verbs for manipulating enrichment result","text":"","code":"\nlibrary(DOSE)\ndata(geneList)\nde = names(geneList)[1:100]\nx = enrichDO(de)"},{"path":"clusterProfiler-dplyr.html","id":"filter","chapter":"16 dplyr verbs for manipulating enrichment result","heading":"16.1 filter","text":"","code":"\nfilter(x, p.adjust < .05, qvalue < 0.2)## #\n## # over-representation test\n## #\n## #...@organism     Homo sapiens \n## #...@ontology     DO \n## #...@keytype      ENTREZID \n## #...@gene     chr [1:100] \"4312\" \"8318\" \"10874\" \"55143\" \"55388\" \"991\" \"6280\" \"2305\" ...\n## #...pvalues adjusted by 'BH' with cutoff <0.05 \n## #...28 enriched terms found\n## 'data.frame':    28 obs. of  9 variables:\n##  $ ID         : chr  \"DOID:0060071\" \"DOID:5295\" \"DOID:8719\" \"DOID:3007\" ...\n##  $ Description: chr  \"pre-malignant neoplasm\" \"intestinal disease\" \"in situ carcinoma\" \"breast ductal carcinoma\" ...\n##  $ GeneRatio  : chr  \"5/77\" \"9/77\" \"4/77\" \"4/77\" ...\n##  $ BgRatio    : chr  \"22/8007\" \"157/8007\" \"18/8007\" \"29/8007\" ...\n##  $ pvalue     : num  1.67e-06 1.76e-05 2.18e-05 1.56e-04 2.08e-04 ...\n##  $ p.adjust   : num  0.00064 0.00279 0.00279 0.0136 0.0136 ...\n##  $ qvalue     : num  0.000461 0.002008 0.002008 0.009796 0.009796 ...\n##  $ geneID     : chr  \"6280/6278/10232/332/4321\" \"4312/6279/3627/10563/4283/890/366/4902/3620\" \"6280/6278/10232/332\" \"6280/6279/4751/6286\" ...\n##  $ Count      : int  5 9 4 4 13 6 13 5 5 6 ...\n## #...Citation\n##   Guangchuang Yu, Li-Gen Wang, Guang-Rong Yan, Qing-Yu He. DOSE: an\n##   R/Bioconductor package for Disease Ontology Semantic and Enrichment\n##   analysis. Bioinformatics 2015, 31(4):608-609"},{"path":"clusterProfiler-dplyr.html","id":"arrange","chapter":"16 dplyr verbs for manipulating enrichment result","heading":"16.2 arrange","text":"","code":"\nmutate(x, geneRatio = parse_ratio(GeneRatio)) %>%\n  arrange(desc(geneRatio))## #\n## # over-representation test\n## #\n## #...@organism     Homo sapiens \n## #...@ontology     DO \n## #...@keytype      ENTREZID \n## #...@gene     chr [1:100] \"4312\" \"8318\" \"10874\" \"55143\" \"55388\" \"991\" \"6280\" \"2305\" ...\n## #...pvalues adjusted by 'BH' with cutoff <0.05 \n## #...28 enriched terms found\n## 'data.frame':    28 obs. of  10 variables:\n##  $ ID         : chr  \"DOID:3908\" \"DOID:120\" \"DOID:2394\" \"DOID:3459\" ...\n##  $ Description: chr  \"non-small cell lung carcinoma\" \"female reproductive organ cancer\" \"ovarian cancer\" \"breast carcinoma\" ...\n##  $ GeneRatio  : chr  \"13/77\" \"13/77\" \"10/77\" \"10/77\" ...\n##  $ BgRatio    : chr  \"431/8007\" \"455/8007\" \"312/8007\" \"383/8007\" ...\n##  $ pvalue     : num  2.08e-04 3.52e-04 7.54e-04 3.48e-03 1.76e-05 ...\n##  $ p.adjust   : num  0.0136 0.01928 0.02625 0.04756 0.00279 ...\n##  $ qvalue     : num  0.0098 0.01389 0.0189 0.03424 0.00201 ...\n##  $ geneID     : chr  \"6280/2305/9133/6279/7153/6278/6241/11065/10232/332/6286/3002/9212\" \"4312/6279/7153/3627/820/983/10232/6362/332/6286/9212/4321/6790\" \"4312/820/983/10232/6362/332/6286/9212/4321/6790\" \"4312/6280/6279/7153/4751/890/4085/332/6286/6790\" ...\n##  $ Count      : int  13 13 10 10 9 7 7 6 6 6 ...\n##  $ geneRatio  : num  0.169 0.169 0.13 0.13 0.117 ...\n## #...Citation\n##   Guangchuang Yu, Li-Gen Wang, Guang-Rong Yan, Qing-Yu He. DOSE: an\n##   R/Bioconductor package for Disease Ontology Semantic and Enrichment\n##   analysis. Bioinformatics 2015, 31(4):608-609"},{"path":"clusterProfiler-dplyr.html","id":"select","chapter":"16 dplyr verbs for manipulating enrichment result","heading":"16.3 select","text":"","code":"\nselect(x, -geneID) %>% head##                        ID                   Description GeneRatio  BgRatio\n## DOID:0060071 DOID:0060071        pre-malignant neoplasm      5/77  22/8007\n## DOID:5295       DOID:5295            intestinal disease      9/77 157/8007\n## DOID:8719       DOID:8719             in situ carcinoma      4/77  18/8007\n## DOID:3007       DOID:3007       breast ductal carcinoma      4/77  29/8007\n## DOID:3908       DOID:3908 non-small cell lung carcinoma     13/77 431/8007\n## DOID:0050589 DOID:0050589    inflammatory bowel disease      6/77  90/8007\n##                    pvalue     p.adjust       qvalue Count\n## DOID:0060071 1.671524e-06 0.0006401937 0.0004609887     5\n## DOID:5295    1.759049e-05 0.0027885022 0.0020079362     9\n## DOID:8719    2.184205e-05 0.0027885022 0.0020079362     4\n## DOID:3007    1.564603e-04 0.0136037018 0.0097957122     4\n## DOID:3908    2.075001e-04 0.0136037018 0.0097957122    13\n## DOID:0050589 2.131128e-04 0.0136037018 0.0097957122     6"},{"path":"clusterProfiler-dplyr.html","id":"mutate","chapter":"16 dplyr verbs for manipulating enrichment result","heading":"16.4 mutate","text":"\nFigure 16.1: Visualizing rich factor enriched terms using lolliplot.\nsimilar concept Fold Enrichment, defined ratio two proportions, (k/n) / (M/N). Using mutate add fold enrichment variable also easy:","code":"\n# k/M\ny <- mutate(x, richFactor = Count / as.numeric(sub(\"/\\\\d+\", \"\", BgRatio)))\ny## #\n## # over-representation test\n## #\n## #...@organism     Homo sapiens \n## #...@ontology     DO \n## #...@keytype      ENTREZID \n## #...@gene     chr [1:100] \"4312\" \"8318\" \"10874\" \"55143\" \"55388\" \"991\" \"6280\" \"2305\" ...\n## #...pvalues adjusted by 'BH' with cutoff <0.05 \n## #...28 enriched terms found\n## 'data.frame':    28 obs. of  10 variables:\n##  $ ID         : chr  \"DOID:0060071\" \"DOID:5295\" \"DOID:8719\" \"DOID:3007\" ...\n##  $ Description: chr  \"pre-malignant neoplasm\" \"intestinal disease\" \"in situ carcinoma\" \"breast ductal carcinoma\" ...\n##  $ GeneRatio  : chr  \"5/77\" \"9/77\" \"4/77\" \"4/77\" ...\n##  $ BgRatio    : chr  \"22/8007\" \"157/8007\" \"18/8007\" \"29/8007\" ...\n##  $ pvalue     : num  1.67e-06 1.76e-05 2.18e-05 1.56e-04 2.08e-04 ...\n##  $ p.adjust   : num  0.00064 0.00279 0.00279 0.0136 0.0136 ...\n##  $ qvalue     : num  0.000461 0.002008 0.002008 0.009796 0.009796 ...\n##  $ geneID     : chr  \"6280/6278/10232/332/4321\" \"4312/6279/3627/10563/4283/890/366/4902/3620\" \"6280/6278/10232/332\" \"6280/6279/4751/6286\" ...\n##  $ Count      : int  5 9 4 4 13 6 13 5 5 6 ...\n##  $ richFactor : num  0.2273 0.0573 0.2222 0.1379 0.0302 ...\n## #...Citation\n##   Guangchuang Yu, Li-Gen Wang, Guang-Rong Yan, Qing-Yu He. DOSE: an\n##   R/Bioconductor package for Disease Ontology Semantic and Enrichment\n##   analysis. Bioinformatics 2015, 31(4):608-609\nlibrary(ggplot2)\nlibrary(forcats)\nlibrary(enrichplot)\n\nggplot(y, showCategory = 20, \n  aes(richFactor, fct_reorder(Description, richFactor))) + \n  geom_segment(aes(xend=0, yend = Description)) +\n  geom_point(aes(color=p.adjust, size = Count)) +\n  scale_color_viridis_c(guide=guide_colorbar(reverse=TRUE)) +\n  scale_size_continuous(range=c(2, 10)) +\n  theme_minimal() + \n  xlab(\"rich factor\") +\n  ylab(NULL) + \n  ggtitle(\"Enriched Disease Ontology\")\nmutate(x, FoldEnrichment = parse_ratio(GeneRatio) / parse_ratio(BgRatio))"},{"path":"clusterProfiler-dplyr.html","id":"slice","chapter":"16 dplyr verbs for manipulating enrichment result","heading":"16.5 slice","text":"can use slice choose rows ordinal position enrichment result. Grouped result use ordinal position group.following example, GSEA result Reactome pathway sorted absolute values NES result grouped sign NES. extracted first 5 rows groups. result displayed Figure 16.2.\nFigure 16.2: Choose pathways ordinal positions.\n","code":"\nlibrary(ReactomePA)\ndata(geneList)\nx <- gsePathway(geneList)\n\n\ny <- arrange(x, abs(NES)) %>% \n        group_by(sign(NES)) %>% \n        slice(1:5)\n\nlibrary(forcats)\nlibrary(ggplot2)\nlibrary(ggstance)\nlibrary(enrichplot)\n\nggplot(y, aes(NES, fct_reorder(Description, NES), fill=qvalues), showCategory=10) + \n    geom_barh(stat='identity') + \n    scale_fill_continuous(low='red', high='blue', guide=guide_colorbar(reverse=TRUE)) + \n    theme_minimal() + ylab(NULL)"},{"path":"clusterProfiler-dplyr.html","id":"summarise","chapter":"16 dplyr verbs for manipulating enrichment result","heading":"16.6 summarise","text":"\nFigure 16.3: Distribution adjusted p-values.\n","code":"\npbar <- function(x) {\n  pi=seq(0, 1, length.out=11)\n\n  mutate(x, pp = cut(p.adjust, pi)) %>%\n    group_by(pp) %>% \n    summarise(cnt = n()) %>% \n    ggplot(aes(pp, cnt)) + geom_col() + \n    theme_minimal() +\n    xlab(\"p value intervals\") +\n    ylab(\"Frequency\") + \n    ggtitle(\"p value distribution\")\n}    \n\nx <- enrichDO(de, pvalueCutoff=1, qvalueCutoff=1)\nset.seed(2020-09-10)\nrandom_genes <- sample(names(geneList), 100)\ny <- enrichDO(random_genes, pvalueCutoff=1, qvalueCutoff=1)\np1 <- pbar(x)\np2 <- pbar(y)\ncowplot::plot_grid(p1, p2, ncol=1, labels = LETTERS[1:2])"},{"path":"useful-utilities.html","id":"useful-utilities","chapter":"17 Useful utilities","heading":"17 Useful utilities","text":"","code":""},{"path":"useful-utilities.html","id":"id-convert","chapter":"17 Useful utilities","heading":"17.1 Translating Biological ID","text":"","code":""},{"path":"useful-utilities.html","id":"bitr","chapter":"17 Useful utilities","heading":"17.1.1 bitr: Biological Id TranslatoR","text":"clusterProfiler package provides bitr() bitr_kegg() functions converting ID types. bitr() bitr_kegg() support many species including model many non-model organisms.User provides annotation package, fromType toType can accept types supported.User can use keytypes list supporting types.can translate one type types.GO analysis, user don‚Äôt need convert ID, ID type provided OrgDb can used groupGO, enrichGO gseGO specifying keyType parameter.Users can use bitr function convert IDs using ID types available OrbDb object. example, users may want know genes background belong specific GO term. information can easily accessed using bitr.Note: want extract genes input gene list belong specific term/pathway, can use geneInCategory function.","code":"\nx <- c(\"GPX3\",  \"GLRX\",   \"LBP\",   \"CRYAB\", \"DEFB1\", \"HCLS1\",   \"SOD2\",   \"HSPA2\",\n       \"ORM1\",  \"IGFBP1\", \"PTHLH\", \"GPC3\",  \"IGFBP3\",\"TOB1\",    \"MITF\",   \"NDRG1\",\n       \"NR1H4\", \"FGFR3\",  \"PVR\",   \"IL6\",   \"PTPRM\", \"ERBB2\",   \"NID2\",   \"LAMB1\",\n       \"COMP\",  \"PLS3\",   \"MCAM\",  \"SPP1\",  \"LAMC1\", \"COL4A2\",  \"COL4A1\", \"MYOC\",\n       \"ANXA4\", \"TFPI2\",  \"CST6\",  \"SLPI\",  \"TIMP2\", \"CPM\",     \"GGT1\",   \"NNMT\",\n       \"MAL\",   \"EEF1A2\", \"HGD\",   \"TCN2\",  \"CDA\",   \"PCCA\",    \"CRYM\",   \"PDXK\",\n       \"STC1\",  \"WARS\",  \"HMOX1\", \"FXYD2\", \"RBP4\",   \"SLC6A12\", \"KDELR3\", \"ITM2B\")\neg = bitr(x, fromType=\"SYMBOL\", toType=\"ENTREZID\", OrgDb=\"org.Hs.eg.db\")\nhead(eg)##   SYMBOL ENTREZID\n## 1   GPX3     2878\n## 2   GLRX     2745\n## 3    LBP     3929\n## 4  CRYAB     1410\n## 5  DEFB1     1672\n## 6  HCLS1     3059\nlibrary(org.Hs.eg.db)\nkeytypes(org.Hs.eg.db)##  [1] \"ACCNUM\"       \"ALIAS\"        \"ENSEMBL\"      \"ENSEMBLPROT\"  \"ENSEMBLTRANS\"\n##  [6] \"ENTREZID\"     \"ENZYME\"       \"EVIDENCE\"     \"EVIDENCEALL\"  \"GENENAME\"    \n## [11] \"GENETYPE\"     \"GO\"           \"GOALL\"        \"IPI\"          \"MAP\"         \n## [16] \"OMIM\"         \"ONTOLOGY\"     \"ONTOLOGYALL\"  \"PATH\"         \"PFAM\"        \n## [21] \"PMID\"         \"PROSITE\"      \"REFSEQ\"       \"SYMBOL\"       \"UCSCKG\"      \n## [26] \"UNIPROT\"\nids <- bitr(x, fromType=\"SYMBOL\", toType=c(\"UNIPROT\", \"ENSEMBL\"), OrgDb=\"org.Hs.eg.db\")## Warning in bitr(x, fromType = \"SYMBOL\", toType = c(\"UNIPROT\", \"ENSEMBL\"), :\n## 1.79% of input gene IDs are fail to map...\nhead(ids)##   SYMBOL    UNIPROT         ENSEMBL\n## 1   GPX3     P22352 ENSG00000211445\n## 2   GLRX A0A024RAM2 ENSG00000173221\n## 3   GLRX     P35754 ENSG00000173221\n## 4    LBP     P18428 ENSG00000129988\n## 5    LBP     Q8TCF0 ENSG00000129988\n## 6  CRYAB     P02511 ENSG00000109846\nm <- bitr(\"GO:0006805\", fromType=\"GO\", toType = \"SYMBOL\", OrgDb=org.Hs.eg.db)\ndim(m)## [1] 111   4\nhead(m)##           GO EVIDENCE ONTOLOGY SYMBOL\n## 1 GO:0006805      TAS       BP   NAT1\n## 2 GO:0006805      TAS       BP   NAT2\n## 3 GO:0006805      TAS       BP  AADAC\n## 4 GO:0006805      TAS       BP   AOC1\n## 5 GO:0006805      TAS       BP   ACY1\n## 6 GO:0006805      TAS       BP    AHR"},{"path":"useful-utilities.html","id":"bitr_kegg","chapter":"17 Useful utilities","heading":"17.1.2 bitr_kegg: converting biological IDs using KEGG API","text":"ID type (fromType & toType) one ‚Äòkegg,‚Äô ‚Äòncbi-geneid,‚Äô ‚Äòncbi-proteinid‚Äô ‚Äòuniprot.‚Äô ‚Äòkegg‚Äô primary ID used KEGG database. data source KEGG NCBI. rule thumb ‚Äòkegg‚Äô ID entrezgene ID eukaryote species Locus ID prokaryotes.Many prokaryote species don‚Äôt entrezgene ID available. example can check gene information ece:Z5100 http://www.genome.jp/dbget-bin/www_bget?ece:Z5100, NCBI-ProteinID UnitProt links DBs Entry, NCBI-GeneID.try convert Z5100 ncbi-geneid, bitr_kegg throw error ncbi-geneid supported.can course convert ncbi-proteinid uniprot:","code":"\ndata(gcSample)\nhg <- gcSample[[1]]\nhead(hg)## [1] \"4597\"  \"7111\"  \"5266\"  \"2175\"  \"755\"   \"23046\"\neg2np <- bitr_kegg(hg, fromType='kegg', toType='ncbi-proteinid', organism='hsa')## Warning in bitr_kegg(hg, fromType = \"kegg\", toType = \"ncbi-proteinid\", organism\n## = \"hsa\"): 3.7% of input gene IDs are fail to map...\nhead(eg2np)##    kegg ncbi-proteinid\n## 1 10001      NP_005457\n## 2 10209      NP_005792\n## 3 10232      NP_037536\n## 4 10324      NP_006054\n## 5 10411   NP_001092002\n## 6 10614      NP_006451\nbitr_kegg(\"Z5100\", fromType=\"kegg\", toType='ncbi-geneid', organism='ece')\n\n## Error in KEGG_convert(fromType, toType, organism) :\n## ncbi-geneid is not supported for ece ...\nbitr_kegg(\"Z5100\", fromType=\"kegg\", toType='ncbi-proteinid', organism='ece')##    kegg ncbi-proteinid\n## 1 Z5100       AAG58814\nbitr_kegg(\"Z5100\", fromType=\"kegg\", toType='uniprot', organism='ece')##    kegg    uniprot\n## 1 Z5100 A0A7Z3D5K5"},{"path":"useful-utilities.html","id":"setReadable","chapter":"17 Useful utilities","heading":"17.2 setReadable: translating gene IDs to human readable symbols","text":"functions, especially internally supported , GO, Reactome Pathway, support parameter, readable. readable = TRUE, gene IDs translated gene symbols. readable parameter available enrichment analysis KEGG using user‚Äôs annotation. KEGG analysis using enrichKEGG gseKEGG, internally query annotation information KEEGG database thus support species available KEGG database. However, KEGG database doesn‚Äôt provide gene ID symbol mapping information. analysis using user‚Äôs annotation data, even don‚Äôt know species analyzed. Translating gene IDs gene symbols partly supported using setReadable function OrgDb available.functions internally support readable parameter, user can also use setReadable translating gene IDs.","code":"\nlibrary(org.Hs.eg.db)\nlibrary(clusterProfiler)\n\ndata(geneList, package=\"DOSE\")\nde <- names(geneList)[1:100]\nx <- enrichKEGG(de)\n## The geneID column is ENTREZID\nhead(x, 3)##                ID         Description GeneRatio  BgRatio       pvalue\n## hsa04110 hsa04110          Cell cycle      8/47 124/8091 4.624799e-07\n## hsa04218 hsa04218 Cellular senescence      7/47 156/8091 2.849276e-05\n## hsa04114 hsa04114      Oocyte meiosis      6/47 129/8091 9.185925e-05\n##              p.adjust       qvalue                               geneID Count\n## hsa04110 5.457262e-05 4.965573e-05 8318/991/9133/890/983/4085/7272/1111     8\n## hsa04218 1.681073e-03 1.529612e-03    2305/4605/9133/890/983/51806/1111     7\n## hsa04114 3.613130e-03 3.287594e-03         991/9133/983/4085/51806/6790     6\ny <- setReadable(x, OrgDb = org.Hs.eg.db, keyType=\"ENTREZID\")\n## The geneID column is translated to symbol\nhead(y, 3)##                ID         Description GeneRatio  BgRatio       pvalue\n## hsa04110 hsa04110          Cell cycle      8/47 124/8091 4.624799e-07\n## hsa04218 hsa04218 Cellular senescence      7/47 156/8091 2.849276e-05\n## hsa04114 hsa04114      Oocyte meiosis      6/47 129/8091 9.185925e-05\n##              p.adjust       qvalue\n## hsa04110 5.457262e-05 4.965573e-05\n## hsa04218 1.681073e-03 1.529612e-03\n## hsa04114 3.613130e-03 3.287594e-03\n##                                                 geneID Count\n## hsa04110 CDC45/CDC20/CCNB2/CCNA2/CDK1/MAD2L1/TTK/CHEK1     8\n## hsa04218     FOXM1/MYBL2/CCNB2/CCNA2/CDK1/CALML5/CHEK1     7\n## hsa04114          CDC20/CCNB2/CDK1/MAD2L1/CALML5/AURKA     6"},{"path":"useful-utilities.html","id":"read-gmt","chapter":"17 Useful utilities","heading":"17.3 Parsing GMT files","text":"GMT (Gene Matrix Transposed) file format tab delimited file format widely used describe gene sets. row GMT format represents one gene set gene set described name (ID), description genes gene set illustrated Figure 17.1.\nFigure 17.1: GMT format. Figure taken https://software.broadinstitute.org/cancer/software/gsea/wiki/index.php/Data_formats.\nclusterProfiler package implemented function, read.gmt(), parse GMT file data.frame. WikiPathway GMT file encodes information version, wpid species Description column. clusterProfiler provides read.gmt.wp() function parse WikiPathway GMT file supports parsing information encoded Description column.Gene set resources:https://maayanlab.cloud/Enrichr/#statshttp://ge-lab.org/#/dataThere many gene sets available online. parsing read.gmt() function, data can directly used perform enrichment analysis using enricher() GSEA() functions (see also Chapter 12).","code":"\nurl <- \"https://maayanlab.cloud/Enrichr/geneSetLibrary?mode=text&libraryName=COVID-19_Related_Gene_Sets\"\ndownload.file(url, destfile = \"COVID19_GeneSets.gmt\")\ncovid19_gs <- read.gmt(\"COVID19_GeneSets.gmt\")\nhead(covid19_gs)##                                     term    gene\n## 1 COVID19-E protein host PPI from Krogan    BRD4\n## 2 COVID19-E protein host PPI from Krogan    BRD2\n## 3 COVID19-E protein host PPI from Krogan SLC44A2\n## 4 COVID19-E protein host PPI from Krogan  ZC3H18\n## 5 COVID19-E protein host PPI from Krogan   AP3B1\n## 6 COVID19-E protein host PPI from Krogan   CWC27"},{"path":"useful-utilities.html","id":"go-utilities","chapter":"17 Useful utilities","heading":"17.4 GO utilities","text":"","code":""},{"path":"useful-utilities.html","id":"drop-specific-go-terms-or-level","chapter":"17 Useful utilities","heading":"17.4.1 drop specific GO terms or level","text":"enrichGO() function tests whole GO corpus enriched result may contains general terms. dropGO function, user can remove specific GO terms GO level results obtained enrichGO() compareCluster().","code":""},{"path":"useful-utilities.html","id":"test-go-at-sepcific-level","chapter":"17 Useful utilities","heading":"17.4.2 test GO at sepcific level","text":"enrichGO() doesn‚Äôt contain parameter restrict test specific GO level. Instead, provide function, gofilter(), restrict result specific GO level. works results obtained enrichGO() compareCluster().","code":""},{"path":"useful-utilities.html","id":"reduce-redundancy-of-enriched-go-terms","chapter":"17 Useful utilities","heading":"17.4.3 reduce redundancy of enriched GO terms","text":"GO organized parent-child structure, thus parent term can overlapped large proportion child terms. can result redundant findings. solve issue, clusterProfiler implements simplify method reduce redundant GO terms outputs enrichGO() gseGO(). function internally called GOSemSim (Yu et al. 2010) calculate semantic similarity among GO terms remove highly similar terms keeping one representative term. simplify() method apply select_fun (can user defined function) feature select one representative term redundant terms (similarity higher cutoff).Figure 17.2A, can found many redundant terms form highly condense network. removing redundant terms using simplify() method, result clear view whole story.\nFigure 17.2: Visualize enriched terms EnrichmentMap using emapplot() function. () original result. (B) simplify result.\nAlternatively, users can use slim version GO use enricher() o r gseGO() functions analyze.","code":"\ndata(geneList, package=\"DOSE\")\nde <- names(geneList)[abs(geneList) > 2]\nbp <- enrichGO(de, ont=\"BP\", OrgDb = 'org.Hs.eg.db')\nbp <- pairwise_termsim(bp)\nbp2 <- simplify(bp, cutoff=0.7, by=\"p.adjust\", select_fun=min)\np1 <- emapplot(bp)\np2 <- emapplot(bp2)\ncowplot::plot_grid(p1, p2, ncol=2, labels = LETTERS[1:2])"},{"path":"faq.html","id":"faq","chapter":"A Frequently asked questions","heading":"A Frequently asked questions","text":"","code":""},{"path":"faq.html","id":"genelist","chapter":"A Frequently asked questions","heading":"A.1 How to prepare your own geneList","text":"GSEA analysis requires ranked gene list, contains three features:numeric vector: fold change type numerical variablenamed vector: every number name, corresponding gene IDsorted vector: number sorted decreasing orderIf import data csv file, file contains two columns, one gene ID (duplicated ID allowed) another one fold change. can prepare geneList via following command:","code":"\nd = read.csv(your_csv_file)\n## assume 1st column is ID\n## 2nd column is FC\n\n## feature 1: numeric vector\ngeneList = d[,2]\n\n## feature 2: named vector\nnames(geneList) = as.character(d[,1])\n\n## feature 3: decreasing orde\ngeneList = sort(geneList, decreasing = TRUE)"},{"path":"faq.html","id":"no-gene-can-be-mapped","chapter":"A Frequently asked questions","heading":"A.2 No gene can be mapped","text":"https://www.biostars.org/p/431270/https://github.com/YuLab-SMU/clusterProfiler/issues/280","code":""},{"path":"faq.html","id":"showing-specific-pathways","chapter":"A Frequently asked questions","heading":"A.3 Showing specific pathways","text":"default, visualization methods provided enrichplot display significant pathways. users interested show specific pathways (e.g.¬†excluding unimportant pathways among top categories), users can pass vector selected pathways showCategory parameter dotplot(), barplot(), cnetplot() emapplot() etc.\nFigure .1: Showing specific pathways. Top ten significant pathways (), selected ten pathways (B).\nNote: Another solution using filter verb extract subset result described Chapter 16.","code":"\nlibrary(DOSE)\nlibrary(enrichplot)\ndata(geneList)\nde <- names(geneList)[1:100]\n\nx <- enrichDO(de)\n\n## show top 10 most significant pathways and want to exclude the second one\n## dotplot(x, showCategory = x$Description[1:10][-2])\n\nset.seed(2020-10-27)\nselected_pathways <- sample(x$Description, 10)\nselected_pathways##  [1] \"in situ carcinoma\"                              \n##  [2] \"hypersensitivity reaction type IV disease\"      \n##  [3] \"lymph node disease\"                             \n##  [4] \"esophageal carcinoma\"                           \n##  [5] \"atopic dermatitis\"                              \n##  [6] \"pulmonary sarcoidosis\"                          \n##  [7] \"esophageal cancer\"                              \n##  [8] \"Human immunodeficiency virus infectious disease\"\n##  [9] \"ovarian cancer\"                                 \n## [10] \"breast carcinoma\"\np1 <- dotplot(x, showCategory = 10, font.size=14)\np2 <- dotplot(x, showCategory = selected_pathways, font.size=14)\n\n\ncowplot::plot_grid(p1, p2, labels=LETTERS[1:2])"},{"path":"faq.html","id":"how-to-extract-genes-of-a-specific-termpathway","chapter":"A Frequently asked questions","heading":"A.4 How to extract genes of a specific term/pathway","text":"","code":"\nid <- x$ID[1:3]\nid## [1] \"DOID:0060071\" \"DOID:5295\"    \"DOID:8719\"\nx[[id[1]]]## [1] \"6280\"  \"6278\"  \"10232\" \"332\"   \"4321\"\ngeneInCategory(x)[id]## $`DOID:0060071`\n## [1] \"6280\"  \"6278\"  \"10232\" \"332\"   \"4321\" \n## \n## $`DOID:5295`\n## [1] \"4312\"  \"6279\"  \"3627\"  \"10563\" \"4283\"  \"890\"   \"366\"   \"4902\"  \"3620\" \n## \n## $`DOID:8719`\n## [1] \"6280\"  \"6278\"  \"10232\" \"332\""},{"path":"references.html","id":"references","chapter":"References","heading":"References","text":"","code":""}]
