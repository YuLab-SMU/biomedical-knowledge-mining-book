[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Biomedical Knowledge Mining using GOSemSim and clusterProfiler",
    "section": "",
    "text": "Welcome",
    "crumbs": [
      "Welcome"
    ]
  },
  {
    "objectID": "index.html#motivation",
    "href": "index.html#motivation",
    "title": "Biomedical Knowledge Mining using GOSemSim and clusterProfiler",
    "section": "üéØ Motivation",
    "text": "üéØ Motivation\nThe book is meant as a guide for mining biological knowledge to elucidate or interpret molecular mechanisms using a suite of R packages, including ChIPseeker, clusterProfiler, DOSE, enrichplot, GOSemSim, meshes and ReactomePA. Hence, if you are starting to read this book, we assume you have a working knowledge of how to use R.",
    "crumbs": [
      "Welcome"
    ]
  },
  {
    "objectID": "index.html#citation",
    "href": "index.html#citation",
    "title": "Biomedical Knowledge Mining using GOSemSim and clusterProfiler",
    "section": "üìù Citation",
    "text": "üìù Citation\nIf you use the software suite in published research, please cite the most appropriate paper(s) from this list:\n\n\nG Yu*. Background bias in functional enrichment analysis: Insights from clusterProfiler. The Innovation Life. 2026, 4(1):100181.\n\nG Yu*. Thirteen years of clusterProfiler. The Innovation. 2024, 5(6):100722.\nS Xu#, E Hu#, Y Cai#, Z Xie#, X Luo#, L Zhan, W Tang, Q Wang, B Liu, R Wang, W Xie, T Wu, L Xie, G Yu*. Using clusterProfiler to characterise Multi-Omics Data. Nature Protocols. 2024, 19(11):3292-3320.\nQ Wang#, M Li#, T Wu, L Zhan, L Li, M Chen, W Xie, Z Xie, E Hu, S Xu, G Yu*. Exploring epigenomic datasets by ChIPseeker. Current Protocols, 2022, 2(10): e585.\nT Wu#, E Hu#, S Xu, M Chen, P Guo, Z Dai, T Feng, L Zhou, W Tang, L Zhan, X Fu, S Liu, X Bo*, G Yu*. clusterProfiler 4.0: A universal enrichment tool for interpreting omics data. The Innovation. 2021, 2(3):100141. doi: 10.1016/j.xinn.2021.100141\n\n\nG Yu*. Gene Ontology Semantic Similarity Analysis Using GOSemSim. In: Kidder B. (eds) Stem Cell Transcriptional Networks. Methods in Molecular Biology. 2020, 2117:207-215. Humana, New York, NY. doi: 10.1007/978-1-0716-0301-7_11\n\n\nG Yu*. Using meshes for MeSH term enrichment and semantic analyses. Bioinformatics. 2018, 34(21):3766‚Äì3767. doi: 10.1093/bioinformatics/bty410\n\n\nG Yu, QY He*. ReactomePA: an R/Bioconductor package for reactome pathway analysis and visualization. Molecular BioSystems. 2016, 12(2):477-479. doi: 10.1039/C5MB00663E\n\n\nG Yu*, LG Wang, and QY He*. ChIPseeker: an R/Bioconductor package for ChIP peak annotation, comparison and visualization. Bioinformatics. 2015, 31(14):2382-2383. doi: 10.1093/bioinformatics/btv145\n\n\nG Yu*, LG Wang, GR Yan, QY He*. DOSE: an R/Bioconductor package for Disease Ontology Semantic and Enrichment analysis. Bioinformatics. 2015, 31(4):608-609. doi: 10.1093/bioinformatics/btu684\n\n\nG Yu, LG Wang, Y Han and QY He*. clusterProfiler: an R package for comparing biological themes among gene clusters. OMICS: A Journal of Integrative Biology. 2012, 16(5):284-287. doi: 10.1089/omi.2011.0118\n\n\nG Yu, F Li, Y Qin, X Bo*, Y Wu, S Wang*. GOSemSim: an R package for measuring semantic similarity among GO terms and gene products. Bioinformatics. 2010, 26(7):976-978. doi: 10.1093/bioinformatics/btq064",
    "crumbs": [
      "Welcome"
    ]
  },
  {
    "objectID": "index.html#book-structure",
    "href": "index.html#book-structure",
    "title": "Biomedical Knowledge Mining using GOSemSim and clusterProfiler",
    "section": "üìö Book structure",
    "text": "üìö Book structure\n\nPart 1 (Semantic similarity analysis) describes GOSemSim, DOSE and meshes packages for measuring semantic similarity of genes or gene products based on Gene Ontology, Disease Ontology and Medical Subject Headings.\nPart 2 (Enrichment analysis) introduces over-reprensentation analysis and gene set enrichment analysis using clusterProfiler (supports GO, KEGG, MSigDb, WikiPathway, and many others via universal interface), DOSE (DO, Disease-Gene Network, Network of Cancer Genes), meshes (MeSH), and ReactomePA (Reactome pathway). Functional enrichment analysis of Genomic coordination is supported via ChIPseeker and comparison among multiple conditions is also supported by clusterProfiler. We implemented a number of visualization methods in the enrichplot package to help users to interpret their results.\nPart 3 (Miscellaneous topics) describes useful utilities including translating gene IDs and manipulating enrichment results.",
    "crumbs": [
      "Welcome"
    ]
  },
  {
    "objectID": "index.html#want-to-help",
    "href": "index.html#want-to-help",
    "title": "Biomedical Knowledge Mining using GOSemSim and clusterProfiler",
    "section": "üíñ Want to help?",
    "text": "üíñ Want to help?\nThe book‚Äôs source code is hosted on GitHub, at https://github.com/YuLab-SMU/biomedical-knowledge-mining-book. Any feedback on the book is very welcome. Feel free to open an issue on GitHub or send me a pull request if you notice typos or other issues (I‚Äôm not a native English speaker ;) ).",
    "crumbs": [
      "Welcome"
    ]
  },
  {
    "objectID": "01-semantic-similarity.html",
    "href": "01-semantic-similarity.html",
    "title": "Semantic Similarity Analysis",
    "section": "",
    "text": "Information content-based methods\nFunctional similarity of gene products can be estimated by controlled biological vocabularies, such as Gene Ontology (GO), Disease Ontology (DO) and Medical Subject Headings (MeSH).\nFour methods including Resnik (Philip 1999), Jiang (Jiang and Conrath 1997), Lin (Lin 1998) and Schlicker (Schlicker et al. 2006) have been presented to determine the semantic similarity of two GO terms based on the annotation statistics of their common ancestor terms. Wang (Wang et al. 2007) proposed a method to measure the similarity based on the graph structure of GO. Each of these methods has its own advantages and weaknesses and can be applied to other ontologies that have similar structure (i.e.¬†directed acyclic graph).\nFour methods proposed by Resnik (Philip 1999), Jiang (Jiang and Conrath 1997), Lin (Lin 1998) and Schlicker (Schlicker et al. 2006) are information content (IC) based, which depend on the frequencies of two GO terms involved and that of their closest common ancestor term in a specific corpus of GO annotations. The information content of a GO term is computed by the negative log probability of the term occurring in GO corpus. A rarely used term contains a greater amount of information.\nThe frequency of a term t is defined as:\n\\[p(t) = \\frac{n_{t'}}{N} | t' \\in \\left\\{t, \\; children\\: of\\: t \\right\\}\\]\nwhere \\(n_{t'}\\) is the number of term \\(t'\\), and \\(N\\) is the total number of terms in GO corpus.\nThus the information content is defined as:\n\\[IC(t) = -\\log(p(t))\\]\nAs GO allow multiple parents for each concept, two terms can share parents by multiple paths. IC-based methods calculate similarity of two GO terms based on the information content of their closest common ancestor term, which was also called most informative common ancestor (MICA).",
    "crumbs": [
      "Semantic Similarity Analysis"
    ]
  },
  {
    "objectID": "01-semantic-similarity.html#information-content-based-methods",
    "href": "01-semantic-similarity.html#information-content-based-methods",
    "title": "Semantic Similarity Analysis",
    "section": "",
    "text": "Resnik method\nThe Resnik method is defined as:\n\\[sim_{Resnik}(t_1,t_2) = IC(MICA)\\]\n\n\nLin method\nThe Lin method is defined as:\n\\[sim_{Lin}(t_1,t_2) = \\frac{2IC(MICA)}{IC(t_1)+IC(t_2)}\\]\n\n\nRel method\nThe Relevance method, which was proposed by Schlicker, combine Resnik‚Äôs and Lin‚Äôs method and is defined as:\n\\[sim_{Rel}(t_1,t_2) = \\frac{2IC(MICA)(1-p(MICA))}{IC(t_1)+IC(t_2)}\\]\n\n\nJiang method\nThe Jiang and Conrath‚Äôs method is defined as:\n\\[sim_{Jiang}(t_1,t_2) = 1-\\min(1, IC(t_1) + IC(t_2) - 2IC(MICA))\\]",
    "crumbs": [
      "Semantic Similarity Analysis"
    ]
  },
  {
    "objectID": "01-semantic-similarity.html#graph-based-method",
    "href": "01-semantic-similarity.html#graph-based-method",
    "title": "Semantic Similarity Analysis",
    "section": "Graph-based method",
    "text": "Graph-based method\nGraph-based methods using the topology of GO graph structure to compute semantic similarity. Formally, a GO term A can be represented as \\(DAG_{A}=(A,T_{A},E_{A})\\) where \\(T_{A}\\) is the set of GO terms in \\(DAG_{A}\\), including term A and all of its ancestor terms in the GO graph, and \\(E_{A}\\) is the set of edges connecting the GO terms in \\(DAG_{A}\\).\n\nWang method\nTo encode the semantic of a GO term in a measurable format to enable a quantitative comparison, Wang(Wang et al. 2007) firstly defined the semantic value of term A as the aggregate contribution of all terms in \\(DAG_{A}\\) to the semantics of term A, terms closer to term A in \\(DAG_{A}\\) contribute more to its semantics. Thus, defined the contribution of a GO term \\(t\\) to the semantic of GO term \\(A\\) as the S-value of GO term \\(t\\) related to term \\(A\\).\nFor any of term \\(t\\) in \\(DAG_{A}\\), its S-value related to term \\(A\\), \\(S_{A}(\\textit{t})\\) is defined as:\n\\[\\left\\{\\begin{array}{l} S_{A}(A)=1 \\\\ S_{A}(\\textit{t})=\\max\\{w_{e} \\times S_{A}(\\textit{t}') | \\textit{t}' \\in children \\: of(\\textit{t}) \\} \\; if \\: \\textit{t} \\ne A \\end{array} \\right.\\]\nwhere \\(w_{e}\\) is the semantic contribution factor for edge \\(e \\in E_{A}\\) linking term \\(t\\) with its child term \\(t'\\). Term \\(A\\) contributes to its own is defined as 1. After obtaining the S-values for all terms in \\(DAG_{A}\\), the semantic value of DO term A, \\(SV(A)\\), is calculated as:\n\\[SV(A)=\\displaystyle\\sum_{t \\in T_{A}} S_{A}(t)\\]\nThus given two GO terms A and B, the semantic similarity between these two terms is defined as:\n\\[sim_{Wang}(A, B) = \\frac{\\displaystyle\\sum_{t \\in T_{A} \\cap T_{B}}{S_{A}(t) + S_{B}(t)}}{SV(A) + SV(B)}\\]\nwhere \\(S_{A}(\\textit{t})\\) is the S-value of GO term \\(t\\) related to term \\(A\\) and \\(S_{B}(\\textit{t})\\) is the S-value of GO term \\(t\\) related to term \\(B\\).\nThis method proposed by Wang (Wang et al. 2007) determines the semantic similarity of two GO terms based on both the locations of these terms in the GO graph and their relations with their ancestor terms.",
    "crumbs": [
      "Semantic Similarity Analysis"
    ]
  },
  {
    "objectID": "01-semantic-similarity.html#combine-methods",
    "href": "01-semantic-similarity.html#combine-methods",
    "title": "Semantic Similarity Analysis",
    "section": "Combine methods",
    "text": "Combine methods\nSince a gene product can be annotated by multiple GO terms, semantic similarity among gene products needs to be aggregated from different semantic similarity scores of multiple GO terms associated with genes, including max, avg, rcmax and BMA.\n\nmax\nThe max method calculates the maximum semantic similarity score over all pairs of GO terms between these two GO term sets.\n\\[sim_{max}(g_1, g_2) = \\displaystyle\\max_{1 \\le i \\le m, 1 \\le j \\le n} sim(go_{1i}, go_{2j})\\]\n\n\navg\nThe avg calculates the average semantic similarity score over all pairs of GO terms.\n\\[sim_{avg}(g_1, g_2) = \\frac{\\displaystyle\\sum_{i=1}^m\\sum_{j=1}^nsim(go_{1i}, go_{2j})}{m \\times n}\\]\n\n\nrcmax\nSimilarities among two sets of GO terms form a matrix, the rcmax method uses the maximum of RowScore and ColumnScore, where RowScore (or ColumnScore) is the average of maximum similarity on each row (or column).\n\\[sim_{rcmax}(g_1, g_2) = \\max(\\frac{\\displaystyle\\sum_{i=1}^m \\max_{1 \\le j \\le n} sim(go_{1i}, go_{2j})}{m},\\frac{\\displaystyle\\sum_{j=1}^n \\max_{1 \\le i \\le m} sim(go_{1i},go_{2j})}{n})\\]\n\n\nBMA\nThe BMA method, used the Best-Match Average strategy, calculates the average of all maximum similarities on each row and column, and is defined as:\n\\[sim_{BMA}(g_1, g_2) = \\frac{\\displaystyle\\sum_{1=i}^m \\max_{1 \\le j \\le n}sim(go_{1i}, go_{2j}) + \\displaystyle\\sum_{1=j}^n \\max_{1 \\le i \\le m}sim(go_{1i}, go_{2j})} {m+n}\\]",
    "crumbs": [
      "Semantic Similarity Analysis"
    ]
  },
  {
    "objectID": "01-semantic-similarity.html#summary",
    "href": "01-semantic-similarity.html#summary",
    "title": "Semantic Similarity Analysis",
    "section": "Summary",
    "text": "Summary\nThe idea behind semantic similarity measurement is the notion that genes with similar function should have similar annotation vocabulary and have a close relationship in the ontology strucutre. Measuring similarity is critical for expanding knownledge, since similar objects tend to behave similarly, which supports many bioinformatics applications to infer gene/protein functions, miRNA function, genetic interaction, protein-protein interaction, miRNA-mRNA interaction and celluar localization.\nWe developed several Bioconductor packages, including r Biocpkg(\"GOSemSim\") (Yu et al. 2010; Yu 2020) for computing semantic similarity among GO terms, sets of GO terms, gene products and gene clusters (see also Chapter 2), r Biocpkg(\"DOSE\") (Yu et al. 2015) for Disease Ontology (DO) (see also Chapter 3) and r Biocpkg(\"meshes\") (Yu 2018) that based on Medical Subject Headings (MeSH) (see also Chapter 4).\n\n\n\n\nJiang, Jay J., and David W. Conrath. 1997. ‚ÄúSemantic Similarity Based on Corpus Statistics and Lexical Taxonomy.‚Äù Proceedings of 10th International Conference on Research In Computational Linguistics. http://www.citebase.org/abstract?id=oai:arXiv.org:cmp-lg/9709008.\n\n\nLin, Dekang. 1998. ‚ÄúAn Information-Theoretic Definition of Similarity.‚Äù In Proceedings of the 15th International Conference on Machine Learning, 296‚Äî304. https://doi.org/10.1.1.55.1832.\n\n\nPhilip, Resnik. 1999. ‚ÄúSemantic Similarity in a Taxonomy: An Information-Based Measure and Its Application to Problems of Ambiguity in Natural Language.‚Äù Journal of Artificial Intelligence Research 11: 95‚Äì130.\n\n\nSchlicker, Andreas, Francisco S Domingues, J√∂rg Rahnenf√ºhrer, and Thomas Lengauer. 2006. ‚ÄúA New Measure for Functional Similarity of Gene Products Based on Gene Ontology.‚Äù BMC Bioinformatics 7: 302. https://doi.org/1471-2105-7-302.\n\n\nWang, James Z, Zhidian Du, Rapeeporn Payattakool, Philip S Yu, and Chin-Fu Chen. 2007. ‚ÄúA New Method to Measure the Semantic Similarity of GO Terms.‚Äù Bioinformatics (Oxford, England) 23 (May): 1274‚Äì81. https://doi.org/btm087.\n\n\nYu, Guangchuang. 2018. ‚ÄúUsing Meshes for MeSH Term Enrichment and Semantic Analyses.‚Äù Bioinformatics 34 (21): 3766‚Äì67. https://doi.org/10.1093/bioinformatics/bty410.\n\n\n‚Äî‚Äî‚Äî. 2020. ‚ÄúGene Ontology Semantic Similarity Analysis Using GOSemSim.‚Äù Methods in Molecular Biology (Clifton, N.J.) 2117: 207‚Äì15. https://doi.org/10.1007/978-1-0716-0301-7_11.\n\n\nYu, Guangchuang, Fei Li, Yide Qin, Xiaochen Bo, Yibo Wu, and Shengqi Wang. 2010. ‚ÄúGOSemSim: An r Package for Measuring Semantic Similarity Among GO Terms and Gene Products.‚Äù Bioinformatics 26 (7): 976‚Äì78. https://doi.org/10.1093/bioinformatics/btq064.\n\n\nYu, Guangchuang, Li-Gen Wang, Guang-Rong Yan, and Qing-Yu He. 2015. ‚ÄúDOSE: An r/Bioconductor Package for Disease Ontology Semantic and Enrichment Analysis.‚Äù Bioinformatics 31 (4): 608‚Äì9. https://doi.org/10.1093/bioinformatics/btu684.",
    "crumbs": [
      "Semantic Similarity Analysis"
    ]
  },
  {
    "objectID": "011-GOSemSim.html",
    "href": "011-GOSemSim.html",
    "title": "1¬† GO semantic similarity analysis",
    "section": "",
    "text": "1.1 Semantic data\nGOSemSim implemented all methods described in Chapter 1, including four IC-based methods and one graph-based method.\nTo measure semantic similarity, we need to prepare GO annotations including GO structure (i.e.¬†GO term relationships) and gene to GO mapping. For IC-based methods, information of GO term is species specific. We need to calculate IC for all GO terms of a species before we measure semantic similarity.\nGOSemSim provides the godata() function to prepare semantic data to support measuring GO and gene simiarlity. It internally used the GO.db package to obtain GO strucuture and OrgDb for gene to GO mapping.\nlibrary(GOSemSim)\nhsGO &lt;- godata(annoDb = 'org.Hs.eg.db', ont=\"MF\")\nUser can set computeIC=FALSE if they only want to use Wang‚Äôs method.",
    "crumbs": [
      "Semantic Similarity Analysis",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>GO semantic similarity analysis</span>"
    ]
  },
  {
    "objectID": "011-GOSemSim.html#gosemsim-supported-organisms",
    "href": "011-GOSemSim.html#gosemsim-supported-organisms",
    "title": "1¬† GO semantic similarity analysis",
    "section": "\n1.2 Supported organisms",
    "text": "1.2 Supported organisms\nGOSemSim supports all organisms that have an OrgDb object available.\nBioconductor have already provided OrgDb for about 20 species.\nWe can query OrgDb online via the AnnotationHub package. For example:\n\nlibrary(AnnotationHub)\nhub &lt;- AnnotationHub()\nq &lt;- query(hub, \"Cricetulus\")\nid &lt;- q$ah_id[length(q)]\nCgriseus &lt;- hub[[id]]\n\nIf an organism is not supported by AnnotationHub, user can use the AnnotationForge package to build OrgDb manually.\nOnce we have OrgDb, we can build annotation data needed by GOSemSim via godata() function described previously.",
    "crumbs": [
      "Semantic Similarity Analysis",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>GO semantic similarity analysis</span>"
    ]
  },
  {
    "objectID": "011-GOSemSim.html#go-semantic-simiarlity",
    "href": "011-GOSemSim.html#go-semantic-simiarlity",
    "title": "1¬† GO semantic similarity analysis",
    "section": "\n1.3 GO semantic similarity measurement",
    "text": "1.3 GO semantic similarity measurement\nThe goSim() function calculates semantic similarity between two GO terms, while the mgoSim() function calculates semantic similarity between two sets of GO terms.\n\ngoSim(\"GO:0004022\", \"GO:0005515\", semData=hsGO, measure=\"Jiang\")\n\n[1] 0.258\n\ngoSim(\"GO:0004022\", \"GO:0005515\", semData=hsGO, measure=\"Wang\")\n\n[1] 0.116\n\ngo1 = c(\"GO:0004022\",\"GO:0004024\",\"GO:0004174\")\ngo2 = c(\"GO:0009055\",\"GO:0005515\")\nmgoSim(go1, go2, semData=hsGO, measure=\"Wang\", combine=NULL)\n\n           GO:0009055 GO:0005515\nGO:0004022      0.368      0.116\nGO:0004024      0.335      0.107\nGO:0004174      0.663      0.119\n\nmgoSim(go1, go2, semData=hsGO, measure=\"Wang\", combine=\"BMA\")\n\n[1] 0.43",
    "crumbs": [
      "Semantic Similarity Analysis",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>GO semantic similarity analysis</span>"
    ]
  },
  {
    "objectID": "011-GOSemSim.html#gene-go-semantic-similarity",
    "href": "011-GOSemSim.html#gene-go-semantic-similarity",
    "title": "1¬† GO semantic similarity analysis",
    "section": "\n1.4 Gene semantic similarity measurement",
    "text": "1.4 Gene semantic similarity measurement\nOn the basis of semantic similarity between GO terms, GOSemSim can also compute semantic similarity among sets of GO terms, gene products, and gene clusters.\nSuppose we have gene \\(g_1\\) annotated by GO terms sets \\(GO_{1}=\\{go_{11},go_{12} \\cdots go_{1m}\\}\\) and \\(g_2\\) annotated by \\(GO_{2}=\\{go_{21},go_{22} \\cdots go_{2n}\\}\\), GOSemSim implemented four combine methods, including max, avg, rcmax, and BMA, to aggregate semantic similarity scores of multiple GO terms (see also session 1.3). The similarities among gene products and gene clusters which annotated by multiple GO terms are also calculated by the these combine methods.\nGOSemSim provides geneSim() to calculate semantic similarity between two gene products, and mgeneSim() to calculate semantic similarity among multiple gene products.\n\nGOSemSim::geneSim(\"241\", \"251\", semData=hsGO, measure=\"Wang\", combine=\"BMA\")\n\n$geneSim\n[1] 0.149\n\n$GO1\n[1] \"GO:0004364\" \"GO:0004464\" \"GO:0004602\" \"GO:0005515\" \"GO:0050544\"\n\n$GO2\n[1] \"GO:0004035\"\n\nmgeneSim(genes=c(\"835\", \"5261\",\"241\", \"994\"),\n         semData=hsGO, measure=\"Wang\",verbose=FALSE)\n\n       835  5261   241   994\n835  1.000 0.576 0.515 0.671\n5261 0.576 1.000 0.393 0.499\n241  0.515 0.393 1.000 0.414\n994  0.671 0.499 0.414 1.000\n\nmgeneSim(genes=c(\"835\", \"5261\",\"241\", \"994\"),\n       semData=hsGO, measure=\"Rel\",verbose=FALSE)\n\n       835  5261   241   994\n835  0.934 0.435 0.312 0.546\n5261 0.435 0.929 0.331 0.471\n241  0.312 0.331 0.946 0.286\n994  0.546 0.471 0.286 0.928\n\n\nBy default, godata function use ENTREZID as keytype, and the input ID type is ENTREZID. User can use other ID types such as ENSEMBL, UNIPROT, REFSEQ, ACCNUM, SYMBOL et al.\nHere as an example, we use SYMBOL as keytype and calculate semantic similarities among several genes by using their gene symbol as input.\n\nhsGO2 &lt;- godata('org.Hs.eg.db', keytype = \"SYMBOL\", ont=\"MF\", computeIC=FALSE) \ngenes &lt;- c(\"CDC45\", \"MCM10\", \"CDC20\", \"NMU\", \"MMP1\")\nmgeneSim(genes, semData=hsGO2, measure=\"Wang\", combine=\"BMA\", verbose=FALSE)\n\n      CDC45 MCM10 CDC20   NMU  MMP1\nCDC45 1.000 0.916 0.475 0.592 0.169\nMCM10 0.916 1.000 0.505 0.620 0.160\nCDC20 0.475 0.505 1.000 0.555 0.162\nNMU   0.592 0.620 0.555 1.000 0.150\nMMP1  0.169 0.160 0.162 0.150 1.000\n\n\nUsers can also use clusterProfiler::bitr to translate biological IDs.",
    "crumbs": [
      "Semantic Similarity Analysis",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>GO semantic similarity analysis</span>"
    ]
  },
  {
    "objectID": "011-GOSemSim.html#gene-cluster-go-semantic-similarity",
    "href": "011-GOSemSim.html#gene-cluster-go-semantic-similarity",
    "title": "1¬† GO semantic similarity analysis",
    "section": "\n1.5 Gene cluster semantic similarity measurement",
    "text": "1.5 Gene cluster semantic similarity measurement\nGOSemSim also supports calculating semantic similarity between two gene clusters using clusterSim() function and measuring semantic similarity among multiple gene clusters using mclusterSim() function.\n\ngs1 &lt;- c(\"835\", \"5261\",\"241\", \"994\", \"514\", \"533\")\ngs2 &lt;- c(\"578\",\"582\", \"400\", \"409\", \"411\")\nclusterSim(gs1, gs2, semData=hsGO, measure=\"Wang\", combine=\"BMA\")\n\n[1] 0.588\n\nlibrary(org.Hs.eg.db)\nx &lt;- org.Hs.egGO\nhsEG &lt;- mappedkeys(x)\nset.seed &lt;- 123\nclusters &lt;- list(a=sample(hsEG, 20), b=sample(hsEG, 20), c=sample(hsEG, 20))\nmclusterSim(clusters, semData=hsGO, measure=\"Wang\", combine=\"BMA\")\n\n      a     b     c\na 1.000 0.676 0.651\nb 0.676 1.000 0.724\nc 0.651 0.724 1.000",
    "crumbs": [
      "Semantic Similarity Analysis",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>GO semantic similarity analysis</span>"
    ]
  },
  {
    "objectID": "011-GOSemSim.html#references",
    "href": "011-GOSemSim.html#references",
    "title": "1¬† GO semantic similarity analysis",
    "section": "References",
    "text": "References",
    "crumbs": [
      "Semantic Similarity Analysis",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>GO semantic similarity analysis</span>"
    ]
  },
  {
    "objectID": "012-DOSE-semantic-similarity.html",
    "href": "012-DOSE-semantic-similarity.html",
    "title": "2¬† DO semantic similarity analysis",
    "section": "",
    "text": "2.1 DO term semantic similarity measurement\nPublic health is an important driving force behind biological and medical research. A major challenge of the post-genomic era is bridging the gap between fundamental biological research and its clinical applications. Recent research has increasingly demonstrated that many seemingly dissimilar diseases have common molecular mechanisms. Understanding similarities among disease aids in early diagnosis and new drug development.\nFormal knowledge representation of gene-disease association is demanded for this purpose. Ontologies, such as Gene Ontology (GO), have been successfully applied to represent biological knowledge, and many related techniques have been adopted to extract information. Disease Ontology (DO) (Schriml et al. 2011) was developed to create a consistent description of gene products with disease perspectives, and is essential for supporting functional genomics in disease context. Accurate disease descriptions can discover new relationships between genes and disease, and new functions for previous uncharacteried genes and alleles.\nDisease Ontology (DO) (Schriml et al. 2011) aims to provide an open source ontology for the integration of biomedical data that is associated with human disease. Unlike other clinical vocabularies that defined disease related concepts disparately, DO is organized as a directed acyclic graph, laying the foundation for quantitative computation of disease knowledge.\nWe developed an R package DOSE (Yu et al. 2015) for analyzing semantic similarities among DO terms and gene products annotated with DO terms.\nFour methods determine the semantic similarity of two terms based on the Information Content of their common ancestor term were proposed by Resnik (Philip 1999), Jiang (Jiang and Conrath 1997), Lin (Lin 1998) and Schlicker (Schlicker et al. 2006). Wang (Wang et al. 2007) presented a method to measure the similarity based on the graph structure. Each of these methods has its own advantage and weakness. DOSE supports all these methods to compute semantic similarity among DO terms and gene products. For algorithm details, please refer to chapter 1.\nIn DOSE, we implemented doSim for calculating semantic similarity between two DO terms and two set of DO terms.\nlibrary(DOSE)\n\na &lt;- c(\"DOID:14095\", \"DOID:5844\", \"DOID:2044\", \"DOID:8432\", \"DOID:9146\",\n       \"DOID:10588\", \"DOID:3209\", \"DOID:848\", \"DOID:3341\", \"DOID:252\")\nb &lt;- c(\"DOID:9409\", \"DOID:2491\", \"DOID:4467\", \"DOID:3498\", \"DOID:11256\")\ndoSim(a[1], b[1], measure=\"Wang\")\n\n[1] 0\n\ndoSim(a[1], b[1], measure=\"Resnik\")\n\n[1] 0\n\ndoSim(a[1], b[1], measure=\"Lin\")\n\n[1] 0\n\ns &lt;- doSim(a, b, measure=\"Wang\")\ns\n\n            DOID:9409  DOID:2491 DOID:4467 DOID:3498 DOID:11256\nDOID:14095 0.00000000 0.00000000         0         0  0.4911517\nDOID:5844  0.09336027 0.07142995         0         0  0.0000000\nDOID:2044  0.09336027 0.07142995         0         0  0.0000000\nDOID:8432  0.13541255 0.10989239         0         0  0.0000000\nDOID:9146  0.00000000 0.00000000         0         0  0.1098924\nDOID:10588 0.08237910 0.14897652         0         0  0.0000000\nDOID:3209  0.07496322 0.05452137         0         0  0.0000000\nDOID:848   0.09336027 0.07142995         0         0  0.0000000\nDOID:3341  0.08237910 0.06134327         0         0  0.0000000\nDOID:252   0.00000000 0.00000000         0         0  0.0000000\nThe doSim function requires three parameter DOID1, DOID2 and measure. DOID1 and DOID2 should be a vector of DO terms, while measure should be one of Resnik, Jiang, Lin, Rel, and Wang.\nWe also implement a plot function simplot() to visualize the similarity result as demonstrated in Figure¬†2.1.\nFigure¬†2.1: Similarity matrix visualization. The simplot() function visualize similarity matrix as a heatmap.\nParameter color.low and colow.high are used to setting the color gradient; labs is a logical parameter indicating whether to show the similarity values or not, digits to indicate the number of decimal places to be used and labs.size control the font size of similarity values; font.size setting the font size of axis and label of the coordinate system.",
    "crumbs": [
      "Semantic Similarity Analysis",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>DO semantic similarity analysis</span>"
    ]
  },
  {
    "objectID": "012-DOSE-semantic-similarity.html#gene-do-semantic-similarity",
    "href": "012-DOSE-semantic-similarity.html#gene-do-semantic-similarity",
    "title": "2¬† DO semantic similarity analysis",
    "section": "\n2.2 Gene semantic similarity measurement",
    "text": "2.2 Gene semantic similarity measurement\nOn the basis of semantic similarity between DO terms, DOSE can also compute semantic similarity among gene products. DOSE provides four methods which called max, avg, rcmax and BMA to combine semantic similarity scores of multiple DO terms (as described in session 1.3). The similarities among genes and gene clusters which annotated by multiple DO terms were also calculated by these combine methods.\nDOSE implemented geneSim to measure semantic similarities among genes.\n\ng1 &lt;- c(\"84842\", \"2524\", \"10590\", \"3070\", \"91746\")\ng2 &lt;- c(\"84289\", \"6045\", \"56999\", \"9869\")\n\nDOSE::geneSim(g1[1], g2[1], measure=\"Wang\", combine=\"BMA\")\n\n[1] 0\n\ngs &lt;- DOSE::geneSim(g1, g2, measure=\"Wang\", combine=\"BMA\")\ngs\n\n      84289 6045 56999  9869\n84842 0.000  0.0 0.049 0.216\n2524  0.000  0.0 0.227 0.000\n10590    NA   NA    NA    NA\n3070  0.377  0.2 0.000 0.344\n91746    NA   NA    NA    NA\n\n\nThe geneSim requires four parameter geneID1, geneID2, measure and combine. geneID1 and geneID2 should be a vector of entrez gene IDs; measure should be one of Resnik, Jiang, Lin, Rel, and Wang, while combine should be one of max, avg, rcmax and BMA.",
    "crumbs": [
      "Semantic Similarity Analysis",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>DO semantic similarity analysis</span>"
    ]
  },
  {
    "objectID": "012-DOSE-semantic-similarity.html#gene-cluster-do-semantic-similarity",
    "href": "012-DOSE-semantic-similarity.html#gene-cluster-do-semantic-similarity",
    "title": "2¬† DO semantic similarity analysis",
    "section": "\n2.3 Gene cluster semantic similarity measurement",
    "text": "2.3 Gene cluster semantic similarity measurement\nDOSE also implemented clusterSim for calculating semantic similarity between two gene clusters and mclusterSim for calculating semantic similarities among multiple gene clusters.\n\nDOSE::clusterSim(g1, g2, measure=\"Wang\", combine=\"BMA\")\n\n[1] 0.338\n\n\n\ng3 &lt;- c(\"57491\", \"6296\", \"51438\", \"5504\", \"27319\", \"1643\")\nclusters &lt;- list(a=g1, b=g2, c=g3)\nDOSE::mclusterSim(clusters, measure=\"Wang\", combine=\"BMA\")\n\n      a     b     c\na 1.000 0.338 0.157\nb 0.338 1.000 0.034\nc 0.157 0.034 1.000",
    "crumbs": [
      "Semantic Similarity Analysis",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>DO semantic similarity analysis</span>"
    ]
  },
  {
    "objectID": "012-DOSE-semantic-similarity.html#references",
    "href": "012-DOSE-semantic-similarity.html#references",
    "title": "2¬† DO semantic similarity analysis",
    "section": "References",
    "text": "References\n\n\n\n\nJiang, Jay J., and David W. Conrath. 1997. ‚ÄúSemantic Similarity Based on Corpus Statistics and Lexical Taxonomy.‚Äù Proceedings of 10th International Conference on Research In Computational Linguistics. http://www.citebase.org/abstract?id=oai:arXiv.org:cmp-lg/9709008.\n\n\nLin, Dekang. 1998. ‚ÄúAn Information-Theoretic Definition of Similarity.‚Äù In Proceedings of the 15th International Conference on Machine Learning, 296‚Äî304. https://doi.org/10.1.1.55.1832.\n\n\nPhilip, Resnik. 1999. ‚ÄúSemantic Similarity in a Taxonomy: An Information-Based Measure and Its Application to Problems of Ambiguity in Natural Language.‚Äù Journal of Artificial Intelligence Research 11: 95‚Äì130.\n\n\nSchlicker, Andreas, Francisco S Domingues, J√∂rg Rahnenf√ºhrer, and Thomas Lengauer. 2006. ‚ÄúA New Measure for Functional Similarity of Gene Products Based on Gene Ontology.‚Äù BMC Bioinformatics 7: 302. https://doi.org/1471-2105-7-302.\n\n\nSchriml, L. M., C. Arze, S. Nadendla, Y.-W. W. Chang, M. Mazaitis, V. Felix, G. Feng, and W. A. Kibbe. 2011. ‚ÄúDisease Ontology: A Backbone for Disease Semantic Integration.‚Äù Nucleic Acids Research 40 (D1): D940‚Äì46. https://doi.org/10.1093/nar/gkr972.\n\n\nWang, James Z, Zhidian Du, Rapeeporn Payattakool, Philip S Yu, and Chin-Fu Chen. 2007. ‚ÄúA New Method to Measure the Semantic Similarity of GO Terms.‚Äù Bioinformatics (Oxford, England) 23 (May): 1274‚Äì81. https://doi.org/btm087.\n\n\nYu, Guangchuang, Li-Gen Wang, Guang-Rong Yan, and Qing-Yu He. 2015. ‚ÄúDOSE: An r/Bioconductor Package for Disease Ontology Semantic and Enrichment Analysis.‚Äù Bioinformatics 31 (4): 608‚Äì9. https://doi.org/10.1093/bioinformatics/btu684.",
    "crumbs": [
      "Semantic Similarity Analysis",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>DO semantic similarity analysis</span>"
    ]
  },
  {
    "objectID": "013-meshes-semantic-similarity.html",
    "href": "013-meshes-semantic-similarity.html",
    "title": "3¬† MeSH semantic similarity analysis",
    "section": "",
    "text": "3.1 Supported organisms\nMeSH (Medical Subject Headings) is the NLM (U.S. National Library of Medicine) controlled vocabulary used to manually index articles for MEDLINE/PubMed. MeSH is a comprehensive life science vocabulary. MeSH has 19 categories and MeSH.db contains 16 of them. That is:\nMeSH terms were associated with Entrez Gene ID by three methods, gendoo, gene2pubmed and RBBH (Reciprocal Blast Best Hit).\nThe meshes package (Yu 2018) relies on MeSHDb to prepare semantic data for measuring simiarlity. MeSHDb can be downloaded from AnnotationHub (see also AHMeSHDbs) and about 200 species are available and are supported by the meshes package.\nFirst, we need to load/fetch species-specific MeSH annotation database:\n#############################\n## BioC 2.14 to BioC 3.13  ##\n#############################\n##\n## library(MeSH.Hsa.eg.db)\n## db &lt;- MeSH.Hsa.eg.db\n##\n##---------------------------\n\n# From BioC 3.14 (Nov. 2021, with R-4.2.0)\nlibrary(AnnotationHub)\nlibrary(MeSHDbi)\nah &lt;- AnnotationHub(localHub=TRUE)\nhsa &lt;- query(ah, c(\"MeSHDb\", \"Homo sapiens\"))\nfile_hsa &lt;- hsa[[1]]\ndb &lt;- MeSHDbi::MeSHDb(file_hsa)\nThe semantic data can be prepared by the meshdata() function:\nlibrary(meshes)\nhsamd &lt;- meshdata(db, category='A', computeIC=T, database=\"gendoo\")\n\n## you may want to save the result for future usage\n# \n# save(hsamd, file = \"hsamd.rda\")\n#",
    "crumbs": [
      "Semantic Similarity Analysis",
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>MeSH semantic similarity analysis</span>"
    ]
  },
  {
    "objectID": "013-meshes-semantic-similarity.html#meshes-semantic-simiarlity",
    "href": "013-meshes-semantic-similarity.html#meshes-semantic-simiarlity",
    "title": "3¬† MeSH semantic similarity analysis",
    "section": "\n3.2 MeSH semantic similarity measurement",
    "text": "3.2 MeSH semantic similarity measurement\nThe meshes package (Yu 2018) implemented four IC-based methods (i.e.¬†Resnik (Philip 1999), Jiang (Jiang and Conrath 1997), Lin (Lin 1998) and Schlicker (Schlicker et al. 2006)) and one graph-structure based method (i.e.¬†Wang (Wang et al. 2007)), to measure MeSH term semantic similarity. For algorithm details, please refer to Chapter 1.\nThe meshSim() function is designed to measure semantic similarity between two MeSH term vectors.\n\nlibrary(meshes)\nmeshSim(\"D000009\", \"D009130\", semData=hsamd, measure=\"Resnik\")\n\n[1] 0.3847944\n\nmeshSim(\"D000009\", \"D009130\", semData=hsamd, measure=\"Rel\")\n\n[1] 0.633538\n\nmeshSim(\"D000009\", \"D009130\", semData=hsamd, measure=\"Jiang\")\n\n[1] 0.5587351\n\nmeshSim(\"D000009\", \"D009130\", semData=hsamd, measure=\"Wang\")\n\n[1] 0.5557103\n\nmeshSim(c(\"D001369\", \"D002462\"), c(\"D017629\", \"D002890\", \"D008928\"), semData=hsamd, measure=\"Wang\")\n\n          D017629   D002890   D008928\nD001369 0.2886598 0.1923711 0.2193326\nD002462 0.6521739 0.2381925 0.2809552",
    "crumbs": [
      "Semantic Similarity Analysis",
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>MeSH semantic similarity analysis</span>"
    ]
  },
  {
    "objectID": "013-meshes-semantic-similarity.html#gene-meshes-semantic-similarity",
    "href": "013-meshes-semantic-similarity.html#gene-meshes-semantic-similarity",
    "title": "3¬† MeSH semantic similarity analysis",
    "section": "\n3.3 Gene semantic similarity measurement",
    "text": "3.3 Gene semantic similarity measurement\nThe geneSim() function is designed to measure semantic similarity among two gene vectors.\n\ngeneSim(\"241\", \"251\", semData=hsamd, measure=\"Wang\", combine=\"BMA\")\n\n[1] 0.216\n\ngeneSim(c(\"241\", \"251\"), c(\"835\", \"5261\",\"241\", \"994\"), semData=hsamd, measure=\"Wang\", combine=\"BMA\")\n\n      835  5261   241   994\n241 0.353 0.143 1.000 0.262\n251 0.301 0.347 0.216 0.361",
    "crumbs": [
      "Semantic Similarity Analysis",
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>MeSH semantic similarity analysis</span>"
    ]
  },
  {
    "objectID": "013-meshes-semantic-similarity.html#references",
    "href": "013-meshes-semantic-similarity.html#references",
    "title": "3¬† MeSH semantic similarity analysis",
    "section": "References",
    "text": "References\n\n\n\n\nJiang, Jay J., and David W. Conrath. 1997. ‚ÄúSemantic Similarity Based on Corpus Statistics and Lexical Taxonomy.‚Äù Proceedings of 10th International Conference on Research In Computational Linguistics. http://www.citebase.org/abstract?id=oai:arXiv.org:cmp-lg/9709008.\n\n\nLin, Dekang. 1998. ‚ÄúAn Information-Theoretic Definition of Similarity.‚Äù In Proceedings of the 15th International Conference on Machine Learning, 296‚Äî304. https://doi.org/10.1.1.55.1832.\n\n\nPhilip, Resnik. 1999. ‚ÄúSemantic Similarity in a Taxonomy: An Information-Based Measure and Its Application to Problems of Ambiguity in Natural Language.‚Äù Journal of Artificial Intelligence Research 11: 95‚Äì130.\n\n\nSchlicker, Andreas, Francisco S Domingues, J√∂rg Rahnenf√ºhrer, and Thomas Lengauer. 2006. ‚ÄúA New Measure for Functional Similarity of Gene Products Based on Gene Ontology.‚Äù BMC Bioinformatics 7: 302. https://doi.org/1471-2105-7-302.\n\n\nWang, James Z, Zhidian Du, Rapeeporn Payattakool, Philip S Yu, and Chin-Fu Chen. 2007. ‚ÄúA New Method to Measure the Semantic Similarity of GO Terms.‚Äù Bioinformatics (Oxford, England) 23 (May): 1274‚Äì81. https://doi.org/btm087.\n\n\nYu, Guangchuang. 2018. ‚ÄúUsing Meshes for MeSH Term Enrichment and Semantic Analyses.‚Äù Bioinformatics 34 (21): 3766‚Äì67. https://doi.org/10.1093/bioinformatics/bty410.",
    "crumbs": [
      "Semantic Similarity Analysis",
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>MeSH semantic similarity analysis</span>"
    ]
  },
  {
    "objectID": "02-Enrichment.html",
    "href": "02-Enrichment.html",
    "title": "Enrichment Analysis",
    "section": "",
    "text": "Terminology",
    "crumbs": [
      "Enrichment Analysis"
    ]
  },
  {
    "objectID": "02-Enrichment.html#terminology",
    "href": "02-Enrichment.html#terminology",
    "title": "Enrichment Analysis",
    "section": "",
    "text": "Gene sets and pathway\nA gene set is an unordered collection of genes that are functionally related. A pathway can be interpreted as a gene set by ignoring functional relationships among genes.\nGene Ontology (GO)\nGene Ontology defines concepts/classes used to describe gene function, and relationships between these concepts. It classifies functions along three aspects:\n\nMF: Molecular Function\n\nmolecular activities of gene products\n\n\nCC: Cellular Component\n\nwhere gene products are active\n\n\nBP: Biological Process\n\npathways and larger processes made up of the activities of multiple gene products\n\n\n\nGO terms are organized in a directed acyclic graph, where edges between terms represent parent-child relationship.\nKyoto Encyclopedia of Genes and Genomes (KEGG)\nKEGG is a collection of manually drawn pathway maps representing molecular interaction and reaction networks. These pathways cover a wide range of biochemical processes that can be divided into 7 broad categories:\n\nMetabolism\nGenetic information processing\nEnvironmental information processing\nCellular processes\nOrganismal systems\nHuman diseases\nDrug development.\n\nOther gene sets\nGO and KEGG are the most frequently used for functional analysis. They are typically the first choice because of their long-standing curation and availability for a wide range of species.\nOther gene sets include but are not limited to Disease Ontology (DO), Disease Gene Network (DisGeNET), wikiPathways, Molecular Signatures Database (MSigDb).",
    "crumbs": [
      "Enrichment Analysis"
    ]
  },
  {
    "objectID": "02-Enrichment.html#ora-algorithm",
    "href": "02-Enrichment.html#ora-algorithm",
    "title": "Enrichment Analysis",
    "section": "Over Representation Analysis",
    "text": "Over Representation Analysis\nOver Representation Analysis (ORA) (Boyle et al. 2004) is a widely used approach to determine whether known biological functions or processes are over-represented (= enriched) in an experimentally-derived gene list, e.g. a list of differentially expressed genes (DEGs).\nThe p-value can be calculated by hypergeometric distribution.\n\\(p = 1 - \\displaystyle\\sum_{i = 0}^{k-1}\\frac{{M \\choose i}{{N-M} \\choose {n-i}}} {{N \\choose n}}\\)\nIn this equation, N is the total number of genes in the background distribution, M is the number of genes within that distribution that are annotated (either directly or indirectly) to the gene set of interest, n is the size of the list of genes of interest and k is the number of genes within that list which are annotated to the gene set. The background distribution by default is all the genes that have annotation. P-values should be adjusted for multiple comparison.\nExample: Suppose we have 17,980 genes detected in a Microarray study and 57 genes were differentially expressed. From these, 2641 are annotated to gene set of interest. Among the differentially expressed genes, 28 belong to the gene set1.\n\nd &lt;- data.frame(non_DE_gene=c(2613, 15310), DE_gene=c(28, 29))\nrow.names(d) &lt;- c(\"In_category\", \"not_in_category\")\nd\n\n                non_DE_gene DE_gene\nIn_category            2613      28\nnot_in_category       15310      29\n\n\nWhether the gene set of interest is significantly over represented in the differentially expressed genes can be assessed using a hypergeometric distribution. This corresponds to a one-sided version of Fisher‚Äôs exact test.\n\nfisher.test(d, alternative = \"greater\")\n\n\n    Fisher's Exact Test for Count Data\n\ndata:  d\np-value = 1\nalternative hypothesis: true odds ratio is greater than 1\n95 percent confidence interval:\n 0.110242      Inf\nsample estimates:\nodds ratio \n 0.1767937",
    "crumbs": [
      "Enrichment Analysis"
    ]
  },
  {
    "objectID": "02-Enrichment.html#gsea-algorithm",
    "href": "02-Enrichment.html#gsea-algorithm",
    "title": "Enrichment Analysis",
    "section": "Gene Set Enrichment Analysis",
    "text": "Gene Set Enrichment Analysis\nA common approach to analyzing gene expression profiles is identifying differentially expressed genes that are deemed interesting. The ORA enrichment analysis is based on these differentially expressed genes. This approach will find genes where the difference is large and will fail where the difference is small, but evidenced in coordinated way in a set of related genes. Gene Set Enrichment Analysis (GSEA)(Subramanian et al. 2005) directly addresses this limitation. All genes can be used in GSEA; GSEA aggregates the per gene statistics across genes within a gene set, therefore making it possible to detect situations where all genes in a predefined set change in a small but coordinated way. This is important since it is likely that many relevant phenotypic differences are manifested by small but consistent changes in a set of genes.\nGenes are ranked based on their phenotypes. Given apriori defined set of gene S (e.g., genes sharing the same DO category), the goal of GSEA is to determine whether the members of S are randomly distributed throughout the ranked gene list (L) or primarily found at the top or bottom.\nThere are three key elements of the GSEA method:\n\nCalculation of an Enrichment Score.\n\nThe enrichment score (ES) represents the degree to which a set S is over-represented at the top or bottom of the ranked list L. The score is calculated by walking down the list L, increasing a running-sum statistic when we encounter a gene in S and decreasing when it is not encountered. The magnitude of the increment depends on the gene statistics (e.g., correlation of the gene with phenotype). The ES is the maximum deviation from zero encountered in the random walk; it corresponds to a weighted Kolmogorov-Smirnov(KS)-like statistic (Subramanian et al. 2005).\n\n\nEsimation of Significance Level of ES.\n\nThe p-value of the ES is calculated using a permutation test. Specifically, we permute the gene labels of the gene list L and recompute the ES of the gene set for the permutated data, which generate a null distribution for the ES. The p-value of the observed ES is then calculated relative to this null distribution.\n\n\nAdjustment for Multiple Hypothesis Testing.\n\nWhen the entire gene sets are evaluated, the estimated significance level is adjusted to account for multiple hypothesis testing and also q-values are calculated for FDR control.\n\n\n\nWe implemented the GSEA algorithm proposed by Subramanian (Subramanian et al. 2005). Alexey Sergushichev implemented an algorithm for fast GSEA calculation in the fgsea (Korotkevich, Sukhov, and Sergushichev 2019) package. In our packages (clusterProfiler, DOSE, meshes and ReactomePA), users can use the GSEA algorithm implemented in DOSE or fgsea by specifying the parameter by=\"DOSE\" or by=\"fgsea\". By default, the fgsea method will be used since it is much more faster.",
    "crumbs": [
      "Enrichment Analysis"
    ]
  },
  {
    "objectID": "02-Enrichment.html#leading-edge-analysis-and-core-enriched-genes",
    "href": "02-Enrichment.html#leading-edge-analysis-and-core-enriched-genes",
    "title": "Enrichment Analysis",
    "section": "Leading edge analysis and core enriched genes",
    "text": "Leading edge analysis and core enriched genes\nLeading edge analysis reports Tags to indicate the percentage of genes contributing to the enrichment score, List to indicate where in the list the enrichment score is attained and Signal for enrichment signal strength.\nIt would also be very interesting to get the core enriched genes that contribute to the enrichment. Our packages (clusterProfiler, DOSE, meshes and ReactomePA) support leading edge analysis and report core enriched genes in GSEA analysis.",
    "crumbs": [
      "Enrichment Analysis"
    ]
  },
  {
    "objectID": "02-Enrichment.html#references",
    "href": "02-Enrichment.html#references",
    "title": "Enrichment Analysis",
    "section": "References",
    "text": "References\n\n\n\n\nBoyle, Elizabeth I, Shuai Weng, Jeremy Gollub, Heng Jin, David Botstein, J Michael Cherry, and Gavin Sherlock. 2004. ‚ÄúGO::TermFinder‚Äìopen Source Software for Accessing Gene Ontology Information and Finding Significantly Enriched Gene Ontology Terms Associated with a List of Genes.‚Äù Bioinformatics (Oxford, England) 20 (18): 3710‚Äì15. https://doi.org/10.1093/bioinformatics/bth456.\n\n\nKorotkevich, Gennady, Vladimir Sukhov, and Alexey Sergushichev. 2019. ‚ÄúFast Gene Set Enrichment Analysis.‚Äù bioRxiv, October, 060012. https://doi.org/10.1101/060012.\n\n\nSubramanian, Aravind, Pablo Tamayo, Vamsi K. Mootha, Sayan Mukherjee, Benjamin L. Ebert, Michael A. Gillette, Amanda Paulovich, et al. 2005. ‚ÄúGene Set Enrichment Analysis: A Knowledge-Based Approach for Interpreting Genome-Wide Expression Profiles.‚Äù Proceedings of the National Academy of Sciences of the United States of America 102 (43): 15545‚Äì50. https://doi.org/10.1073/pnas.0506580102.",
    "crumbs": [
      "Enrichment Analysis"
    ]
  },
  {
    "objectID": "02-Enrichment.html#footnotes",
    "href": "02-Enrichment.html#footnotes",
    "title": "Enrichment Analysis",
    "section": "",
    "text": "example adopted from https://guangchuangyu.github.io/2012/04/enrichment-analysis/‚Ü©Ô∏é",
    "crumbs": [
      "Enrichment Analysis"
    ]
  },
  {
    "objectID": "021-go.html",
    "href": "021-go.html",
    "title": "4¬† GO enrichment analysis",
    "section": "",
    "text": "4.1 Supported organisms\nGO comprises three orthogonal ontologies, i.e.¬†molecular function (MF), biological process (BP), and cellular component (CC).\nGO analyses (groupGO(), enrichGO() and gseGO()) support organisms that have an OrgDb object available (see also session 2.2).\nIf a user has GO annotation data (in a data.frame format with the first column as gene ID and the second column as GO ID), they can use the enricher() and GSEA() functions to perform an over-representation test and gene set enrichment analysis.\nIf the genes are annotated by direction annotation, they should also be annotated by their ancestor GO nodes (indirect annotation). If a user only has direct annotation, they can pass their annotation to the buildGOmap function, which will infer indirect annotation and generate a data.frame that is suitable for both enricher() and GSEA().",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>GO enrichment analysis</span>"
    ]
  },
  {
    "objectID": "021-go.html#go-classification",
    "href": "021-go.html#go-classification",
    "title": "4¬† GO enrichment analysis",
    "section": "\n4.2 GO classification",
    "text": "4.2 GO classification\nIn clusterProfiler, the groupGO() function is designed for gene classification based on GO distribution at a specific level. Here we use the dataset geneList provided by DOSE.\n\nlibrary(clusterProfiler)\nlibrary(org.Hs.eg.db)\n\ndata(geneList, package=\"DOSE\")\ngene &lt;- names(geneList)[abs(geneList) &gt; 2]\n\n# Entrez gene ID\nhead(gene)\n\n[1] \"4312\"  \"8318\"  \"10874\" \"55143\" \"55388\" \"991\"  \n\nggo &lt;- groupGO(gene     = gene,\n               OrgDb    = org.Hs.eg.db,\n               ont      = \"CC\",\n               level    = 3,\n               readable = TRUE)\n\nhead(ggo)\n\n                   ID                Description Count GeneRatio      geneID\nGO:0000133 GO:0000133                 polarisome     0     0/207            \nGO:0000417 GO:0000417                HIR complex     0     0/207            \nGO:0000796 GO:0000796          condensin complex     2     2/207 NCAPH/NCAPG\nGO:0000808 GO:0000808 origin recognition complex     0     0/207            \nGO:0000930 GO:0000930      gamma-tubulin complex     0     0/207            \nGO:0000939 GO:0000939          inner kinetochore     2     2/207 CENPM/CENPN\n\n\nThe gene parameter is a vector of gene IDs (can be any ID type that is supported by the corresponding OrgDb, see also session 16.1). If readable is set to TRUE, the input gene IDs will be converted to gene symbols.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>GO enrichment analysis</span>"
    ]
  },
  {
    "objectID": "021-go.html#clusterprofiler-go-ora",
    "href": "021-go.html#clusterprofiler-go-ora",
    "title": "4¬† GO enrichment analysis",
    "section": "\n4.3 GO over-representation analysis",
    "text": "4.3 GO over-representation analysis\nThe clusterProfiler package implements enrichGO() for gene ontology over-representation test.\n\nego &lt;- enrichGO(gene          = gene,\n                universe      = names(geneList),\n                OrgDb         = org.Hs.eg.db,\n                ont           = \"CC\",\n                pAdjustMethod = \"BH\",\n                pvalueCutoff  = 0.01,\n                qvalueCutoff  = 0.05,\n        readable      = TRUE)\nhead(ego)\n\n                   ID                              Description GeneRatio\nGO:0072686 GO:0072686                          mitotic spindle    20/201\nGO:0000775 GO:0000775           chromosome, centromeric region    21/201\nGO:0005819 GO:0005819                                  spindle    27/201\nGO:0000779 GO:0000779 condensed chromosome, centromeric region    18/201\nGO:0000793 GO:0000793                     condensed chromosome    21/201\nGO:0000776 GO:0000776                              kinetochore    17/201\n             BgRatio RichFactor FoldEnrichment    zScore       pvalue\nGO:0072686 160/11898 0.12500000       7.399254 10.682473 2.532128e-12\nGO:0000775 202/11898 0.10396040       6.153835  9.684273 2.545942e-11\nGO:0005819 352/11898 0.07670455       4.540451  8.838808 4.104222e-11\nGO:0000779 149/11898 0.12080537       7.150957  9.904096 5.917376e-11\nGO:0000793 222/11898 0.09459459       5.599435  9.068041 1.523011e-10\nGO:0000776 139/11898 0.12230216       7.239558  9.699638 1.695228e-10\n               p.adjust       qvalue\nGO:0072686 7.292528e-10 6.690148e-10\nGO:0000775 3.666156e-09 3.363323e-09\nGO:0005819 3.940054e-09 3.614596e-09\nGO:0000779 4.260511e-09 3.908583e-09\nGO:0000793 8.137092e-09 7.464950e-09\nGO:0000776 8.137092e-09 7.464950e-09\n                                                                                                                                                                     geneID\nGO:0072686                                        KIF23/CENPE/ASPM/DLGAP5/SKA1/NUSAP1/TPX2/TACC3/CDK1/MAD2L1/KIF18A/KIF11/TRAT1/AURKB/PRC1/KIFC1/KIF18B/KIF20A/AURKA/DNALI1\nGO:0000775                                       CDCA8/CDC20/CENPE/NDC80/TOP2A/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/CDT1/BIRC5/EZH2/TTK/NCAPG/AURKB/AURKA/CCNB1\nGO:0005819 CDCA8/CDC20/KIF23/CENPE/ASPM/DLGAP5/SKA1/NUSAP1/TPX2/TACC3/NEK2/CDK1/MAD2L1/KIF18A/BIRC5/KIF11/TRAT1/TTK/AURKB/PRC1/KIFC1/KIF18B/KIF20A/AURKA/CCNB1/KIF4A/DNALI1\nGO:0000779                                                        CDC20/CENPE/NDC80/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/CDT1/BIRC5/TTK/NCAPG/AURKB/AURKA/CCNB1\nGO:0000793                                      CDC20/CENPE/NDC80/TOP2A/NCAPH/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/CDT1/BIRC5/TTK/NCAPG/AURKB/CHEK1/AURKA/CCNB1\nGO:0000776                                                              CDC20/CENPE/NDC80/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/CDT1/BIRC5/TTK/AURKB/AURKA/CCNB1\n           Count\nGO:0072686    20\nGO:0000775    21\nGO:0005819    27\nGO:0000779    18\nGO:0000793    21\nGO:0000776    17\n\n\nAny gene ID type that is supported in OrgDb can be directly used in GO analyses. Users need to specify the keyType parameter to specify the input gene ID type.\n\ngene.df &lt;- bitr(gene, fromType = \"ENTREZID\",\n        toType = c(\"ENSEMBL\", \"SYMBOL\"),\n        OrgDb = org.Hs.eg.db)\n\nego2 &lt;- enrichGO(gene         = gene.df$ENSEMBL,\n                OrgDb         = org.Hs.eg.db,\n                keyType       = 'ENSEMBL',\n                ont           = \"CC\",\n                pAdjustMethod = \"BH\",\n                pvalueCutoff  = 0.01,\n                qvalueCutoff  = 0.05)\nhead(ego2, 3)                \n\n                   ID                              Description GeneRatio\nGO:0072686 GO:0072686                          mitotic spindle    24/237\nGO:0005819 GO:0005819                                  spindle    31/237\nGO:0000779 GO:0000779 condensed chromosome, centromeric region    20/237\n             BgRatio RichFactor FoldEnrichment   zScore       pvalue\nGO:0072686 221/22665 0.10859729      10.385475 14.41284 1.199753e-17\nGO:0005819 496/22665 0.06250000       5.977057 11.52093 1.398262e-15\nGO:0000779 201/22665 0.09950249       9.515713 12.46587 3.670045e-14\n               p.adjust       qvalue\nGO:0072686 3.203340e-15 2.437393e-15\nGO:0005819 1.866679e-13 1.420339e-13\nGO:0000779 2.986106e-12 2.272101e-12\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    geneID\nGO:0072686                                                                                                                 ENSG00000137807/ENSG00000138778/ENSG00000066279/ENSG00000126787/ENSG00000154839/ENSG00000262634/ENSG00000137804/ENSG00000088325/ENSG00000013810/ENSG00000170312/ENSG00000164109/ENSG00000121621/ENSG00000138160/ENSG00000163519/ENSG00000178999/ENSG00000198901/ENSG00000237649/ENSG00000233450/ENSG00000056678/ENSG00000204197/ENSG00000186185/ENSG00000112984/ENSG00000087586/ENSG00000163879\nGO:0005819 ENSG00000134690/ENSG00000117399/ENSG00000137807/ENSG00000138778/ENSG00000066279/ENSG00000126787/ENSG00000154839/ENSG00000262634/ENSG00000137804/ENSG00000088325/ENSG00000013810/ENSG00000117650/ENSG00000170312/ENSG00000164109/ENSG00000121621/ENSG00000089685/ENSG00000138160/ENSG00000163519/ENSG00000112742/ENSG00000178999/ENSG00000198901/ENSG00000237649/ENSG00000233450/ENSG00000056678/ENSG00000204197/ENSG00000186185/ENSG00000112984/ENSG00000087586/ENSG00000134057/ENSG00000090889/ENSG00000163879\nGO:0000779                                                                                                                                                                                 ENSG00000117399/ENSG00000138778/ENSG00000080986/ENSG00000123485/ENSG00000154839/ENSG00000262634/ENSG00000117650/ENSG00000100162/ENSG00000166451/ENSG00000291964/ENSG00000186871/ENSG00000164109/ENSG00000121621/ENSG00000167513/ENSG00000089685/ENSG00000112742/ENSG00000109805/ENSG00000178999/ENSG00000087586/ENSG00000134057\n           Count\nGO:0072686    24\nGO:0005819    31\nGO:0000779    20\n\n\nGene IDs can be mapped to gene Symbols by using the parameter readable=TRUE or setReadable() function.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>GO enrichment analysis</span>"
    ]
  },
  {
    "objectID": "021-go.html#go-gene-set-enrichment-analysis",
    "href": "021-go.html#go-gene-set-enrichment-analysis",
    "title": "4¬† GO enrichment analysis",
    "section": "\n4.4 GO Gene Set Enrichment Analysis",
    "text": "4.4 GO Gene Set Enrichment Analysis\nThe clusterProfiler package provides the gseGO() function for gene set enrichment analysis using gene ontology.\n\nego3 &lt;- gseGO(geneList     = geneList,\n              OrgDb        = org.Hs.eg.db,\n              ont          = \"CC\",\n              minGSSize    = 100,\n              maxGSSize    = 500,\n              pvalueCutoff = 0.05,\n              verbose      = FALSE)\n\nThe format of input data, geneList, was documented in the FAQ. Beware that only gene Set size in [minGSSize, maxGSSize] will be tested.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>GO enrichment analysis</span>"
    ]
  },
  {
    "objectID": "021-go.html#clusterprofiler-go-non-model",
    "href": "021-go.html#clusterprofiler-go-non-model",
    "title": "4¬† GO enrichment analysis",
    "section": "\n4.5 GO analysis for non-model organisms",
    "text": "4.5 GO analysis for non-model organisms\nBoth the enrichGO() and gseGO() functions require an OrgDb object as the background annotation. For organisms that don‚Äôt have OrgDb provided by Bioconductor, users can query one (if available) online via AnnotationHub. If there is no OrgDb available, users can obtain GO annotation from other sources, e.g.¬†from biomaRt, or annotate the genes using Blast2GO or the Trinotate pipeline. Then the enricher() or GSEA() functions can be used to perform GO analysis for these organisms, similar to the examples using wikiPathways and MSigDB. Another solution is to create an OrgDb on your own using AnnotationForge package.\nHere is an example of querying GO annotation from Ensembl using biomaRt.\n\nlibrary(biomaRt)\nensembl &lt;- useEnsemblGenomes(biomart = \"plants_mart\", dataset = \"nattenuata_eg_gene\")\ngene2go &lt;- getBM(attributes =c(\"ensembl_gene_id\", \"go_id\"), mart=ensembl)",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>GO enrichment analysis</span>"
    ]
  },
  {
    "objectID": "021-go.html#visualize-enriched-go-terms-as-a-directed-acyclic-graph",
    "href": "021-go.html#visualize-enriched-go-terms-as-a-directed-acyclic-graph",
    "title": "4¬† GO enrichment analysis",
    "section": "\n4.6 Visualize enriched GO terms as a directed acyclic graph",
    "text": "4.6 Visualize enriched GO terms as a directed acyclic graph\nThe goplot() function can accept the output of enrichGO and visualize the enriched GO induced graph.\n(ref:goplotscap) Goplot of enrichment analysis.\n(ref:goplotcap) Goplot of enrichment analysis.\n\ngoplot(ego)\n\n\n\n(ref:goplotcap)",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>GO enrichment analysis</span>"
    ]
  },
  {
    "objectID": "021-go.html#clusterprofiler-go-summary",
    "href": "021-go.html#clusterprofiler-go-summary",
    "title": "4¬† GO enrichment analysis",
    "section": "\n4.7 Summary",
    "text": "4.7 Summary\nGO semantic similarity can be calculated by GOSemSim (Yu et al. 2010). We can use it to cluster genes/proteins into different clusters based on their functional similarity and can also use it to measure the similarities among GO terms to reduce the redundancy of GO enrichment results.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>GO enrichment analysis</span>"
    ]
  },
  {
    "objectID": "021-go.html#references",
    "href": "021-go.html#references",
    "title": "4¬† GO enrichment analysis",
    "section": "References",
    "text": "References\n\n\n\n\nYu, Guangchuang, Fei Li, Yide Qin, Xiaochen Bo, Yibo Wu, and Shengqi Wang. 2010. ‚ÄúGOSemSim: An r Package for Measuring Semantic Similarity Among GO Terms and Gene Products.‚Äù Bioinformatics 26 (7): 976‚Äì78. https://doi.org/10.1093/bioinformatics/btq064.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>GO enrichment analysis</span>"
    ]
  },
  {
    "objectID": "022-kegg.html",
    "href": "022-kegg.html",
    "title": "5¬† KEGG enrichment analysis",
    "section": "",
    "text": "5.1 Supported organisms\nThe KEGG FTP service is not freely available for academic use since 2012, and there are many software packages using out-dated KEGG annotation data. The clusterProfiler package supports downloading the latest online version of KEGG data using the KEGG website, which is freely available for academic users. Both the KEGG pathway and module are supported in clusterProfiler.\nThe clusterProfiler package supports all organisms that have KEGG annotation data available in the KEGG database. Users should pass an abbreviation of academic name to the organism parameter. The full list of KEGG supported organisms can be accessed via http://www.genome.jp/kegg/catalog/org_list.html. KEGG Orthology (KO) Database is also supported by specifying organism = \"ko\".\nThe clusterProfiler package provides search_kegg_organism() function to help searching supported organisms.\nlibrary(clusterProfiler)\nsearch_kegg_organism('ece', by='kegg_code')\n\n     kegg_code                 scientific_name          common_name\n1259       ece Escherichia coli O157:H7 EDL933                 EHEC\n8132      ecec            Enterococcus cecorum Enterococcus cecorum\n\necoli &lt;- search_kegg_organism('Escherichia coli', by='scientific_name')\ndim(ecoli)\n\n[1] 66  3\n\nhead(ecoli)\n\n     kegg_code              scientific_name                  common_name\n1253       eco Escherichia coli K-12 MG1655 Escherichia coli K-12 MG1655\n1254       ecj  Escherichia coli K-12 W3110  Escherichia coli K-12 W3110\n1255       ecd  Escherichia coli K-12 DH10B  Escherichia coli K-12 DH10B\n1256       ebw Escherichia coli K-12 BW2952 Escherichia coli K-12 BW2952\n1257      ecok  Escherichia coli K-12 MDS42  Escherichia coli K-12 MDS42\n1258      ecoc  Escherichia coli K-12 C3026  Escherichia coli K-12 C3026",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>KEGG enrichment analysis</span>"
    ]
  },
  {
    "objectID": "022-kegg.html#clusterprofiler-kegg-pathway-ora",
    "href": "022-kegg.html#clusterprofiler-kegg-pathway-ora",
    "title": "5¬† KEGG enrichment analysis",
    "section": "\n5.2 KEGG pathway over-representation analysis",
    "text": "5.2 KEGG pathway over-representation analysis\n\ndata(geneList, package=\"DOSE\")\ngene &lt;- names(geneList)[abs(geneList) &gt; 2]\n\nkk &lt;- enrichKEGG(gene         = gene,\n                 organism     = 'hsa',\n                 pvalueCutoff = 0.05)\nhead(kk)\n\n                                     category\nhsa04110                   Cellular Processes\nhsa04114                   Cellular Processes\nhsa04218                   Cellular Processes\nhsa04061 Environmental Information Processing\nhsa03320                   Organismal Systems\nhsa04814                   Cellular Processes\n                                 subcategory       ID\nhsa04110               Cell growth and death hsa04110\nhsa04114               Cell growth and death hsa04114\nhsa04218               Cell growth and death hsa04218\nhsa04061 Signaling molecules and interaction hsa04061\nhsa03320                    Endocrine system hsa03320\nhsa04814                       Cell motility hsa04814\n                                                           Description\nhsa04110                                                    Cell cycle\nhsa04114                                                Oocyte meiosis\nhsa04218                                           Cellular senescence\nhsa04061 Viral protein interaction with cytokine and cytokine receptor\nhsa03320                                        PPAR signaling pathway\nhsa04814                                                Motor proteins\n         GeneRatio  BgRatio RichFactor FoldEnrichment    zScore       pvalue\nhsa04110    15/107 158/9500 0.09493671       8.428960 10.049983 2.130809e-10\nhsa04114    10/107 139/9500 0.07194245       6.387413  6.828971 3.414945e-06\nhsa04218    10/107 157/9500 0.06369427       5.655099  6.277174 1.013937e-05\nhsa04061     8/107 100/9500 0.08000000       7.102804  6.547781 1.571178e-05\nhsa03320     7/107  76/9500 0.09210526       8.177570  6.704946 2.179422e-05\nhsa04814    10/107 197/9500 0.05076142       4.506855  5.308455 7.170565e-05\n             p.adjust       qvalue\nhsa04110 4.687780e-08 4.553202e-08\nhsa04114 3.756439e-04 3.648599e-04\nhsa04218 7.435539e-04 7.222078e-04\nhsa04061 8.641481e-04 8.393400e-04\nhsa03320 9.589457e-04 9.314162e-04\nhsa04814 2.629207e-03 2.553728e-03\n                                                                           geneID\nhsa04110 8318/991/9133/10403/890/983/4085/81620/7272/9212/1111/9319/891/4174/9232\nhsa04114                          991/9133/983/4085/51806/6790/891/9232/3708/5241\nhsa04218                           2305/4605/9133/890/983/51806/1111/891/776/3708\nhsa04061                                 3627/10563/6373/4283/6362/6355/9547/1524\nhsa03320                                       4312/9415/9370/5105/2167/3158/5346\nhsa04814                   9493/1062/81930/3832/3833/146909/10112/24137/4629/7802\n         Count\nhsa04110    15\nhsa04114    10\nhsa04218    10\nhsa04061     8\nhsa03320     7\nhsa04814    10\n\n\nInput ID type can be kegg, ncbi-geneid, ncbi-proteinid or uniprot (see also session 16.1.2). Unlike enrichGO(), there is no readable parameter for enrichKEGG(). However, users can use the setReadable() function if there is an OrgDb available for the species.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>KEGG enrichment analysis</span>"
    ]
  },
  {
    "objectID": "022-kegg.html#clusterprofiler-kegg-pathway-gsea",
    "href": "022-kegg.html#clusterprofiler-kegg-pathway-gsea",
    "title": "5¬† KEGG enrichment analysis",
    "section": "\n5.3 KEGG pathway gene set enrichment analysis",
    "text": "5.3 KEGG pathway gene set enrichment analysis\n\nkk2 &lt;- gseKEGG(geneList     = geneList,\n               organism     = 'hsa',\n               minGSSize    = 120,\n               pvalueCutoff = 0.05,\n               verbose      = FALSE)\nhead(kk2)\n\n               ID                             Description setSize\nhsa04110 hsa04110                              Cell cycle     139\nhsa05169 hsa05169            Epstein-Barr virus infection     195\nhsa04613 hsa04613 Neutrophil extracellular trap formation     130\nhsa05166 hsa05166 Human T-cell leukemia virus 1 infection     203\nhsa04510 hsa04510                          Focal adhesion     191\nhsa04218 hsa04218                     Cellular senescence     141\n         enrichmentScore       NES       pvalue     p.adjust       qvalue rank\nhsa04110       0.6637551  2.836593 1.000000e-10 8.600000e-09 5.684211e-09 1155\nhsa05169       0.4335116  1.922965 1.338944e-07 5.757461e-06 3.805421e-06 2820\nhsa04613       0.4496569  1.899232 5.703907e-06 1.635120e-04 1.080740e-04 2575\nhsa05166       0.3882567  1.740874 9.483009e-06 2.038847e-04 1.347585e-04 1955\nhsa04510      -0.4199193 -1.723726 2.880366e-05 4.954229e-04 3.274521e-04 2183\nhsa04218       0.4115945  1.761108 5.896362e-05 8.451453e-04 5.586027e-04 1155\n                           leading_edge\nhsa04110  tags=36%, list=9%, signal=33%\nhsa05169 tags=39%, list=23%, signal=31%\nhsa04613 tags=37%, list=21%, signal=30%\nhsa05166 tags=26%, list=16%, signal=22%\nhsa04510 tags=27%, list=17%, signal=23%\nhsa04218  tags=17%, list=9%, signal=16%\n                                                                                                                                                                                                                                                                                                                                                                                     core_enrichment\nhsa04110                                                                                                                                        8318/991/9133/10403/890/983/4085/81620/7272/9212/1111/9319/891/4174/9232/4171/993/990/5347/701/9700/898/23594/4998/9134/4175/4173/10926/6502/994/699/4609/5111/26271/1869/1029/8317/4176/2810/3066/1871/1031/9088/995/1019/4172/5885/11200/7027/1875\nhsa05169 3627/890/6890/9636/898/9134/6502/6772/3126/3112/4609/917/5709/1869/3654/919/915/4067/4938/864/4940/5713/5336/11047/3066/54205/1871/578/1019/637/916/3383/4939/10213/23586/4793/5603/7979/7128/6891/930/5714/3452/6850/5702/4794/7124/3569/7097/5708/2208/8772/3119/5704/7186/5971/3135/1380/958/5610/55080/4792/10018/8819/3134/10379/9641/1147/5718/6300/3109/811/5606/2923/3108/5707/1432\nhsa04613                                                                                                                                            820/366/51311/64581/3015/85236/55506/8970/8357/1535/2359/5336/4688/92815/3066/8336/292/1991/3689/8345/5603/4689/5880/10105/1184/6404/3018/6850/5604/3014/7097/1378/8290/1536/834/5605/1183/728/2215/8335/5594/9734/3674/5578/5582/7417/8331/6300\nhsa05166                                                                                                                            991/9133/890/4085/7850/1111/9232/8061/701/9700/898/4316/9134/3932/3559/3126/3112/4609/3561/917/1869/1029/915/114/2005/5902/55697/1871/1031/2224/292/1019/3689/916/3383/11200/706/3600/6513/3601/468/5604/7124/1030/3569/4049/4055/10393/3119/5901/5971/1959/3135\nhsa04510                                                                                                                    5595/5228/7424/1499/4636/83660/2013/7059/5295/1288/23396/3910/3371/3082/1291/394/3791/7450/596/3685/1280/3675/595/3912/1793/2012/1278/1277/1293/10398/55742/2317/7058/25759/56034/3693/3480/5159/857/1292/3908/3909/63923/3913/1287/3679/7060/3479/10451/80310/1311/1101\nhsa04218                                                                                                                                                                                                                                                                       2305/4605/9133/890/983/51806/1111/891/993/3576/1978/898/9134/4609/1869/1029/22808/1871/5499/91860/292/1019/11200/1875",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>KEGG enrichment analysis</span>"
    ]
  },
  {
    "objectID": "022-kegg.html#clusterprofiler-kegg-module-ora",
    "href": "022-kegg.html#clusterprofiler-kegg-module-ora",
    "title": "5¬† KEGG enrichment analysis",
    "section": "\n5.4 KEGG module over-representation analysis",
    "text": "5.4 KEGG module over-representation analysis\nKEGG Module is a collection of manually defined function units. In some situation, KEGG Modules have a more straightforward interpretation.\n\nmkk &lt;- enrichMKEGG(gene = gene,\n                   organism = 'hsa',\n                   pvalueCutoff = 1,\n                   qvalueCutoff = 1)\nhead(mkk)                   \n\n           ID\nM00912 M00912\nM00095 M00095\nM00053 M00053\nM00938 M00938\nM00003 M00003\nM00049 M00049\n                                                                    Description\nM00912                       NAD biosynthesis, tryptophan =&gt; quinolinate =&gt; NAD\nM00095                           C5 isoprenoid biosynthesis, mevalonate pathway\nM00053 Deoxyribonucleotide biosynthesis, ADP/GDP/CDP/UDP =&gt; dATP/dGTP/dCTP/dUTP\nM00938                 Pyrimidine deoxyribonucleotide biosynthesis, UDP =&gt; dTTP\nM00003                             Gluconeogenesis, oxaloacetate =&gt; fructose-6P\nM00049                      Adenine ribonucleotide biosynthesis, IMP =&gt; ADP,ATP\n       GeneRatio BgRatio RichFactor FoldEnrichment   zScore      pvalue\nM00912       2/9  12/833 0.16666667      15.425926 5.257534 0.006480816\nM00095       1/9  10/833 0.10000000       9.255556 2.743252 0.103471964\nM00053       1/9  11/833 0.09090909       8.414141 2.585477 0.113276038\nM00938       1/9  14/833 0.07142857       6.611111 2.211517 0.142119005\nM00003       1/9  18/833 0.05555556       5.141975 1.855600 0.179278025\nM00049       1/9  19/833 0.05263158       4.871345 1.782977 0.188341212\n        p.adjust     qvalue     geneID Count\nM00912 0.0388849 0.03410956 23475/3620     2\nM00095 0.1883412 0.16521159       3158     1\nM00053 0.1883412 0.16521159       6241     1\nM00938 0.1883412 0.16521159       6241     1\nM00003 0.1883412 0.16521159       5105     1\nM00049 0.1883412 0.16521159      26289     1",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>KEGG enrichment analysis</span>"
    ]
  },
  {
    "objectID": "022-kegg.html#clusterprofiler-kegg-module-gsea",
    "href": "022-kegg.html#clusterprofiler-kegg-module-gsea",
    "title": "5¬† KEGG enrichment analysis",
    "section": "\n5.5 KEGG module gene set enrichment analysis",
    "text": "5.5 KEGG module gene set enrichment analysis\n\nmkk2 &lt;- gseMKEGG(geneList = geneList,\n                 organism = 'hsa',\n                 pvalueCutoff = 1)\nhead(mkk2)\n\n           ID                                               Description setSize\nM00001 M00001 Glycolysis (Embden-Meyerhof pathway), glucose =&gt; pyruvate      24\nM00938 M00938  Pyrimidine deoxyribonucleotide biosynthesis, UDP =&gt; dTTP      10\nM00002 M00002  Glycolysis, core module involving three-carbon compounds      11\nM00035 M00035                                    Methionine degradation      11\nM00009 M00009                    Citrate cycle (TCA cycle, Krebs cycle)      22\nM00101 M00101              Cholesterol biosynthesis, FPP =&gt; cholesterol      12\n       enrichmentScore      NES      pvalue  p.adjust    qvalue rank\nM00001       0.5739036 1.751541 0.009216818 0.2765045 0.2619517 2886\nM00938       0.6648004 1.575131 0.032927072 0.3559954 0.3372588  648\nM00002       0.6421781 1.562671 0.035599545 0.3559954 0.3372588 1381\nM00035       0.5824213 1.417259 0.094252874 0.6698337 0.6345793 1555\nM00009       0.4504911 1.331955 0.111638955 0.6698337 0.6345793 3514\nM00101       0.5350938 1.330421 0.145739910 0.6706064 0.6353113 1180\n                         leading_edge\nM00001 tags=54%, list=23%, signal=42%\nM00938  tags=40%, list=5%, signal=38%\nM00002 tags=55%, list=11%, signal=49%\nM00035 tags=45%, list=12%, signal=40%\nM00009 tags=50%, list=28%, signal=36%\nM00101  tags=42%, list=9%, signal=38%\n                                                        core_enrichment\nM00001 5214/3101/2821/7167/2597/5230/2023/5223/5315/3099/5232/2027/5211\nM00938                                              6241/7298/4830/1841\nM00002                                    7167/2597/5230/2023/5223/5315\nM00035                                           875/1789/191/1788/1786\nM00009            3418/50/4190/3419/2271/3421/55753/3417/1431/6389/4191\nM00101                                       1717/6713/3930/10682/50814",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>KEGG enrichment analysis</span>"
    ]
  },
  {
    "objectID": "022-kegg.html#visualize-enriched-kegg-pathways",
    "href": "022-kegg.html#visualize-enriched-kegg-pathways",
    "title": "5¬† KEGG enrichment analysis",
    "section": "\n5.6 Visualize enriched KEGG pathways",
    "text": "5.6 Visualize enriched KEGG pathways\nThe enrichplot package implements several methods to visualize enriched terms. Most of them are general methods that can be used on GO, KEGG, MSigDb, and other gene set annotations. Here, we introduce the clusterProfiler::browseKEGG() and pathview::pathview() functions to help users explore enriched KEGG pathways with genes of interest.\nTo view the KEGG pathway, users can use the browseKEGG function, which will open a web browser and highlight enriched genes.\n\nbrowseKEGG(kk, 'hsa04110')\n\n(ref:browseKEGGscap) Explore selected KEGG pathway.\n(ref:browseKEGGcap) Explore selected KEGG pathway. Differentially expressed genes that are enriched in the selected pathway will be highlighted.\n\n\n\n\n(ref:browseKEGGcap)\n\n\n\nUsers can also use the pathview() function from the pathview (Luo and Brouwer 2013) to visualize enriched KEGG pathways identified by the clusterProfiler package (Yu et al. 2012).\nThe following example illustrates how to visualize the ‚Äúhsa04110‚Äù pathway, which was enriched in our previous analysis.\n\nlibrary(\"pathview\")\nhsa04110 &lt;- pathview(gene.data  = geneList,\n                     pathway.id = \"hsa04110\",\n                     species    = \"hsa\",\n                     limit      = list(gene=max(abs(geneList)), cpd=1))\n\n(ref:pathviewscap) Visualze selected KEGG pathway by pathview().\n(ref:pathviewcap) Visualize selected KEGG pathway by pathview(). Gene expression values can be mapped to gradient color scale.\n\n\n\n\n(ref:pathviewcap)",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>KEGG enrichment analysis</span>"
    ]
  },
  {
    "objectID": "022-kegg.html#references",
    "href": "022-kegg.html#references",
    "title": "5¬† KEGG enrichment analysis",
    "section": "References",
    "text": "References\n\n\n\n\nLuo, Weijun, and Cory Brouwer. 2013. ‚ÄúPathview: An R/Bioconductor Package for Pathway-Based Data Integration and Visualization.‚Äù Bioinformatics 29 (July): 1830‚Äì31. https://doi.org/10.1093/bioinformatics/btt285.\n\n\nYu, Guangchuang, Le-Gen Wang, Yanyan Han, and Qing-Yu He. 2012. ‚ÄúclusterProfiler: An r Package for Comparing Biological Themes Among Gene Clusters.‚Äù OMICS: A Journal of Integrative Biology 16 (5): 284‚Äì87. https://doi.org/10.1089/omi.2011.0118.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>KEGG enrichment analysis</span>"
    ]
  },
  {
    "objectID": "023-wikipathways.html",
    "href": "023-wikipathways.html",
    "title": "\n6¬† WikiPathways analysis\n",
    "section": "",
    "text": "6.1 WikiPathways over-representation analysis\nWikiPathways is a continuously updated pathway database curated by a community of researchers and pathway enthusiasts. WikiPathways produces monthly releases of gmt files for supported organisms at data.wikipathways.org. The clusterProfiler package (Yu et al. 2012) supports enrichment analysis (either ORA or GSEA) for WikiPathways using the enrichWP() and gseWP() functions. These functions will automatically download and parse latest WikiPathways GMT file for selected organism.\nSupported organisms can be listed by:\ndata(geneList, package=\"DOSE\")\ngene &lt;- names(geneList)[abs(geneList) &gt; 2]\n\nenrichWP(gene, organism = \"Homo sapiens\") \n\n#\n# over-representation test\n#\n#...@organism    Homo sapiens \n#...@ontology    WikiPathways \n#...@keytype     ENTREZID \n#...@gene    chr [1:207] \"4312\" \"8318\" \"10874\" \"55143\" \"55388\" \"991\" \"6280\" \"2305\" ...\n#...pvalues adjusted by 'BH' with cutoff &lt;0.05 \n#...7 enriched terms found\n'data.frame':   7 obs. of  12 variables:\n $ ID            : chr  \"WP2446\" \"WP2361\" \"WP3942\" \"WP179\" ...\n $ Description   : chr  \"Retinoblastoma gene in cancer\" \"Gastric cancer network 1\" \"PPAR signaling\" \"Cell cycle\" ...\n $ GeneRatio     : chr  \"11/122\" \"6/122\" \"7/122\" \"10/122\" ...\n $ BgRatio       : chr  \"89/9032\" \"28/9032\" \"50/9032\" \"120/9032\" ...\n $ RichFactor    : num  0.1236 0.2143 0.14 0.0833 0.2857 ...\n $ FoldEnrichment: num  9.15 15.86 10.36 6.17 21.15 ...\n $ zScore        : num  9.04 9.22 7.77 6.67 8.83 ...\n $ pvalue        : num  2.60e-08 1.59e-06 4.26e-06 4.63e-06 2.86e-05 ...\n $ p.adjust      : num  8.82e-06 2.69e-04 3.93e-04 3.93e-04 1.94e-03 ...\n $ qvalue        : num  8.19e-06 2.50e-04 3.65e-04 3.65e-04 1.80e-03 ...\n $ geneID        : chr  \"8318/9133/7153/6241/890/983/81620/7272/1111/891/24137\" \"4605/7153/11065/22974/6286/6790\" \"4312/9415/9370/5105/2167/3158/5346\" \"8318/991/9133/890/983/7272/1111/891/4174/9232\" ...\n $ Count         : int  11 6 7 10 4 7 8\n#...Citation\nS Xu, E Hu, Y Cai, Z Xie, X Luo, L Zhan, W Tang, Q Wang, B Liu, R Wang, W Xie, T Wu, L Xie, G Yu. Using clusterProfiler to characterize multiomics data. Nature Protocols. 2024, 19(11):3292-3320",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>WikiPathways analysis</span>"
    ]
  },
  {
    "objectID": "023-wikipathways.html#clusterprofiler-wikipathway-gsea",
    "href": "023-wikipathways.html#clusterprofiler-wikipathway-gsea",
    "title": "\n6¬† WikiPathways analysis\n",
    "section": "\n6.2 WikiPathways gene set enrichment analysis",
    "text": "6.2 WikiPathways gene set enrichment analysis\n\ngseWP(geneList, organism = \"Homo sapiens\")\n\n#\n# Gene Set Enrichment Analysis\n#\n#...@organism    Homo sapiens \n#...@setType     WikiPathways \n#...@keytype     ENTREZID \n#...@geneList    Named num [1:12495] 4.57 4.51 4.42 4.14 3.88 ...\n - attr(*, \"names\")= chr [1:12495] \"4312\" \"8318\" \"10874\" \"55143\" ...\n#...nPerm    \n#...pvalues adjusted by 'BH' with cutoff &lt;0.05 \n#...68 enriched terms found\n'data.frame':   68 obs. of  11 variables:\n $ ID             : chr  \"WP2446\" \"WP179\" \"WP466\" \"WP2361\" ...\n $ Description    : chr  \"Retinoblastoma gene in cancer\" \"Cell cycle\" \"DNA replication\" \"Gastric cancer network 1\" ...\n $ setSize        : int  84 111 42 23 62 231 78 102 41 61 ...\n $ enrichmentScore: num  0.731 0.663 0.792 0.837 0.665 ...\n $ NES            : num  2.93 2.73 2.73 2.52 2.51 ...\n $ pvalue         : num  1.00e-10 1.00e-10 1.00e-10 2.84e-09 2.82e-09 ...\n $ p.adjust       : num  2.56e-08 2.56e-08 2.56e-08 3.64e-07 3.64e-07 ...\n $ qvalue         : num  2.17e-08 2.17e-08 2.17e-08 3.08e-07 3.08e-07 ...\n $ rank           : num  1333 1234 1002 854 1111 ...\n $ leading_edge   : chr  \"tags=51%, list=11%, signal=46%\" \"tags=40%, list=10%, signal=36%\" \"tags=55%, list=8%, signal=51%\" \"tags=52%, list=7%, signal=49%\" ...\n $ core_enrichment: chr  \"8318/9133/7153/6241/890/983/81620/7272/1111/891/24137/993/898/4998/10733/9134/4175/4173/6502/5984/994/7298/3015\"| __truncated__ \"8318/991/9133/890/983/7272/1111/891/4174/9232/4171/993/990/5347/9700/898/23594/4998/9134/4175/4173/10926/6502/9\"| __truncated__ \"8318/55388/81620/4174/4171/990/23594/4998/4175/4173/10926/5984/5111/51053/8317/5427/23649/4176/5982/5557/5558/4172/5424\" \"4605/7153/11065/22974/6286/6790/1894/56992/4173/1063/9585/8607\" ...\n#...Citation\nS Xu, E Hu, Y Cai, Z Xie, X Luo, L Zhan, W Tang, Q Wang, B Liu, R Wang, W Xie, T Wu, L Xie, G Yu. Using clusterProfiler to characterize multiomics data. Nature Protocols. 2024, 19(11):3292-3320 \n\n\nIf your input gene ID type is not Entrez gene ID, you can use the bitr() function to convert gene ID. If you want to convert the gene IDs in output result to gene symbols, you can use the setReadable() function.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>WikiPathways analysis</span>"
    ]
  },
  {
    "objectID": "023-wikipathways.html#references",
    "href": "023-wikipathways.html#references",
    "title": "\n6¬† WikiPathways analysis\n",
    "section": "References",
    "text": "References\n\n\n\n\nYu, Guangchuang, Le-Gen Wang, Yanyan Han, and Qing-Yu He. 2012. ‚ÄúclusterProfiler: An r Package for Comparing Biological Themes Among Gene Clusters.‚Äù OMICS: A Journal of Integrative Biology 16 (5): 284‚Äì87. https://doi.org/10.1089/omi.2011.0118.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>WikiPathways analysis</span>"
    ]
  },
  {
    "objectID": "024-reactome.html",
    "href": "024-reactome.html",
    "title": "7¬† Reactome enrichment analysis",
    "section": "",
    "text": "7.1 Supported organisms\nReactomePA is designed for reactome pathway based analysis (Yu and He 2016). Reactome is an open-source, open access, manually curated and peer-reviewed pathway database.\nCurrently ReactomePA supports several model organisms, including ‚Äòcelegans‚Äô, ‚Äòfly‚Äô, ‚Äòhuman‚Äô, ‚Äòmouse‚Äô, ‚Äòrat‚Äô, ‚Äòyeast‚Äô and ‚Äòzebrafish‚Äô. The input gene ID should be Entrez gene ID. We recommend using clusterProfiler::bitr() to convert biological IDs.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Reactome enrichment analysis</span>"
    ]
  },
  {
    "objectID": "024-reactome.html#reactomepa-ora",
    "href": "024-reactome.html#reactomepa-ora",
    "title": "7¬† Reactome enrichment analysis",
    "section": "\n7.2 Reactome pathway over-representation analysis",
    "text": "7.2 Reactome pathway over-representation analysis\nEnrichment analysis is a widely used approach to identify biological themes. ReactomePA implemented enrichPathway() that uses hypergeometric model to assess whether the number of selected genes associated with a reactome pathway is larger than expected.\n\nlibrary(ReactomePA)\ndata(geneList, package=\"DOSE\"\n)\nde &lt;- names(geneList)[abs(geneList) &gt; 1.5]\nhead(de)\n\n[1] \"4312\"  \"8318\"  \"10874\" \"55143\" \"55388\" \"991\"  \n\nx &lt;- enrichPathway(gene=de, pvalueCutoff = 0.05, readable=TRUE)\nhead(x)\n\n                         ID\nR-HSA-69278     R-HSA-69278\nR-HSA-69620     R-HSA-69620\nR-HSA-69618     R-HSA-69618\nR-HSA-2500257 R-HSA-2500257\nR-HSA-141424   R-HSA-141424\nR-HSA-141444   R-HSA-141444\n                                                                                       Description\nR-HSA-69278                                                                    Cell Cycle, Mitotic\nR-HSA-69620                                                                 Cell Cycle Checkpoints\nR-HSA-69618                                                             Mitotic Spindle Checkpoint\nR-HSA-2500257                                              Resolution of Sister Chromatid Cohesion\nR-HSA-141424                                         Amplification of signal from the kinetochores\nR-HSA-141444  Amplification  of signal from unattached  kinetochores via a MAD2  inhibitory signal\n              GeneRatio   BgRatio RichFactor FoldEnrichment   zScore\nR-HSA-69278      49/314 479/10173  0.1022965       3.314210 9.259137\nR-HSA-69620      33/314 244/10173  0.1352459       4.381709 9.541792\nR-HSA-69618      19/314  94/10173  0.2021277       6.548550 9.644646\nR-HSA-2500257    20/314 109/10173  0.1834862       5.944604 9.262132\nR-HSA-141424     17/314  79/10173  0.2151899       6.971741 9.508990\nR-HSA-141444     17/314  79/10173  0.2151899       6.971741 9.508990\n                    pvalue     p.adjust       qvalue\nR-HSA-69278   6.635185e-14 5.288243e-11 4.742411e-11\nR-HSA-69620   5.785253e-13 2.305423e-10 2.067467e-10\nR-HSA-69618   5.135524e-11 1.364337e-08 1.223516e-08\nR-HSA-2500257 1.006794e-10 2.006036e-08 1.798981e-08\nR-HSA-141424  1.923239e-10 2.554702e-08 2.291016e-08\nR-HSA-141444  1.923239e-10 2.554702e-08 2.291016e-08\n                                                                                                                                                                                                                                                                                                   geneID\nR-HSA-69278   CDC45/CDCA8/CDC20/FOXM1/CENPE/MYBL2/CCNB2/NDC80/TOP2A/NCAPH/RRM2/UBE2C/HJURP/SKA1/TPX2/NEK2/CENPM/CENPN/UBE2S/CCNA2/CDK1/ERCC6L/GINS1/KIF18A/CDT1/NCAPG/AURKB/GINS2/KIF20A/AURKA/CCNB1/MCM5/PTTG1/MCM2/KIF2C/CDC25A/CDC6/PLK1/BUB1B/GTSE1/ZWINT/SPC25/CENPI/ESPL1/TK1/CCNE1/ORC6/ORC1/TAOK1\nR-HSA-69620                                                                                              CDC45/CDCA8/CDC20/CENPE/CCNB2/NDC80/UBE2C/SKA1/CENPM/CENPN/UBE2S/CCNA2/CDK1/ERCC6L/KIF18A/AURKB/CHEK1/CCNB1/MCM5/MCM2/KIF2C/CDC25A/CDC6/PLK1/BUB1B/GTSE1/ZWINT/SPC25/CENPI/CCNE1/ORC6/ORC1/TAOK1\nR-HSA-69618                                                                                                                                                                             CDCA8/CDC20/CENPE/NDC80/UBE2C/SKA1/CENPM/CENPN/UBE2S/ERCC6L/KIF18A/AURKB/KIF2C/PLK1/BUB1B/ZWINT/SPC25/CENPI/TAOK1\nR-HSA-2500257                                                                                                                                                                      CDCA8/CDC20/CENPE/CCNB2/NDC80/SKA1/CENPM/CENPN/CDK1/ERCC6L/KIF18A/AURKB/CCNB1/KIF2C/PLK1/BUB1B/ZWINT/SPC25/CENPI/TAOK1\nR-HSA-141424                                                                                                                                                                                        CDCA8/CDC20/CENPE/NDC80/SKA1/CENPM/CENPN/ERCC6L/KIF18A/AURKB/KIF2C/PLK1/BUB1B/ZWINT/SPC25/CENPI/TAOK1\nR-HSA-141444                                                                                                                                                                                        CDCA8/CDC20/CENPE/NDC80/SKA1/CENPM/CENPN/ERCC6L/KIF18A/AURKB/KIF2C/PLK1/BUB1B/ZWINT/SPC25/CENPI/TAOK1\n              Count\nR-HSA-69278      49\nR-HSA-69620      33\nR-HSA-69618      19\nR-HSA-2500257    20\nR-HSA-141424     17\nR-HSA-141444     17",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Reactome enrichment analysis</span>"
    ]
  },
  {
    "objectID": "024-reactome.html#reactomepa-gsea",
    "href": "024-reactome.html#reactomepa-gsea",
    "title": "7¬† Reactome enrichment analysis",
    "section": "\n7.3 Reactome pathway gene set enrichment analysis",
    "text": "7.3 Reactome pathway gene set enrichment analysis\n\ny &lt;- gsePathway(geneList, \n                pvalueCutoff = 0.2,\n                pAdjustMethod = \"BH\", \n                verbose = FALSE)\nhead(y)\n\n                         ID                          Description setSize\nR-HSA-69278     R-HSA-69278                  Cell Cycle, Mitotic     382\nR-HSA-453279   R-HSA-453279 Mitotic G1 phase and G1/S transition     113\nR-HSA-69620     R-HSA-69620               Cell Cycle Checkpoints     194\nR-HSA-2555396 R-HSA-2555396       Mitotic Metaphase and Anaphase     156\nR-HSA-69206     R-HSA-69206                      G1/S Transition     100\nR-HSA-68882     R-HSA-68882                     Mitotic Anaphase     155\n              enrichmentScore      NES pvalue     p.adjust       qvalue rank\nR-HSA-69278         0.6235874 3.027524  1e-10 4.463636e-09 3.240829e-09 1769\nR-HSA-453279        0.7235270 2.995080  1e-10 4.463636e-09 3.240829e-09 1155\nR-HSA-69620         0.6662086 2.973969  1e-10 4.463636e-09 3.240829e-09 1768\nR-HSA-2555396       0.6639936 2.919566  1e-10 4.463636e-09 3.240829e-09 1768\nR-HSA-69206         0.7204590 2.917355  1e-10 4.463636e-09 3.240829e-09 1155\nR-HSA-68882         0.6619226 2.906883  1e-10 4.463636e-09 3.240829e-09 1768\n                                leading_edge\nR-HSA-69278   tags=38%, list=14%, signal=34%\nR-HSA-453279   tags=44%, list=9%, signal=41%\nR-HSA-69620   tags=42%, list=14%, signal=36%\nR-HSA-2555396 tags=42%, list=14%, signal=36%\nR-HSA-69206    tags=45%, list=9%, signal=41%\nR-HSA-68882   tags=41%, list=14%, signal=36%\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 core_enrichment\nR-HSA-69278   8318/55143/991/2305/1062/4605/9133/10403/7153/23397/6241/11065/55355/220134/22974/4751/79019/55839/27338/890/983/54821/9837/81930/81620/64151/9212/51659/10112/6790/891/4174/9232/4171/11004/993/990/5347/701/51512/11130/57405/2491/9700/7083/898/23594/4998/10733/1163/54801/9134/4175/4173/2237/5984/994/9918/7298/84296/699/4609/1063/85236/5111/28227/9688/64785/5709/26271/55055/51053/1869/1029/1763/1719/8970/54892/8357/5693/8317/7277/5427/23649/7112/5713/3930/79980/9735/55732/11047/5557/23310/5691/1871/1031/80086/995/10051/1104/5685/84790/1019/5558/4172/9631/5424/79866/5690/5885/5686/5695/203068/7027/10213/1875/23175/8345/7283/10381/5983/7979/54908/10592/23165/10383/3018/22822/5714/10376/7443/55706/8815/5702/3014/1030/23636/9978/5905/5425/5708/55166/5692/10393/54107\nR-HSA-453279                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         8318/4605/7153/6241/890/983/81620/891/4174/4171/993/990/7083/898/23594/4998/1163/9134/4175/4173/7298/4609/5111/28227/5709/26271/51053/1869/1029/1719/5693/8317/5427/23649/5713/11047/5557/5691/1871/1031/5685/1019/5558/4172/5690/5686/5695/7027/10213/1875\nR-HSA-69620                                                                                                                                                                                                                                                                                                                                                                 8318/55143/991/1062/9133/10403/11065/220134/79019/55839/27338/890/983/54821/81930/9212/1111/891/4174/4171/11004/993/990/5347/701/51512/11130/57405/2491/898/23594/4998/9134/4175/4173/5984/699/1063/85236/5709/55055/641/1029/1763/8970/5693/8317/5713/79980/9735/11047/2810/5691/995/5685/4172/7336/5690/83990/5686/5695/11200/10213/8345/7534/80010/5983/7979/54908/4683/63967/3018/5714/5702/3014/9978/5905/5708/55166/5692/10393\nR-HSA-2555396                                                                                                                                                                                                                                                                                                                                                                                                                                       55143/991/1062/9133/10403/11065/220134/79019/55839/27338/983/54821/81930/9212/891/9232/11004/5347/701/11130/57405/2491/9700/699/1063/9688/5709/26271/55055/5693/7277/7112/5713/3930/79980/9735/11047/5691/80086/1104/5685/84790/9631/5690/5885/5686/5695/10213/10381/7979/54908/23165/10383/5714/10376/7443/55706/8815/5702/23636/5905/5708/55166/5692/10393\nR-HSA-69206                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   8318/6241/890/983/81620/891/4174/4171/993/990/7083/898/23594/4998/1163/9134/4175/4173/7298/4609/5111/28227/5709/26271/51053/1869/1719/5693/8317/5427/23649/5713/11047/5557/5691/5685/1019/5558/4172/5690/5686/5695/7027/10213/1875\nR-HSA-68882                                                                                                                                                                                                                                                                                                                                                                                                                                               55143/991/1062/9133/10403/11065/220134/79019/55839/27338/983/54821/81930/9212/891/9232/11004/5347/701/11130/57405/2491/9700/699/1063/9688/5709/55055/5693/7277/7112/5713/3930/79980/9735/11047/5691/80086/1104/5685/84790/9631/5690/5885/5686/5695/10213/10381/7979/54908/23165/10383/5714/10376/7443/55706/8815/5702/23636/5905/5708/55166/5692/10393",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Reactome enrichment analysis</span>"
    ]
  },
  {
    "objectID": "024-reactome.html#pathway-visualization",
    "href": "024-reactome.html#pathway-visualization",
    "title": "7¬† Reactome enrichment analysis",
    "section": "\n7.4 Pathway Visualization",
    "text": "7.4 Pathway Visualization\nReactomePA implemented the viewPathway() to visualized selected reactome pathway. More general purpose of visualization methods for ORA and GSEA results are provided in the enrichplot package and are documented on Chapter 14.\n(ref:viewpathwayscap) Visualize reactome pathway.\n(ref:viewpathwaycap) Visualize reactome pathway.\n\nviewPathway(\"E2F mediated regulation of DNA replication\", \n            readable = TRUE, \n            foldChange = geneList)\n\n\n\n(ref:viewpathwaycap)",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Reactome enrichment analysis</span>"
    ]
  },
  {
    "objectID": "024-reactome.html#references",
    "href": "024-reactome.html#references",
    "title": "7¬† Reactome enrichment analysis",
    "section": "References",
    "text": "References\n\n\n\n\nYu, Guangchuang, and Qing-Yu He. 2016. ‚ÄúReactomePA: An r/Bioconductor Package for Reactome Pathway Analysis and Visualization.‚Äù Molecular BioSystems 12 (2): 477‚Äì79. https://doi.org/10.1039/C5MB00663E.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Reactome enrichment analysis</span>"
    ]
  },
  {
    "objectID": "025-do-enrichment.html",
    "href": "025-do-enrichment.html",
    "title": "8¬† Disease enrichment analysis",
    "section": "",
    "text": "8.1 Disease over-representation analysis\nWe developed DOSE (Yu et al. 2015) package to promote the investigation of diseases. DOSE provides five methods for measuring semantic similarities among DO terms and gene products, hypergeometric model and gene set enrichment analysis (GSEA) for associating disease with gene list and extracting disease association insight from genome wide expression profiles.\nDOSE supports enrichment analysis of Disease Ontology (DO) (Schriml et al. 2011), Network of Cancer Gene (A. et al. 2016) and Disease Gene Network (DisGeNET) (Janet et al. 2015). In addition, several visualization methods were provided by enrichplot to help interpreting semantic and enrichment results.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Disease enrichment analysis</span>"
    ]
  },
  {
    "objectID": "025-do-enrichment.html#dose-ora",
    "href": "025-do-enrichment.html#dose-ora",
    "title": "8¬† Disease enrichment analysis",
    "section": "",
    "text": "8.1.1 Over-representation analysis for disease ontology\nIn the following example, we selected fold change above 1.5 as the differential genes and analyzing their disease association.\n\nlibrary(DOSE)\ndata(geneList)\ngene &lt;- names(geneList)[abs(geneList) &gt; 1.5]\nhead(gene)\n\n[1] \"4312\"  \"8318\"  \"10874\" \"55143\" \"55388\" \"991\"  \n\nx &lt;- enrichDO(gene          = gene,\n              ont           = \"HDO\",\n              pvalueCutoff  = 0.05,\n              pAdjustMethod = \"BH\",\n              universe      = names(geneList),\n              minGSSize     = 5,\n              maxGSSize     = 500,\n              qvalueCutoff  = 0.05,\n              readable      = FALSE)\nhead(x)\n\n                       ID           Description GeneRatio  BgRatio RichFactor\nDOID:0060306 DOID:0060306 Meier-Gorlin syndrome     6/273  10/6078  0.6000000\nDOID:10534     DOID:10534        stomach cancer    25/273 205/6078  0.1219512\nDOID:5041       DOID:5041     esophageal cancer    18/273 132/6078  0.1363636\nDOID:820         DOID:820           myocarditis     8/273  31/6078  0.2580645\nDOID:1107       DOID:1107  esophageal carcinoma    16/273 117/6078  0.1367521\nDOID:1612       DOID:1612         breast cancer    35/273 398/6078  0.0879397\n             FoldEnrichment   zScore       pvalue    p.adjust      qvalue\nDOID:0060306      13.358242 8.481228 1.402836e-06 0.001273775 0.001058772\nDOID:10534         2.715090 5.416997 4.109986e-06 0.001865933 0.001550979\nDOID:5041          3.035964 5.128253 2.117499e-05 0.006408964 0.005327182\nDOID:820           5.745480 5.744019 4.782074e-05 0.009274126 0.007708728\nDOID:1107          3.044614 4.842498 5.908904e-05 0.009274126 0.007708728\nDOID:1612          1.957866 4.286443 8.098096e-05 0.009274126 0.007708728\n                                                                                                                                                                                 geneID\nDOID:0060306                                                                                                                                             8318/81620/4174/990/23594/4998\nDOID:10534                                             4312/2305/10403/259266/8140/81930/332/2146/8061/4318/3576/8792/6352/4288/3131/2952/347902/3572/563/7031/6926/3117/2018/2066/3169\nDOID:5041                                                                                      4312/3868/8140/7850/2146/4321/2921/4318/3576/6890/2952/563/7373/771/2018/2066/3169/11122\nDOID:820                                                                                                                                       6280/6279/3627/29851/8792/1493/2697/4982\nDOID:1107                                                                                                4312/3868/8140/2146/4321/4318/3576/6890/2952/563/7373/771/2018/2066/3169/11122\nDOID:1612    4312/6241/983/2146/3887/6790/891/23532/3161/993/5347/55215/55723/875/8438/9700/5888/7083/898/1493/6352/4288/3551/185/2952/367/1634/4582/3479/9370/3117/652/4137/3169/10551\n             Count\nDOID:0060306     6\nDOID:10534      25\nDOID:5041       18\nDOID:820         8\nDOID:1107       16\nDOID:1612       35\n\n\nThe enrichDO() function requires an entrezgene ID vector as input, mostly is the differential gene list of gene expression profile studies. Please refer to session 16.1 if you need to conver other gene ID types to entrezgene ID.\nThe ont parameter can be ‚ÄúHDO‚Äù (Human Disease Ontology), ‚ÄúHPO‚Äù (Human Phenotype Ontology) or ‚ÄúMPO‚Äù (Mouse Phenotype Ontology). pvalueCutoff setting the cutoff value of p value and adjusted p value; pAdjustMethod setting the p value correction methods, include the Bonferroni correction (‚Äúbonferroni‚Äù), Holm (‚Äúholm‚Äù), Hochberg (‚Äúhochberg‚Äù), Hommel (‚Äúhommel‚Äù), Benjamini & Hochberg (‚ÄúBH‚Äù) and Benjamini & Yekutieli (‚ÄúBY‚Äù) while qvalueCutoff is used to control q-values.\nThe universe setting the background gene universe for testing. If user do not explicitly setting this parameter, enrichDO() will set the universe to all human genes that have DO annotation.\nThe minGSSize (and maxGSSize) indicates that only those DO terms that have more than minGSSize (and less than maxGSSize) genes annotated will be tested.\nThe readable is a logical parameter, indicates whether the entrezgene IDs will mapping to gene symbols or not (see also setReadable).\n\n8.1.2 Over-representation analysis for the network of cancer gene\nNetwork of Cancer Gene (NCG) (A. et al. 2016) is a manually curated repository of cancer genes. NCG release 5.0 (Aug.¬†2015) collects 1,571 cancer genes from 175 published studies. DOSE supports analyzing gene list and determine whether they are enriched in genes known to be mutated in a given cancer type.\n\ngene2 &lt;- names(geneList)[abs(geneList) &lt; 3]\nncg &lt;- enrichNCG(gene2) \nhead(ncg)\n\n                                                                     ID\npan-cancer_paediatric                             pan-cancer_paediatric\ntriple_negative_breast_cancer             triple_negative_breast_cancer\nbladder_cancer                                           bladder_cancer\npancreatic_cancer_(all_histologies) pancreatic_cancer_(all_histologies)\nsoft_tissue_sarcoma                                 soft_tissue_sarcoma\npaediatric_high-grade_glioma               paediatric_high-grade_glioma\n                                                            Description\npan-cancer_paediatric                             pan-cancer_paediatric\ntriple_negative_breast_cancer             triple_negative_breast_cancer\nbladder_cancer                                           bladder_cancer\npancreatic_cancer_(all_histologies) pancreatic_cancer_(all_histologies)\nsoft_tissue_sarcoma                                 soft_tissue_sarcoma\npaediatric_high-grade_glioma               paediatric_high-grade_glioma\n                                    GeneRatio  BgRatio RichFactor\npan-cancer_paediatric                162/2281 183/3177  0.8852459\ntriple_negative_breast_cancer         71/2281  75/3177  0.9466667\nbladder_cancer                        97/2281 112/3177  0.8660714\npancreatic_cancer_(all_histologies)   40/2281  42/3177  0.9523810\nsoft_tissue_sarcoma                   26/2281  26/3177  1.0000000\npaediatric_high-grade_glioma          25/2281  25/3177  1.0000000\n                                    FoldEnrichment   zScore       pvalue\npan-cancer_paediatric                     1.232979 5.179242 1.833773e-08\ntriple_negative_breast_cancer             1.318527 4.453534 4.290660e-07\nbladder_cancer                            1.206273 3.545563 1.253690e-04\npancreatic_cancer_(all_histologies)       1.326486 3.397967 1.262162e-04\nsoft_tissue_sarcoma                       1.392810 3.208441 1.742793e-04\npaediatric_high-grade_glioma              1.392810 3.145636 2.434966e-04\n                                        p.adjust       qvalue\npan-cancer_paediatric               1.613721e-06 7.721152e-07\ntriple_negative_breast_cancer       1.887890e-05 9.032967e-06\nbladder_cancer                      2.776757e-03 1.328592e-03\npancreatic_cancer_(all_histologies) 2.776757e-03 1.328592e-03\nsoft_tissue_sarcoma                 3.067315e-03 1.467615e-03\npaediatric_high-grade_glioma        3.073768e-03 1.470702e-03\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                geneID\npan-cancer_paediatric               2146/55353/4609/1029/3575/22806/3418/3066/2120/30012/867/7468/7545/3195/865/64109/4613/613/11177/7490/238/10736/10054/5771/4893/140885/1785/9760/3417/6597/6476/9126/4869/10320/7307/80204/1050/10992/8028/2312/6608/896/894/2196/4849/7023/5093/5079/5293/5727/55181/171017/51322/5781/3718/55294/60/673/8085/5897/4851/1665/51176/1108/7764/10664/6098/2332/2201/6495/3845/7015/1441/2782/64919/4298/23512/8239/29102/6929/8021/6134/6598/4209/5290/22941/8726/207/3717/2033/10716/4928/6932/694/5156/10019/6886/9968/7080/2623/7874/1654/4149/3020/23219/55252/55729/10735/5728/4853/23451/51341/387/3206/6146/79718/2624/63035/3815/171023/23269/25/23592/5896/7403/2260/54880/3716/9203/57178/6777/5789/4297/29072/90/546/120/25836/8289/4345/9611/5925/4763/1997/1499/7157/3399/5295/1387/4602/51564/1027/4005/2322/2078/678/6403/55709/1277/7494/64061/2625\ntriple_negative_breast_cancer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       6790/898/4609/1029/1789/4436/2120/867/7128/1788/1030/7490/2271/238/675/2047/4914/1316/5291/5293/5781/55294/8085/4851/4170/3845/355/1616/4854/5290/207/2033/4233/29110/2903/5979/5728/4853/2624/3815/10000/7403/2260/55193/472/5789/4297/2065/4286/8626/8405/8289/10499/55164/5925/4763/23405/1499/4921/7157/5295/1387/2078/324/7248/7048/22894/3480/2045/2066/2625\nbladder_cancer                                                                                                                                                                                                                                                                                                                                                            9700/57211/2175/9603/1029/11168/2072/8997/79949/54663/688/6882/4893/8454/6693/56288/2195/10992/1026/64783/896/677/26038/6256/55294/60/8085/4851/841/3265/7175/1999/730051/3845/23484/7015/8243/10605/8295/4854/5290/51043/2033/4780/23224/23217/2064/23385/55252/10735/8241/10672/5728/4853/23451/374291/387/7799/171023/288/30849/4152/9794/7403/287/57634/463/472/4297/2065/2262/3280/23232/8289/9611/5925/2068/56339/4763/7157/2186/1387/3910/7536/2261/7248/23037/6709/54961/23345/57125/7832/79633/10628/22906/388/3169\npancreatic_cancer_(all_histologies)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      1029/4771/8997/7159/2011/6597/7307/10992/3710/6710/55294/7091/3845/23654/7046/3096/4089/91/8241/54549/92/23451/63035/7403/55193/23309/472/800/29072/23077/23499/8289/54894/6416/7157/4088/182/7048/2199/26960\nsoft_tissue_sarcoma                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   999/6850/4914/4342/2185/55294/2041/4851/2044/4058/5290/4486/5297/5728/3815/2324/7403/546/5925/4763/1499/7157/5159/2045/3667/2066\npaediatric_high-grade_glioma                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   4609/1029/1019/4613/1030/1956/4914/896/894/673/8493/5290/4233/5156/1021/63035/54880/4916/90/546/4763/7157/5295/595/4915\n                                    Count\npan-cancer_paediatric                 162\ntriple_negative_breast_cancer          71\nbladder_cancer                         97\npancreatic_cancer_(all_histologies)    40\nsoft_tissue_sarcoma                    26\npaediatric_high-grade_glioma           25\n\n\n\n8.1.3 Over-representation analysis for the disease gene network\nDisGeNET(Janet et al. 2015) is an integrative and comprehensive resources of gene-disease associations from several public data sources and the literature. It contains gene-disease associations and snp-gene-disease associations.\nThe enrichment analysis of disease-gene associations is supported by the enrichDGN function and analysis of snp-gene-disease associations is supported by the enrichDGNv function.\n\ndgn &lt;- enrichDGN(gene) \nhead(dgn)\n\n               ID                              Description GeneRatio   BgRatio\nC0010278 C0010278                         Craniosynostosis    43/497 488/21671\nC0853879 C0853879             Invasive carcinoma of breast    42/497 473/21671\nC4733092 C4733092 estrogen receptor-negative breast cancer    34/497 356/21671\nC3642347 C3642347              Basal-Like Breast Carcinoma    28/497 245/21671\nC3642345 C3642345               Luminal A Breast Carcinoma    22/497 153/21671\nC0036202 C0036202                              Sarcoidosis    36/497 413/21671\n         RichFactor FoldEnrichment    zScore       pvalue     p.adjust\nC0010278 0.08811475       3.842122  9.728932 4.609534e-14 2.267976e-10\nC0853879 0.08879493       3.871780  9.674768 7.105190e-14 2.267976e-10\nC4733092 0.09550562       4.164391  9.223137 2.446675e-12 4.864593e-09\nC3642347 0.11428571       4.983271  9.606353 3.047991e-12 4.864593e-09\nC3642345 0.14379085       6.269802 10.021789 7.034749e-12 8.438458e-09\nC0036202 0.08716707       3.800800  8.804448 7.930882e-12 8.438458e-09\n               qvalue\nC0010278 1.636811e-10\nC0853879 1.636811e-10\nC4733092 3.510804e-09\nC3642347 3.510804e-09\nC3642345 6.090082e-09\nC0036202 6.090082e-09\n                                                                                                                                                                                                                          geneID\nC0010278 4312/8318/6280/1062/6279/6278/3627/820/27299/6362/81620/2146/3002/29968/990/4318/4069/3576/6890/23594/26279/1493/6352/4998/2152/2697/185/4330/5327/4982/1300/3667/2200/9607/3572/563/7031/3479/6424/1846/3117/1308/2625\nC0853879        4312/7153/6278/9787/9582/51203/890/983/5080/2146/1111/9232/10855/4171/6664/4102/2173/4318/701/3576/1978/8836/53335/1894/7980/8792/8842/2151/185/2952/367/4982/4582/6926/3479/1602/23158/2066/3169/5304/2625/5241\nC4733092                                         2305/6278/79733/6241/81930/81620/2146/3620/29968/11004/8061/3576/1894/2491/7083/8792/214/5327/367/4982/3667/4582/27324/3479/1846/80129/4137/8839/3169/1408/5304/2625/5241/10551\nC3642347                                                                          2305/1062/4605/9833/7368/11065/10232/55765/5163/2146/2568/3620/6790/6664/29127/2173/4318/3576/3159/8792/6663/27324/3479/1846/18/3169/2625/5241\nC3642345                                                                                                         2305/9833/7153/55355/1111/3161/4318/3576/2001/6663/4288/2152/185/4128/4582/27324/80129/3169/5304/8614/2625/5241\nC0036202                               4312/6280/6279/10403/3627/6373/4283/27299/6362/3002/4321/6355/6364/29851/4318/5004/4069/3576/26227/6890/6352/4485/23541/185/7043/6863/2952/4982/25802/4582/2053/3479/3117/2167/80736/1524\n         Count\nC0010278    43\nC0853879    42\nC4733092    34\nC3642347    28\nC3642345    22\nC0036202    36\n\nsnp &lt;- c(\"rs1401296\", \"rs9315050\", \"rs5498\", \"rs1524668\", \"rs147377392\",\n         \"rs841\", \"rs909253\", \"rs7193343\", \"rs3918232\", \"rs3760396\",\n         \"rs2231137\", \"rs10947803\", \"rs17222919\", \"rs386602276\", \"rs11053646\",\n         \"rs1805192\", \"rs139564723\", \"rs2230806\", \"rs20417\", \"rs966221\")\ndgnv &lt;- enrichDGNv(snp)\nhead(dgnv)\n\n               ID               Description GeneRatio    BgRatio RichFactor\nC0010054 C0010054 Coronary Arteriosclerosis      6/17 440/194515 0.01363636\nC0151744 C0151744       Myocardial Ischemia      4/17 103/194515 0.03883495\nC0031099 C0031099             Periodontitis      4/17 116/194515 0.03448276\nC0007785 C0007785       Cerebral Infarction      4/17 123/194515 0.03252033\nC0003850 C0003850          Arteriosclerosis      4/17 267/194515 0.01498127\nC0004153 C0004153           Atherosclerosis      4/17 281/194515 0.01423488\n         FoldEnrichment   zScore       pvalue     p.adjust qvalue\nC0010054       156.0281 30.43647 1.568917e-12 2.761295e-10     NA\nC0151744       444.3518 42.07730 1.754840e-10 1.544259e-08     NA\nC0031099       394.5538 39.63952 2.839985e-10 1.583793e-08     NA\nC0007785       372.0995 38.48983 3.599531e-10 1.583793e-08     NA\nC0003850       171.4166 26.05143 8.145389e-09 2.867177e-07     NA\nC0004153       162.8763 25.38727 9.996713e-09 2.932369e-07     NA\n                                                            geneID Count\nC0010054 rs5498/rs147377392/rs11053646/rs1805192/rs2230806/rs20417     6\nC0151744                   rs5498/rs147377392/rs11053646/rs1805192     4\nC0031099                         rs5498/rs909253/rs1805192/rs20417     4\nC0007785                rs147377392/rs11053646/rs1805192/rs2230806     4\nC0003850                        rs5498/rs1805192/rs2230806/rs20417     4\nC0004153                        rs5498/rs1805192/rs2230806/rs20417     4",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Disease enrichment analysis</span>"
    ]
  },
  {
    "objectID": "025-do-enrichment.html#dose-gsea",
    "href": "025-do-enrichment.html#dose-gsea",
    "title": "8¬† Disease enrichment analysis",
    "section": "\n8.2 Disease gene set enrichment analysis",
    "text": "8.2 Disease gene set enrichment analysis\n\n8.2.1 gseDO fuction\nIn the following example, in order to speedup the compilation of this document, only gene sets with size above 120 were tested and only 100 permutations were performed.\n\nlibrary(DOSE)\ndata(geneList)\ny &lt;- gseDO(geneList,\n           minGSSize     = 120,\n           pvalueCutoff  = 0.2,\n           pAdjustMethod = \"BH\",\n           verbose       = FALSE)\nhead(y, 3)\n\n                       ID                      Description setSize\nDOID:612         DOID:612 primary immunodeficiency disease     194\nDOID:0050117 DOID:0050117      disease by infectious agent     466\nDOID:934         DOID:934         viral infectious disease     297\n             enrichmentScore      NES       pvalue     p.adjust       qvalue\nDOID:612           0.4861389 2.195667 1.441403e-10 2.219760e-08 1.441403e-08\nDOID:0050117       0.3382869 1.654190 1.060502e-07 8.165866e-06 5.302511e-06\nDOID:934           0.3461519 1.635336 1.832569e-05 9.407189e-04 6.108564e-04\n             rank                   leading_edge\nDOID:612     2521 tags=45%, list=20%, signal=36%\nDOID:0050117 2199 tags=31%, list=18%, signal=27%\nDOID:934     2197 tags=32%, list=18%, signal=27%\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      core_enrichment\nDOID:612                                                                                                                                                                                                                                                                                                     55388/7153/9837/29851/6890/9636/1503/1493/7037/4173/3932/3559/6772/51311/3507/3561/917/3574/3575/919/4860/915/22806/4938/1535/3458/959/5336/11151/3702/925/4688/64135/28755/50615/974/1794/3689/5788/916/4068/3937/30009/3394/10525/100/7374/3659/939/4689/5880/7128/6891/6789/930/6573/11322/204/6850/10095/7852/8772/64170/3119/28985/1053/5971/1536/10125/8456/8625/3071/7293/4478/1380/958/5591/9437/10379/54440/3570/3978/3593/10625/29927/3558/735\nDOID:0050117 4312/6279/8685/3627/4283/6362/3002/3620/6355/2921/6364/4318/3576/6890/875/1493/6352/4288/3934/59272/4599/54210/3932/80380/713/5551/133/3559/768/1230/6772/51311/6347/6402/5320/64581/4609/81611/3561/91543/6351/6590/9332/1029/1051/3574/6354/3806/7412/1535/3458/81873/959/4783/2950/3162/925/1594/50615/942/2529/51224/1991/1557/10576/9235/25939/6361/3689/1234/916/467/7096/259197/3383/6367/30009/2539/5806/6374/100/2525/1088/3600/3659/2919/6696/3549/940/58528/10541/6646/6285/6891/6396/671/7422/6059/6573/929/142/26191/4282/468/1312/7124/29949/912/1030/5329/3569/4049/7097/10096/56244/50506/2048/345/1378/5133/5743/348/4151/3119/3053/1956/2213/5971/3135/6376/9021/3596/2833/1080/356/1380/286/7133/887/958/4504/728/9402/5610/5054/4880\nDOID:934                                                                                                                                                                                                                                                                      4312/6279/3627/4283/3002/3620/6355/2921/6364/3576/1493/6352/4288/3934/59272/4599/54210/3932/713/5551/3559/768/1230/6772/51311/6347/5320/4609/3561/91543/6351/6590/9332/1029/1051/3574/6354/3806/3458/959/4783/925/1594/50615/1991/9235/25939/6361/3689/1234/916/259197/3383/5806/6374/1088/3600/3659/2919/940/6285/6891/671/7422/6059/929/142/4282/468/7124/912/1030/5329/3569/7097/2048/345/5133/5743/348/4151/3119/1956/3135/6376/9021/3596/356/1380/7133/958/4504/728/9402/5610/5054\n\n\n\n8.2.2 gseNCG fuction\n\nncg &lt;- gseNCG(geneList,\n              pvalueCutoff  = 0.5,\n              pAdjustMethod = \"BH\",\n              verbose       = FALSE)\nncg &lt;- setReadable(ncg, 'org.Hs.eg.db')\nhead(ncg, 3) \n\n                                                           ID\npan-gynecological and breast     pan-gynecological and breast\npan-gastric                                       pan-gastric\nbreast_fibroepithelial_tumours breast_fibroepithelial_tumours\n                                                  Description setSize\npan-gynecological and breast     pan-gynecological and breast      43\npan-gastric                                       pan-gastric      49\nbreast_fibroepithelial_tumours breast_fibroepithelial_tumours      17\n                               enrichmentScore       NES      pvalue  p.adjust\npan-gynecological and breast        -0.5263429 -1.728298 0.003304610 0.1243685\npan-gastric                         -0.4993803 -1.697203 0.004015524 0.1243685\nbreast_fibroepithelial_tumours      -0.6421576 -1.692469 0.006141654 0.1243685\n                                  qvalue rank                   leading_edge\npan-gynecological and breast   0.1115195 2464 tags=44%, list=20%, signal=36%\npan-gastric                    0.1115195 3280 tags=49%, list=26%, signal=36%\nbreast_fibroepithelial_tumours 0.1115195 2700 tags=59%, list=22%, signal=46%\n                                                                                                                                                              core_enrichment\npan-gynecological and breast                                 ATM/ZC3H13/NIPBL/SPOP/ARID1A/RASA1/RB1/RNF43/MAP2K4/NF1/CTNNB1/TP53/PIK3R1/CDKN1B/CCND1/ARID5B/MAP3K1/TBX3/GATA3\npan-gastric                    BCOR/SOX9/TCF7L2/ATM/CALD1/SEMG2/HTR7/ARID1A/RASA1/RB1/TTBK2/RNF43/CTNNB1/TP53/BCL9/SMAD3/APC/ZFP36L2/TGFBR2/MUC6/MAP3K1/CACNA1C/ATP8B1/CYP4B1\nbreast_fibroepithelial_tumours                                                                                          BCOR/SETD2/RB1/PCNX4/NF1/TP53/RARA/SYNE1/MAP3K1/ERBB4\n\n\n\n8.2.3 gseDGN fuction\n\ndgn &lt;- gseDGN(geneList,\n              pvalueCutoff  = 0.2,\n              pAdjustMethod = \"BH\",\n              verbose       = FALSE)\ndgn &lt;- setReadable(dgn, 'org.Hs.eg.db')\nhead(dgn, 3) \n\n               ID                  Description setSize enrichmentScore\nC0024266 C0024266 Lymphocytic Choriomeningitis     120       0.5712593\nC4721414 C4721414         Mantle cell lymphoma     368       0.4107437\nC0205682 C0205682              Waist-Hip Ratio     401      -0.4425633\n               NES pvalue    p.adjust       qvalue rank\nC0024266  2.405091  1e-10 2.05275e-07 1.754737e-07 2579\nC4721414  1.980385  1e-10 2.05275e-07 1.754737e-07 1745\nC0205682 -1.953671  1e-10 2.05275e-07 1.754737e-07 2011\n                           leading_edge\nC0024266 tags=48%, list=21%, signal=38%\nC4721414 tags=26%, list=14%, signal=23%\nC0205682 tags=28%, list=16%, signal=24%\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                core_enrichment\nC0024266                                                                                                                                                                                                                                                                                                                                                                                S100A9/CXCL10/CXCL9/EZH2/GZMB/ICOS/USP18/CXCL8/CTLA4/TREM1/PRF1/ADM/CA9/STAT1/CCL2/SELL/CDKN2A/IL7/IL7R/IFNG/CCR5/IL27RA/SH2D1A/FCER1G/CDK2AP2/CPVL/CD27/PSMB10/PTPN22/SLAMF1/KDM1A/TNF/IL6/FGL2/TLR2/RPAIN/NELFCD/PDCD1/WAS/HIF1A/ATP5F1B/FCGR2B/EGR2/STX11/CXCR3/TYROBP/YME1L1/SOSTDC1/PTPN2/TRAF1/HNF1A/IRF9/PML/NR0B2/IL2/TOX/AGFG1\nC4721414                                                                                                                                                                     CDC20/MELK/E2F8/APOBEC3B/PBK/TPX2/RAD51AP1/DUSP2/CDT1/EZH2/AURKB/CHEK1/AURKA/CCNB1/PSAT1/SOX11/PRAME/CDC6/PLK1/MMP9/EIF4EBP1/SPIB/RAD51/CD38/MMP7/MCM6/CTSC/LCK/MNX1/SKP2/STAT1/PRDM1/MS4A4A/IGK/MYC/PCNA/IFI27/PSMG1/CCR7/GMNN/E2F1/CDKN2A/PSMB9/NME1/LTB/IGHD/CD40LG/LAIR1/IGF2BP3/LBR/COL11A2/MSH2/CD79B/APRT/NSD2/CDK4/PTPRC/PLSCR1/CCR5/G6PD/CHEK2/HILPDA/DCK/PIM2/WNT3/CD6/CD28/MTAP/PRDX1/MRC1/TUBB3/VEGFA/CD19/HACD1/SOX4/PMCH/ST14/PARP1/TCL1A/DNMT1/IGLL5/SYK/TNF/MYCN/CD1D/NXT1/CDKN2B/RANGAP1/IL6/LTA/PSMD2/CXCR4/BCR/FCER2/FADD/PTGS2\nC0205682 RETREG3/JMJD1C/SH2B1/BDNF/ARHGEF26/PDE5A/BPTF/SMAD3/TTC39A/ATP2B1/ARID4A/HOXC4/NID1/LAMA4/LRRC36/NUDT18/ANKRD28/HECTD4/COL11A1/MEIS1/INSR/CUL9/NRIP3/BCL2/CD34/EZH1/DYM/NDST1/COL15A1/VGLL3/CCND1/ZCCHC10/HOXC6/RAB26/QTRT1/MEIS2/ARID5B/AHNAK/FGF1/CAPRIN2/LAMB1/CPEB3/ELOVL4/CDADC1/PDE8B/ZNF268/NRP1/SYTL2/NR5A2/DGLUCY/SEMA3B/NID2/SIK3/PRR5L/FGF2/COL8A1/RAPGEF3/RBM6/CDH13/JCAD/NAV3/TRIM8/PPIEL/PTPRG/NBL1/CALCRL/PPL/LPL/BCKDHB/MAPKBP1/CNTLN/BBS4/P4HTM/FTO/PDZRN4/PDGFC/SGCD/NRXN3/AFF3/IGF1R/ABCC8/MPPED2/COL5A1/COL6A2/LOXL1/CYP21A2/LTBP2/TTC28/PATJ/PCSK5/WNT4/TTC12/NISCH/ASTN2/TCEA2/MN1/SETBP1/TAOK1/MAST4/ITGA7/ITGBL1/COL14A1/C1QTNF3/ZNF423/IQCH/MYH11/ADH1B/ABLIM3/MAPT/STC2/TFAP2B/CYBRD1/SCUBE2",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Disease enrichment analysis</span>"
    ]
  },
  {
    "objectID": "025-do-enrichment.html#references",
    "href": "025-do-enrichment.html#references",
    "title": "8¬† Disease enrichment analysis",
    "section": "References",
    "text": "References\n\n\n\n\nA., Omer, Giovanni M. D., Thanos P. M., and Francesca D. C. 2016. ‚ÄúNCG 5.0: Updates of a Manually Curated Repository of Cancer Genes and Associated Properties from Cancer Mutational Screenings.‚Äù Nucleic Acids Research 44 (D1): D992‚Äì99. https://doi.org/10.1093/nar/gkv1123.\n\n\nJanet, P., N√∫ria Q. R., √Älex B., Jordi D. P., Anna B. M., Martin B., Ferran S., and Laura I. F. 2015. ‚ÄúDisGeNET: A Discovery Platform for the Dynamical Exploration of Human Diseases and Their Genes.‚Äù Database 2015 (March): bav028. https://doi.org/10.1093/database/bav028.\n\n\nSchriml, L. M., C. Arze, S. Nadendla, Y.-W. W. Chang, M. Mazaitis, V. Felix, G. Feng, and W. A. Kibbe. 2011. ‚ÄúDisease Ontology: A Backbone for Disease Semantic Integration.‚Äù Nucleic Acids Research 40 (D1): D940‚Äì46. https://doi.org/10.1093/nar/gkr972.\n\n\nYu, Guangchuang, Li-Gen Wang, Guang-Rong Yan, and Qing-Yu He. 2015. ‚ÄúDOSE: An r/Bioconductor Package for Disease Ontology Semantic and Enrichment Analysis.‚Äù Bioinformatics 31 (4): 608‚Äì9. https://doi.org/10.1093/bioinformatics/btu684.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Disease enrichment analysis</span>"
    ]
  },
  {
    "objectID": "026-meshes-enrichment.html",
    "href": "026-meshes-enrichment.html",
    "title": "9¬† MeSH enrichment analysis",
    "section": "",
    "text": "9.1 MeSH over-representation analysis\nThe meshes package (Yu 2018) supports enrichment analysis (over-representation analysis and gene set enrichment analysis) of gene list or whole expression profile using MeSH annotation. Data source from gendoo, gene2pubmed and RBBH are all supported. User can select interesting category to test. All 16 categories of MeSH are supported. The analysis supports about 200 species (see also Chapter 4 for more details).\nFirst, we need to load/fetch species-specific MeSH annotation database, please refer to ?sec-meshes-semantic-similarity.\nIn this example, we use data source from gendoo and C (Diseases) category.\nlibrary(meshes)\ndata(geneList, package=\"DOSE\")\nde &lt;- names(geneList)[1:100]\nx &lt;- enrichMeSH(de, MeSHDb = db, database='gendoo', category = 'C')\nhead(x)\n\n             ID            Description GeneRatio   BgRatio       pvalue\nD000705 D000705               Anaphase    26/100 232/26076 4.495523e-31\nD019926 D019926               Cyclin B    30/100 428/26076 1.061989e-29\nD018386 D018386           Kinetochores    24/100 224/26076 3.337217e-28\nD020090 D020090 Chromosome Segregation    26/100 362/26076 5.663108e-26\nD011123 D011123             Polyploidy    16/100 169/26076 3.951760e-18\nD016547 D016547                   &lt;NA&gt;    22/100 476/26076 6.849607e-18\n            p.adjust       qvalue\nD000705 2.036472e-27 1.360487e-27\nD019926 2.405404e-26 1.606957e-26\nD018386 5.039198e-25 3.366491e-25\nD020090 6.413470e-23 4.284588e-23\nD011123 3.580295e-15 2.391855e-15\nD016547 5.171453e-15 3.454845e-15\n                                                                                                                                                             geneID\nD000705                    991/2305/9493/1062/9133/10403/7153/6241/55165/11065/220134/22974/4751/983/54821/10232/4085/81930/332/3832/7272/9212/1111/9055/10112/6790\nD019926 991/2305/9493/1062/3868/4605/9133/10403/7153/23397/9787/11065/55872/83461/22974/890/983/10232/4085/5080/81620/332/3832/7272/64151/8208/1111/9055/10112/6790\nD018386                             55143/991/1062/10403/7153/9787/11065/220134/22974/10460/4751/79019/55839/983/54821/4085/81930/332/3832/7272/9212/1111/9055/6790\nD020090                   55143/991/2305/9493/1062/9133/10403/7153/9787/11065/51203/22974/10460/4751/79019/55839/983/54821/4085/81930/332/7272/64151/9212/1111/6790\nD011123                                                                             55143/991/2305/9493/1062/4605/9133/7153/890/10232/4085/81620/332/9212/1111/6790\nD016547                                        55143/2305/9493/1062/10403/7153/23397/9787/22974/983/4085/81930/332/3832/64151/9212/1111/9055/3833/146909/10112/6790\n        Count\nD000705    26\nD019926    30\nD018386    24\nD020090    26\nD011123    16\nD016547    22",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>MeSH enrichment analysis</span>"
    ]
  },
  {
    "objectID": "026-meshes-enrichment.html#meshes-gsea",
    "href": "026-meshes-enrichment.html#meshes-gsea",
    "title": "9¬† MeSH enrichment analysis",
    "section": "\n9.2 MeSH gene set enrichment analysis",
    "text": "9.2 MeSH gene set enrichment analysis\nIn the following example, we use data source from gene2pubmed and test category G (Phenomena and Processes).\n\ny &lt;- gseMeSH(geneList, MeSHDb = db, database = 'gene2pubmed', category = \"G\")\n\n\nhead(y)\n\n             ID                 Description setSize enrichmentScore      NES\nD000705 D000705                    Anaphase     208       0.6734041 3.051544\nD000917 D000917          Antibody Formation     423       0.3867818 1.890781\nD000938 D000938    Antigen-Presenting Cells     368       0.4324886 2.100038\nD002842 D002842                  Chromatids     119       0.5955590 2.518940\nD004250 D004250 DNA Topoisomerases, Type II     230       0.4663823 2.136691\nD004271 D004271                 DNA, Fungal     255       0.4894945 2.286548\n        pvalue     p.adjust      qvalues rank                   leading_edge\nD000705  1e-10 1.953462e-08 1.552429e-08 1071  tags=35%, list=9%, signal=33%\nD000917  1e-10 1.953462e-08 1.552429e-08 2101 tags=33%, list=17%, signal=28%\nD000938  1e-10 1.953462e-08 1.552429e-08 2111 tags=36%, list=17%, signal=30%\nD002842  1e-10 1.953462e-08 1.552429e-08 1804 tags=35%, list=14%, signal=30%\nD004250  1e-10 1.953462e-08 1.552429e-08 1815 tags=30%, list=15%, signal=27%\nD004271  1e-10 1.953462e-08 1.552429e-08 1447 tags=24%, list=12%, signal=22%\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        core_enrichment\nD000705                                                                                                                                                                                                                                                                                                                     991/2305/9493/1062/9133/10403/7153/6241/55165/11065/220134/22974/4751/983/54821/10232/4085/81930/332/3832/7272/9212/1111/9055/10112/6790/891/24137/9232/1164/11004/990/5347/29127/701/11130/57405/1894/9700/5888/56992/4998/10733/29899/699/4609/1063/5111/5688/5709/26271/55055/51053/641/5698/1719/3925/5693/8317/5713/3930/5721/5691/10051/5685/8568/4172/23481/5690/5684/5885/5686/5695\nD000917 7153/10563/10232/332/6286/3002/891/6364/3161/29851/4102/2173/9156/6890/56992/952/1493/7037/10663/80380/7378/5551/133/768/1230/6772/6347/30848/639/914/3126/3112/4609/3945/3001/8000/3561/5111/6614/917/6472/1236/362/1719/3575/919/915/4067/608/3458/959/3903/1043/3702/925/5450/3351/50615/974/942/4100/8547/91860/578/3329/3514/1116/4072/2597/1234/916/7096/3383/4068/962/8884/5806/1514/100/3659/2919/3929/971/1476/10541/939/4678/3965/6891/9308/7422/930/5992/7439/26191/6504/117178/4282/6850/2395/7124/912/7783/5329/3569/7097/613/1410/5133/5743/7454/348/4151/3091/3119/5817/1133/551/1956/1830/7186/2213/5971/7490/8456/1959/2650/60489/6376/9021/3596/79444/7293/23415/2833/1080/356/1380/958/64663\nD000938                                   3627/4283/10232/6362/332/3002/3902/3620/10578/6364/23532/3595/4102/4061/3576/6890/952/8792/1493/6352/7804/7037/56833/3932/80380/5551/3559/1230/6772/51311/6347/30848/914/64581/3126/3112/10437/3945/5341/3561/2533/6351/6614/1236/10859/9332/3654/5698/1719/4050/919/4067/11184/3458/1520/959/3930/3702/5641/942/4100/1116/10288/6361/5788/976/916/7096/259197/3383/9466/4068/962/3937/6367/3394/1834/1514/3600/23457/923/940/3929/4793/971/4063/6360/9051/5588/6891/9308/81622/10148/6404/3738/5699/5047/929/4690/5604/7124/912/3569/7097/1378/613/5133/8772/5743/4055/7454/348/4151/3119/5817/951/1240/8440/2213/5971/3135/9047/6376/56915/9021/7293/2833/4478/356/958/1672\nD002842                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           991/1062/7153/55165/11065/10635/983/54821/4085/332/9212/1111/9232/1164/5347/701/10615/79075/9700/5888/2237/5984/699/5111/9401/1719/5982/9735/10051/5885/203068/100/5983/10592/4683/999/3014/3619/7454/10393/1663/7517\nD004250                                                                                                                                                                                                                                                                                                                                                     1062/7153/23397/983/54821/4085/81620/332/9212/1111/4174/4171/993/990/5347/9700/5888/23594/4998/3934/4175/4173/9918/699/50802/4609/5111/84823/641/1869/1029/1719/4904/4067/2178/7086/4176/2950/9585/4436/3066/578/995/1104/1019/637/5359/4172/916/5885/11200/1633/7027/2072/4839/10592/1244/142/23028/5160/3014/7124/5329/3619/10096/613/8772/5743/3091/9513\nD004271                                                                                                                                                                                                                                                                                                                                                                                       8318/55388/1062/7153/81620/51659/1111/4174/4171/993/990/2173/9156/9700/5888/23594/4998/4175/4173/2237/10926/5984/699/5341/5111/64785/641/1869/10535/1719/4904/8317/4938/4176/80142/10036/5435/5982/5499/30001/578/995/1104/2597/4172/5479/10606/11200/7428/1317/2072/5831/4839/80010/4360/5440/79924/4683/81034/63967/999\n\n\nUser can use visualization methods implemented in enrichplot to visualize these enrichment results. With these visualization methods, it‚Äôs much easier to interpret enriched results.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>MeSH enrichment analysis</span>"
    ]
  },
  {
    "objectID": "026-meshes-enrichment.html#references",
    "href": "026-meshes-enrichment.html#references",
    "title": "9¬† MeSH enrichment analysis",
    "section": "References",
    "text": "References\n\n\n\n\nYu, Guangchuang. 2018. ‚ÄúUsing Meshes for MeSH Term Enrichment and Semantic Analyses.‚Äù Bioinformatics 34 (21): 3766‚Äì67. https://doi.org/10.1093/bioinformatics/bty410.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>MeSH enrichment analysis</span>"
    ]
  },
  {
    "objectID": "027-universal-enrichment.html",
    "href": "027-universal-enrichment.html",
    "title": "10¬† Universal enrichment analysis",
    "section": "",
    "text": "10.1 Input data\nThe clusterProfiler package (Yu et al. 2012) supports both hypergeometric test and gene set enrichment analyses of many ontology/pathway, but it‚Äôs still not enough for users may want to analyze their data with unsupported organisms, slim version of GO, novel functional annotation (e.g.¬†GO via BlastGO or KEGG via KAAS), unsupported ontologies/pathways or customized annotations.\nThe clusterProfiler package provides enricher() function for hypergeometric test and GSEA() function for gene set enrichment analysis that are designed to accept user defined annotation. They accept two additional parameters TERM2GENE and TERM2NAME. As indicated in the parameter names, TERM2GENE is a data.frame with first column of term ID and second column of corresponding mapped gene and TERM2NAME is a data.frame with first column of term ID and second column of corresponding term name. TERM2NAME is optional.\nFor over representation analysis, all we need is a gene vector, that is a vector of gene IDs. These gene IDs can be obtained by differential expression analysis (e.g. with the DESeq2 package).\nFor gene set enrichment analysis, we need a ranked list of genes. DOSE provides an example dataset geneList which was derived from R package breastCancerMAINZ that contained 200 samples, including 29 samples in grade I, 136 samples in grade II and 35 samples in grade III. We computed the ratios of geometric means of grade III samples versus geometric means of grade I samples. Logarithm of these ratios (base 2) were stored in geneList dataset. If you want to prepare your own geneList, please refer to the FAQ.\nWe can load the sample data into R via:\ndata(geneList, package=\"DOSE\")\nhead(geneList)\n\n    4312     8318    10874    55143    55388      991 \n4.572613 4.514594 4.418218 4.144075 3.876258 3.677857\nSuppose we define fold change greater than 2 as DEGs:\ngene &lt;- names(geneList)[abs(geneList) &gt; 2]\nhead(gene)\n\n[1] \"4312\"  \"8318\"  \"10874\" \"55143\" \"55388\" \"991\"",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>10</span>¬† <span class='chapter-title'>Universal enrichment analysis</span>"
    ]
  },
  {
    "objectID": "027-universal-enrichment.html#cell-marker",
    "href": "027-universal-enrichment.html#cell-marker",
    "title": "10¬† Universal enrichment analysis",
    "section": "\n10.2 Cell Marker",
    "text": "10.2 Cell Marker\n\n\n# not execcute, as the url is no longer valid\n\n## cell_marker_data &lt;- vroom::vroom('http://bio-bigdata.hrbmu.edu.cn/CellMarker/download/Human_cell_markers.txt')\nurl &lt;- \"http://yikedaxue.slwshop.cn/Cell_marker_Human.xlsx\"\nf &lt;- tempfile(fileext = \".xlsx\")\ndownload.file(url, f)\n\ncell_marker_data &lt;- readxl::read_excel(f, 1)\n\n\n## instead of `cellName`, users can use other features (e.g. `cancerType`)\ncells &lt;- cell_marker_data %&gt;%\n    dplyr::select('Cell name', GeneID) %&gt;%\n    dplyr::mutate(GeneID = strsplit(GeneID, ', ')) %&gt;%\n    tidyr::unnest(cols = c(GeneID))\n\n\n10.2.1 Cell Marker over-presentaton analysis\n\nx &lt;- enricher(gene, TERM2GENE = cells)\nhead(x)\n\n\n10.2.2 Cell Marker gene set enrichment analysis\n\ny &lt;- GSEA(geneList, TERM2GENE = cells)\nhead(y)",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>10</span>¬† <span class='chapter-title'>Universal enrichment analysis</span>"
    ]
  },
  {
    "objectID": "027-universal-enrichment.html#msigdb-analysis",
    "href": "027-universal-enrichment.html#msigdb-analysis",
    "title": "10¬† Universal enrichment analysis",
    "section": "\n10.3 MSigDb analysis",
    "text": "10.3 MSigDb analysis\nMolecular Signatures Database is a collection of annotated gene sets. It contains 8 major collections:\n\nH: hallmark gene sets\nC1: positional gene sets\nC2: curated gene sets\nC3: motif gene sets\nC4: computational gene sets\nC5: GO gene sets\nC6: oncogenic signatures\nC7: immunologic signatures\n\nUsers can download GMT files from Broad Institute and use the read.gmt() function to parse the file to be used in enricher() and GSEA().\nThere is an R package, msigdbr, that already packed the MSigDB gene sets in tidy data format that can be used directly with clusterProfiler (Yu et al. 2012).\nIt supports several specices:\n\nlibrary(msigdbr)\nmsigdbr_species()\n\n# A tibble: 20 √ó 2\n   species_name                    species_common_name                          \n   &lt;chr&gt;                           &lt;chr&gt;                                        \n 1 Anolis carolinensis             Carolina anole, green anole                  \n 2 Bos taurus                      bovine, cattle, cow, dairy cow, domestic cat‚Ä¶\n 3 Caenorhabditis elegans          &lt;NA&gt;                                         \n 4 Canis lupus familiaris          dog, dogs                                    \n 5 Danio rerio                     leopard danio, zebra danio, zebra fish, zebr‚Ä¶\n 6 Drosophila melanogaster         fruit fly                                    \n 7 Equus caballus                  domestic horse, equine, horse                \n 8 Felis catus                     cat, cats, domestic cat                      \n 9 Gallus gallus                   bantam, chicken, chickens, Gallus domesticus \n10 Homo sapiens                    human                                        \n11 Macaca mulatta                  rhesus macaque, rhesus macaques, Rhesus monk‚Ä¶\n12 Monodelphis domestica           gray short-tailed opossum                    \n13 Mus musculus                    house mouse, mouse                           \n14 Ornithorhynchus anatinus        duck-billed platypus, duckbill platypus, pla‚Ä¶\n15 Pan troglodytes                 chimpanzee                                   \n16 Rattus norvegicus               brown rat, Norway rat, rat, rats             \n17 Saccharomyces cerevisiae        baker's yeast, brewer's yeast, S. cerevisiae \n18 Schizosaccharomyces pombe 972h- &lt;NA&gt;                                         \n19 Sus scrofa                      pig, pigs, swine, wild boar                  \n20 Xenopus tropicalis              tropical clawed frog, western clawed frog    \n\n\nWe can retrieve all human gene sets:\n\nm_df &lt;- msigdbr(species = \"Homo sapiens\")\nhead(m_df, 2) |&gt; as.data.frame()\n\n  gene_symbol ncbi_gene    ensembl_gene db_gene_symbol db_ncbi_gene\n1       ABCC4     10257 ENSG00000125257          ABCC4        10257\n2    ABRAXAS2     23172 ENSG00000165660       ABRAXAS2        23172\n  db_ensembl_gene source_gene  gs_id        gs_name gs_collection\n1 ENSG00000125257       ABCC4 M12609 AAACCAC_MIR140            C3\n2 ENSG00000165660    KIAA0157 M12609 AAACCAC_MIR140            C3\n  gs_subcollection gs_collection_name\n1   MIR:MIR_LEGACY         MIR_Legacy\n2   MIR:MIR_LEGACY         MIR_Legacy\n                                                                                                                                                                                          gs_description\n1 Genes having at least one occurence of the motif AAACCAC in their 3' untranslated region. The motif represents putative target (that is, seed match) of human mature miRNA hsa-miR-140 (v7.1 miRBase).\n2 Genes having at least one occurence of the motif AAACCAC in their 3' untranslated region. The motif represents putative target (that is, seed match) of human mature miRNA hsa-miR-140 (v7.1 miRBase).\n  gs_source_species gs_pmid gs_geoid gs_exact_source gs_url db_version\n1                HS                                          2025.1.Hs\n2                HS                                          2025.1.Hs\n  db_target_species\n1                HS\n2                HS\n\n\nOr specific collection. Here we use C6, oncogenic gene sets as an example:\n\nm_t2g &lt;- m_df |&gt;\n  dplyr::filter(gs_collection == \"C6\") |&gt;\n  dplyr::select(gs_name, ncbi_gene)\nhead(m_t2g)\n\n# A tibble: 6 √ó 2\n  gs_name      ncbi_gene\n  &lt;chr&gt;        &lt;chr&gt;    \n1 AKT_UP.V1_DN 57007    \n2 AKT_UP.V1_DN 22859    \n3 AKT_UP.V1_DN 137872   \n4 AKT_UP.V1_DN 249      \n5 AKT_UP.V1_DN 271      \n6 AKT_UP.V1_DN 51129    \n\n\n\n10.3.1 MSigDb over-presentaton analysis\n\nem &lt;- enricher(gene, TERM2GENE=m_t2g)\nhead(em)\n\n                                           ID            Description GeneRatio\nRPS14_DN.V1_DN                 RPS14_DN.V1_DN         RPS14_DN.V1_DN    22/183\nGCNP_SHH_UP_LATE.V1_UP GCNP_SHH_UP_LATE.V1_UP GCNP_SHH_UP_LATE.V1_UP    16/183\nPRC2_EZH2_UP.V1_DN         PRC2_EZH2_UP.V1_DN     PRC2_EZH2_UP.V1_DN    15/183\nVEGF_A_UP.V1_DN               VEGF_A_UP.V1_DN        VEGF_A_UP.V1_DN    15/183\nRB_P107_DN.V1_UP             RB_P107_DN.V1_UP       RB_P107_DN.V1_UP    10/183\nE2F1_UP.V1_UP                   E2F1_UP.V1_UP          E2F1_UP.V1_UP    12/183\n                         BgRatio RichFactor FoldEnrichment    zScore\nRPS14_DN.V1_DN         186/10927 0.11827957       7.062518 10.883293\nGCNP_SHH_UP_LATE.V1_UP 181/10927 0.08839779       5.278266  7.574549\nPRC2_EZH2_UP.V1_DN     192/10927 0.07812500       4.664874  6.686237\nVEGF_A_UP.V1_DN        193/10927 0.07772021       4.640703  6.659725\nRB_P107_DN.V1_UP       130/10927 0.07692308       4.593106  5.378527\nE2F1_UP.V1_UP          188/10927 0.06382979       3.811301  5.074316\n                             pvalue     p.adjust       qvalue\nRPS14_DN.V1_DN         4.615656e-13 7.800459e-11 6.364747e-11\nGCNP_SHH_UP_LATE.V1_UP 5.729300e-08 4.841259e-06 3.950202e-06\nPRC2_EZH2_UP.V1_DN     7.531662e-07 3.400322e-05 2.774476e-05\nVEGF_A_UP.V1_DN        8.048099e-07 3.400322e-05 2.774476e-05\nRB_P107_DN.V1_UP       6.370479e-05 2.005313e-03 1.636225e-03\nE2F1_UP.V1_UP          7.445084e-05 2.005313e-03 1.636225e-03\n                                                                                                                                       geneID\nRPS14_DN.V1_DN         10874/55388/991/9493/1062/4605/9133/23397/79733/9787/55872/83461/54821/51659/9319/9055/10112/4174/5105/2532/7021/79901\nGCNP_SHH_UP_LATE.V1_UP                                      55388/7153/79733/6241/9787/51203/983/9212/1111/9319/9055/3833/6790/4174/3169/1580\nPRC2_EZH2_UP.V1_DN                                          8318/55388/4605/23397/9787/55355/10460/6362/81620/2146/7272/9212/11182/3887/24137\nVEGF_A_UP.V1_DN                                                   8318/9493/1062/9133/10403/6241/9787/4085/332/3832/7272/891/23362/2167/10234\nRB_P107_DN.V1_UP                                                                         8318/23397/79733/6241/4085/8208/9055/24137/4174/1307\nE2F1_UP.V1_UP                                                                  55388/7153/23397/79733/9787/2146/2842/9212/8208/1111/9055/3833\n                       Count\nRPS14_DN.V1_DN            22\nGCNP_SHH_UP_LATE.V1_UP    16\nPRC2_EZH2_UP.V1_DN        15\nVEGF_A_UP.V1_DN           15\nRB_P107_DN.V1_UP          10\nE2F1_UP.V1_UP             12\n\n\n\n10.3.2 MSigDb gene set enrichment analysis\nIn over-presentaton analysis, we use oncogenic gene sets (i.e.¬†C6) to test whether the DE genes are involved in the process that leads to cancer. In this example, we will use the C3 category to test whether genes are up/down-regulated by sharing specific motif using GSEA approach.\n\nC3_t2g &lt;- m_df |&gt;\n  dplyr::filter(gs_collection == \"C3\") |&gt;\n  dplyr::select(gs_name, ncbi_gene)\nhead(C3_t2g)\n\n# A tibble: 6 √ó 2\n  gs_name        ncbi_gene\n  &lt;chr&gt;          &lt;chr&gt;    \n1 AAACCAC_MIR140 10257    \n2 AAACCAC_MIR140 23172    \n3 AAACCAC_MIR140 81       \n4 AAACCAC_MIR140 90       \n5 AAACCAC_MIR140 8754     \n6 AAACCAC_MIR140 11096    \n\nem2 &lt;- GSEA(geneList, TERM2GENE = C3_t2g)\nhead(em2)\n\n                                       ID          Description setSize\nHSD17B8_TARGET_GENES HSD17B8_TARGET_GENES HSD17B8_TARGET_GENES     400\nE2F1_Q3                           E2F1_Q3              E2F1_Q3     187\nE2F1_Q6                           E2F1_Q6              E2F1_Q6     185\nSGCGSSAAA_E2F1DP2_01 SGCGSSAAA_E2F1DP2_01 SGCGSSAAA_E2F1DP2_01     129\nE2F_Q6                             E2F_Q6               E2F_Q6     190\nE2F1DP1_01                     E2F1DP1_01           E2F1DP1_01     184\n                     enrichmentScore      NES       pvalue     p.adjust\nHSD17B8_TARGET_GENES       0.6375083 3.089450 1.000000e-10 1.650500e-07\nE2F1_Q3                    0.4983913 2.232817 1.000000e-10 1.650500e-07\nE2F1_Q6                    0.4906657 2.199247 3.310158e-10 3.642277e-07\nSGCGSSAAA_E2F1DP2_01       0.5408182 2.267070 5.733592e-10 4.731647e-07\nE2F_Q6                     0.4672345 2.100641 1.756396e-09 9.155890e-07\nE2F1DP1_01                 0.4675989 2.096925 2.218937e-09 9.155890e-07\n                           qvalue rank                   leading_edge\nHSD17B8_TARGET_GENES 1.307895e-07 1042  tags=36%, list=8%, signal=34%\nE2F1_Q3              1.307895e-07 2045 tags=36%, list=16%, signal=30%\nE2F1_Q6              2.886225e-07 1819 tags=34%, list=15%, signal=30%\nSGCGSSAAA_E2F1DP2_01 3.749467e-07 1797 tags=38%, list=14%, signal=33%\nE2F_Q6               7.255341e-07 1663 tags=29%, list=13%, signal=25%\nE2F1DP1_01           7.255341e-07 1797 tags=33%, list=14%, signal=28%\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            core_enrichment\nHSD17B8_TARGET_GENES 55143/55388/991/2305/9493/1062/4605/9833/9133/10403/7153/23397/79733/259266/6241/55165/9787/11065/55355/9582/220134/55872/83461/10460/4751/10635/55839/890/9415/983/54821/4085/9837/5080/332/7272/64151/2842/9212/51659/9319/9055/3833/146909/10112/51514/4174/9232/1033/9928/3161/11004/993/4603/79801/990/5347/55215/701/55723/51512/55635/9156/11130/10024/57405/10615/1894/2491/8438/9700/5888/7083/898/3149/56992/9768/4288/10733/1163/4175/5307/2237/29899/55010/59336/56942/5984/29028/3838/1058/54478/3015/699/6491/81611/1063/27346/64785/9401/26271/51026/641/1869/10535/1029/28998/1763/8970/54892/55159/864/93594/1789/4176/7111/3148/116832/9585/9735/55732/81624/23310/1871/1031/79915/995/10051/30012/1104/80178/78995/7468/284403/5230/8549/7884/5558/4172/5424/79866/3182/56902/83990\nE2F1_Q3                                                                                                                                                                                                                                                                                                                                                                                                                                                 79733/6241/983/5080/2146/8715/4171/993/990/56992/9768/4998/10733/7037/4175/54962/54954/29028/3015/2643/85236/5111/64785/26271/51053/1869/3925/114/5427/4176/7112/4436/1871/79915/9088/6632/284403/7290/2597/7398/4172/5424/124222/1633/10849/9824/4678/6646/29902/63967/56886/6059/23234/1786/204/51087/23636/2048/83463/10393/79173/688/3007/79677/9462/56946/9221\nE2F1_Q6                                                                                                                                                                                                                                                                                                                                                                                                                                                                          79733/6241/983/5080/81620/2146/4171/993/990/3159/9768/4998/4175/4173/29028/3015/4609/85236/5111/64785/26271/51053/1869/3925/5427/4176/7112/5902/4436/1871/79915/9088/6632/284403/7290/2597/4172/5424/124222/1633/10849/7374/9824/2189/4678/2289/6646/29902/50/63967/56886/23234/6839/1786/204/51087/23636/11335/1174/83463/10492/79173/688\nSGCGSSAAA_E2F1DP2_01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     79733/6241/4171/993/990/3159/9768/4175/4173/29028/3015/4609/85236/5111/64785/26271/51053/1869/5427/4176/5902/4436/1871/79915/9088/6632/284403/7290/4172/5424/124222/1633/7374/2189/4678/2289/50/63967/56886/23234/6839/1786/204/51087/23636/1174/83463/10492/79173\nE2F_Q6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      8318/79733/6241/983/5080/81620/2146/4171/993/990/5888/9768/4175/4173/29028/3015/85236/5111/64785/26271/51053/1869/3925/5427/23649/4176/7112/5902/4436/1871/79915/9088/6632/284403/7290/2597/4172/5424/124222/1633/10849/7374/9824/7353/4678/6646/50/63967/56886/23234/1786/204/6427/51087/23636\nE2F1DP1_01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       79733/6241/983/5080/2146/4171/993/990/3159/9768/4175/4173/29028/3015/4609/85236/5111/64785/26271/51053/1869/3925/5427/4176/7112/5902/4436/1871/79915/9088/6632/284403/7290/2597/4172/5424/124222/1633/10849/7374/9824/2189/4678/2289/6646/50/63967/5457/56886/23234/6839/1786/204/51087/23636/11335/1174/83463/10492/79173",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>10</span>¬† <span class='chapter-title'>Universal enrichment analysis</span>"
    ]
  },
  {
    "objectID": "027-universal-enrichment.html#references",
    "href": "027-universal-enrichment.html#references",
    "title": "10¬† Universal enrichment analysis",
    "section": "References",
    "text": "References\n\n\n\n\nYu, Guangchuang, Le-Gen Wang, Yanyan Han, and Qing-Yu He. 2012. ‚ÄúclusterProfiler: An r Package for Comparing Biological Themes Among Gene Clusters.‚Äù OMICS: A Journal of Integrative Biology 16 (5): 284‚Äì87. https://doi.org/10.1089/omi.2011.0118.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>10</span>¬† <span class='chapter-title'>Universal enrichment analysis</span>"
    ]
  },
  {
    "objectID": "028-chipseeker.html",
    "href": "028-chipseeker.html",
    "title": "11¬† Functional enrichment analysis of genomic coordinations",
    "section": "",
    "text": "References\nFunctional analysis using NGS data (eg, RNA-Seq and ChIP-Seq) can be performed by linking coding and non-coding regions to coding genes via r Biocpkg(\"ChIPseeker\") (Yu, Wang, and He 2015) package, which can annotates genomic regions to their nearest genes, host genes, and flanking genes respectivly. In addtion, it provides a function, seq2gene, that simultaneously considering host genes, promoter region and flanking gene from intergenic region that may under control via cis-regulation. This function maps genomic regions to genes in a many-to-many manner and facilitate functional analysis. For more details, please refer to r Biocpkg(\"ChIPseeker\") (Yu, Wang, and He 2015).",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>11</span>¬† <span class='chapter-title'>Functional enrichment analysis of genomic coordinations</span>"
    ]
  },
  {
    "objectID": "028-chipseeker.html#references",
    "href": "028-chipseeker.html#references",
    "title": "11¬† Functional enrichment analysis of genomic coordinations",
    "section": "",
    "text": "Yu, Guangchuang, Li-Gen Wang, and Qing-Yu He. 2015. ‚ÄúChIPseeker: An r/Bioconductor Package for ChIP Peak Annotation, Comparison and Visualization.‚Äù Bioinformatics 31 (14): 2382‚Äì83. https://doi.org/10.1093/bioinformatics/btv145.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>11</span>¬† <span class='chapter-title'>Functional enrichment analysis of genomic coordinations</span>"
    ]
  },
  {
    "objectID": "029-compareCluster.html",
    "href": "029-compareCluster.html",
    "title": "12¬† Biological theme comparison",
    "section": "",
    "text": "12.1 Comparing multiple gene lists\nThe clusterProfiler package was developed for biological theme comparison (Yu et al. 2012; Wu et al. 2021), and it provides a function, compareCluster, to automatically calculate enriched functional profiles of each gene clusters and aggregate the results into a single object. Comparing functional profiles can reveal functional consensus and differences among different experiments and helps in identifying differential functional modules in omics datasets.\nThe compareCluster() function applies selected function (via the fun parameter) to perform enrichment analysis for each gene list.\ndata(gcSample)\nstr(gcSample) \n\nList of 8\n $ X1: chr [1:216] \"4597\" \"7111\" \"5266\" \"2175\" ...\n $ X2: chr [1:805] \"23450\" \"5160\" \"7126\" \"26118\" ...\n $ X3: chr [1:392] \"894\" \"7057\" \"22906\" \"3339\" ...\n $ X4: chr [1:838] \"5573\" \"7453\" \"5245\" \"23450\" ...\n $ X5: chr [1:929] \"5982\" \"7318\" \"6352\" \"2101\" ...\n $ X6: chr [1:585] \"5337\" \"9295\" \"4035\" \"811\" ...\n $ X7: chr [1:582] \"2621\" \"2665\" \"5690\" \"3608\" ...\n $ X8: chr [1:237] \"2665\" \"4735\" \"1327\" \"3192\" ...\nUsers can use a named list of gene IDs as the input that passed to the geneCluster parameter.\nck &lt;- compareCluster(geneCluster = gcSample, fun = enrichGO, \n                    OrgDb = org.Hs.eg.db, ont=\"BP\")\nck &lt;- setReadable(ck, OrgDb = org.Hs.eg.db, keyType=\"ENTREZID\")\nhead(ck) \n\n  Cluster         ID\n1      X1 GO:0021978\n2      X1 GO:0060707\n3      X1 GO:0061844\n4      X1 GO:0019730\n5      X1 GO:0086005\n6      X1 GO:0061351\n                                                              Description\n1                                           telencephalon regionalization\n2                                  trophoblast giant cell differentiation\n3 antimicrobial humoral immune response mediated by antimicrobial peptide\n4                                          antimicrobial humoral response\n5                        ventricular cardiac muscle cell action potential\n6                                     neural precursor cell proliferation\n  GeneRatio   BgRatio RichFactor FoldEnrichment    zScore       pvalue\n1     4/199  13/18860 0.30769231      29.161191 10.488659 7.981530e-06\n2     4/199  14/18860 0.28571429      27.078248 10.079785 1.108195e-05\n3     9/199 135/18860 0.06666667       6.318258  6.403889 1.345178e-05\n4    10/199 184/18860 0.05434783       5.150754  5.842684 2.659639e-05\n5     5/199  38/18860 0.13157895      12.470246  7.308867 4.703787e-05\n6     9/199 168/18860 0.05357143       5.077172  5.481560 7.544726e-05\n    p.adjust     qvalue\n1 0.01194966 0.01103518\n2 0.01194966 0.01103518\n3 0.01194966 0.01103518\n4 0.01771985 0.01636378\n5 0.02507118 0.02315253\n6 0.02879290 0.02658943\n                                                    geneID Count\n1                                      PAX6/LHX2/EMX1/EMX2     4\n2                                     SOX15/GJB5/PLK4/ELF5     4\n3     CCL20/BPI/KNG1/PLA2G1B/CXCL3/CXCL8/H2BC11/CXCL5/MUC7     9\n4 PI3/CCL20/BPI/KNG1/PLA2G1B/CXCL3/CXCL8/H2BC11/CXCL5/MUC7    10\n5                           SCN3B/KCNH2/KCND3/KCNE5/CTNNA3     5\n6             NF2/PAX6/LHX2/FZD9/LHX5/EPHB1/EMX1/LEF1/EMX2     9",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>12</span>¬† <span class='chapter-title'>Biological theme comparison</span>"
    ]
  },
  {
    "objectID": "029-compareCluster.html#formula-interface-of-comparecluster",
    "href": "029-compareCluster.html#formula-interface-of-comparecluster",
    "title": "12¬† Biological theme comparison",
    "section": "\n12.2 Formula interface of compareCluster",
    "text": "12.2 Formula interface of compareCluster\nAs an alternaitve to using named list, the compareCluster() function also supports passing a formula to describe more complicated experimental designs (e.g., \\(Gene \\sim time + treatment\\)).\n\ndata(geneList, package='DOSE')\nmydf &lt;- data.frame(Entrez=names(geneList), FC=geneList)\nmydf &lt;- mydf[abs(mydf$FC) &gt; 1,]\nmydf$group &lt;- \"upregulated\"\nmydf$group[mydf$FC &lt; 0] &lt;- \"downregulated\"\nmydf$othergroup &lt;- \"A\"\nmydf$othergroup[abs(mydf$FC) &gt; 2] &lt;- \"B\"\n\nformula_res &lt;- compareCluster(Entrez~group+othergroup, data=mydf, \n                            fun=enrichGO, OrgDb = org.Hs.eg.db, ont=\"BP\")\n  \nhead(formula_res)\n\n          Cluster         group othergroup         ID\n1 downregulated.A downregulated          A GO:0061448\n2 downregulated.A downregulated          A GO:0030198\n3 downregulated.A downregulated          A GO:0043062\n4 downregulated.A downregulated          A GO:0045229\n5 downregulated.A downregulated          A GO:0051216\n6 downregulated.A downregulated          A GO:0007178\n                                                              Description\n1                                           connective tissue development\n2                                       extracellular matrix organization\n3                                    extracellular structure organization\n4                           external encapsulating structure organization\n5                                                   cartilage development\n6 cell surface receptor protein serine/threonine kinase signaling pathway\n  GeneRatio   BgRatio RichFactor FoldEnrichment   zScore       pvalue\n1    37/632 307/18860 0.12052117       3.596565 8.541020 1.602803e-11\n2    35/632 331/18860 0.10574018       3.155474 7.366806 2.040034e-09\n3    35/632 332/18860 0.10542169       3.145970 7.345591 2.209743e-09\n4    35/632 333/18860 0.10510511       3.136523 7.324457 2.392722e-09\n5    25/632 216/18860 0.11574074       3.453909 6.754047 7.258181e-08\n6    37/632 446/18860 0.08295964       2.475663 5.872578 4.170243e-07\n      p.adjust       qvalue\n1 7.255888e-08 6.137891e-08\n2 2.707963e-06 2.290716e-06\n3 2.707963e-06 2.290716e-06\n4 2.707963e-06 2.290716e-06\n5 6.571557e-05 5.559002e-05\n6 3.010653e-04 2.546768e-04\n                                                                                                                                                                                           geneID\n1     1281/4023/54360/582/7227/81029/3952/585/1513/79068/4488/6653/2202/85477/4856/7494/6097/7481/5159/1396/1289/116039/2690/8817/9658/7704/633/4487/658/2737/5744/2121/2487/1746/6935/3479/80310\n2            2192/1281/10218/50509/4319/1290/25903/1513/7075/11096/4313/2621/2191/1471/11117/857/1289/3908/4016/83716/1296/4035/3249/1842/165/10631/1805/2331/3913/4982/7177/7049/2006/7373/10266\n3            2192/1281/10218/50509/4319/1290/25903/1513/7075/11096/4313/2621/2191/1471/11117/857/1289/3908/4016/83716/1296/4035/3249/1842/165/10631/1805/2331/3913/4982/7177/7049/2006/7373/10266\n4            2192/1281/10218/50509/4319/1290/25903/1513/7075/11096/4313/2621/2191/1471/11117/857/1289/3908/4016/83716/1296/4035/3249/1842/165/10631/1805/2331/3913/4982/7177/7049/2006/7373/10266\n5                                                                  1281/54360/582/7227/81029/3952/1513/4488/2202/85477/4856/7481/116039/2690/8817/7704/633/4487/658/2737/5744/2121/2487/1746/6935\n6 55198/6469/4681/4926/1281/2530/65997/11167/58495/1149/55273/51232/4488/6653/3625/91851/10468/3693/4856/7494/11117/857/4053/7041/4035/4487/658/2615/5654/2331/7043/6935/9863/2200/7049/7122/6424\n  Count\n1    37\n2    35\n3    35\n4    35\n5    25\n6    37",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>12</span>¬† <span class='chapter-title'>Biological theme comparison</span>"
    ]
  },
  {
    "objectID": "029-compareCluster.html#vis-compare-profile",
    "href": "029-compareCluster.html#vis-compare-profile",
    "title": "12¬† Biological theme comparison",
    "section": "\n12.3 Visualization of functional profile comparison",
    "text": "12.3 Visualization of functional profile comparison\n\n12.3.1 Dot plot\nWe can visualize the result using the dotplot() method.\n\ndotplot(ck)\ndotplot(formula_res)\n\n\n\n\n\n\n\n\nFigure¬†12.1: Comparing enrichment results of multiple gene lists. (A) Using a named list of gene clusters, the results were displayed as multiple columns with each one represents an enrichment result of a gene cluster. (B) Using formula interface, the columns represent gene clusters defined by the formula.\n\n\n\n\nThe fomula interface allows more complicated gene cluster definition. In Figure¬†12.1(B), the gene clusters were defined by two variables (i.e.¬†group that divides genes into upregulated and downregulated and othergroup that divides the genes into two categories of A and B.). The dotplot() function allows us to use one variable to divide the result into different facet and plot the result with other variables in each facet panel (Figure¬†12.2).\n\ndotplot(formula_res, x=\"group\") + facet_grid(~othergroup)\n\n\n\n\n\n\nFigure¬†12.2: Comparing enrichment results of multiple gene lists defined by multiple variable. The results were visualized as a dot plot with an x-axis representing one level of conditions (the group variable) and a facet panel indicating another level of conditions (the othergroup variable).\n\n\n\n\nBy default, only top 5 (most significant) categories of each cluster was plotted. User can changes the parameter showCategory to specify how many categories of each cluster to be plotted, and if showCategory was set to NULL, the whole result will be plotted. The showCategory parameter also allows passing a vector of selected categories to plot pathway of interests\nThe dotplot() function tries to make the comparison among different clusters more informative and reasonable. After extracting e.g. 10 categories for each clusters, clusterProfiler tries to collect overlap of these categories among clusters. For example, term A is enriched in all the gene clusters (e.g., g1 and g2) and is in the 10 most significant categories of g1 but not g2. clusterProfiler will capture this information and include term A in g2 cluster to make the comparison in dotplot more reasonable. If users want to ignore these information, they can set includeAll = FALSE in dotplot(), which is not recommended.\nThe dotplot() function accepts a parameter size for setting the scale of dot sizes. The default parameter size is setting to geneRatio, which corresponding to the GeneRatio column of the output. If it was setting to count, the comparison will be based on gene counts, while if setting to rowPercentage, the dot sizes will be normalized by count/(sum of each row). Users can also map the dot size to other variables or derived variables (see Chapter 16).\nTo provide the full information, we also provide number of identified genes in each category (numbers in parentheses) when by is setting to rowPercentage and number of gene clusters in each cluster label (numbers in parentheses) when by is setting to geneRatio, as shown in Figure Figure¬†12.1.\nThe p-values indicate that which categories are more likely to have biological meanings. The dots in the plot are color-coded based on their corresponding adjusted p-values. Color gradient ranging from red to blue correspond to the order of increasing adjusted p-values. That is, red indicate low p-values (high enrichment), and blue indicate high p-values (low enrichment). Adjusted p-values were filtered out by the threshold giving by the parameter pvalueCutoff, and FDR can be estimated by qvalue.\n\n12.3.2 Gene-Concept Network\nThe cnetplot also works with compareCluster() result.\n\ncnetplot(ck)\n\n\n\n\n\n\nFigure¬†12.3: cnetplot() for comparing functional profiles of multiple gene clusters. Genes and functional categories (i.e., pathways) are encoded as pies to distinguish different gene clusters.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>12</span>¬† <span class='chapter-title'>Biological theme comparison</span>"
    ]
  },
  {
    "objectID": "029-compareCluster.html#summary",
    "href": "029-compareCluster.html#summary",
    "title": "12¬† Biological theme comparison",
    "section": "\n12.4 Summary",
    "text": "12.4 Summary\nThe comparison function was designed as a framework for comparing gene clusters of any kind of ontology associations, not only groupGO, enrichGO, enrichKEGG, enrichMKEGG, enrichWP and enricher that were provided in this package, but also other biological and biomedical ontologies, including but not limited to enrichPathway, enrichDO, enrichNCG, enrichDGN and enrichMeSH.\nIn (Yu et al. 2012), we analyzed the publicly available expression dataset of breast tumour tissues from 200 patients (GSE11121, Gene Expression Omnibus) (Schmidt et al. 2008). We identified 8 gene clusters from differentially expressed genes, and using the compareCluster() function to compare these gene clusters by their enriched biological process. In (Wu et al. 2021), we analyzed the GSE8057 dataset which contains expression data from ovarian cancer cells at multiple time points and under two treatment conditions. Eight groups of DEG lists were analyzed simultaneously using compareCluster() with WikiPathways. The result indicates that the two drgus have distinct effects at the begining but consistent effects in the later stages (Fig. 4 of (Wu et al. 2021)).",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>12</span>¬† <span class='chapter-title'>Biological theme comparison</span>"
    ]
  },
  {
    "objectID": "029-compareCluster.html#references",
    "href": "029-compareCluster.html#references",
    "title": "12¬† Biological theme comparison",
    "section": "References",
    "text": "References\n\n\n\n\nSchmidt, Marcus, Daniel B?hm, Christian von T?rne, Eric Steiner, Alexander Puhl, Henryk Pilch, Hans-Anton Lehr, Jan G. Hengstler, Heinz K?lbl, and Mathias Gehrmann. 2008. ‚ÄúThe Humoral Immune System Has a Key Prognostic Impact in Node-Negative Breast Cancer.‚Äù Cancer Research 68 (13): 5405‚Äì13. https://doi.org/10.1158/0008-5472.CAN-07-5206.\n\n\nWu, Tianzhi, Erqiang Hu, Shuangbin Xu, Meijun Chen, Pingfan Guo, Zehan Dai, Tingze Feng, et al. 2021. ‚ÄúclusterProfiler 4.0: A Universal Enrichment Tool for Interpreting Omics Data.‚Äù The Innovation 2 (3): 100141. https://doi.org/10.1016/j.xinn.2021.100141.\n\n\nYu, Guangchuang, Le-Gen Wang, Yanyan Han, and Qing-Yu He. 2012. ‚ÄúclusterProfiler: An r Package for Comparing Biological Themes Among Gene Clusters.‚Äù OMICS: A Journal of Integrative Biology 16 (5): 284‚Äì87. https://doi.org/10.1089/omi.2011.0118.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>12</span>¬† <span class='chapter-title'>Biological theme comparison</span>"
    ]
  },
  {
    "objectID": "enrichplot.html",
    "href": "enrichplot.html",
    "title": "13¬† Visualization of functional enrichment result",
    "section": "",
    "text": "13.1 Bar Plot\nThe enrichplot package implements several visualization methods to help interpreting enrichment results. It supports visualizing enrichment results obtained from DOSE (Yu et al. 2015), clusterProfiler (Yu et al. 2012; Wu et al. 2021), ReactomePA (Yu and He 2016) and meshes (Yu 2018). Both over representation analysis (ORA) and gene set enrichment analysis (GSEA) are supported.\nNote: Several visualization methods were first implemented in DOSE and rewrote from scratch using ggplot2. If you want to use the old methods, you can use the doseplot package.\nBar plot is the most widely used method to visualize enriched terms. It depicts the enrichment scores (e.g. p values) and gene count or ratio as bar height and color Figure¬†13.1. Users can specify the number of terms (most significant) or selected terms (see also the FAQ) to display via the showCategory parameter.\nlibrary(DOSE)\ndata(geneList)\nde &lt;- names(geneList)[abs(geneList) &gt; 2]\n\nedo &lt;- enrichDGN(de)\nlibrary(enrichplot)\nbarplot(edo, showCategory=20)\nOther variables that derived using mutate can also be used as bar height or color as demonstrated in Section 14.4 and Figure¬†13.1.\nlibrary(clusterProfiler)\n\nmutate(edo, qscore = -log(p.adjust, base=10)) |&gt; \n    barplot(x=\"qscore\")\nFigure¬†13.1: Bar plot of enriched terms.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>13</span>¬† <span class='chapter-title'>Visualization of functional enrichment result</span>"
    ]
  },
  {
    "objectID": "enrichplot.html#dot-plot",
    "href": "enrichplot.html#dot-plot",
    "title": "13¬† Visualization of functional enrichment result",
    "section": "\n13.2 Dot plot",
    "text": "13.2 Dot plot\nDot plot is similar to bar plot with the capability to encode another score as dot size.\nlibrary(ggplot2)\nedo2 &lt;- gseDO(geneList)\ndotplot(edo, showCategory=30) + ggtitle(\"dotplot for ORA\")\ndotplot(edo2, showCategory=30) + ggtitle(\"dotplot for GSEA\")\n\n\n\n\n\n\n\nFigure¬†13.2: Dot plot of enriched terms.\n\n\n\n\nNote: The dotplot() function also works with compareCluster() output.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>13</span>¬† <span class='chapter-title'>Visualization of functional enrichment result</span>"
    ]
  },
  {
    "objectID": "enrichplot.html#cnetplot",
    "href": "enrichplot.html#cnetplot",
    "title": "13¬† Visualization of functional enrichment result",
    "section": "\n13.3 Gene-Concept Network",
    "text": "13.3 Gene-Concept Network\nBoth the barplot() and dotplot() only displayed most significant or selected enriched terms, while users may want to know which genes are involved in these significant terms. In order to consider the potentially biological complexities in which a gene may belong to multiple annotation categories and provide information of numeric changes if available, we developed the cnetplot() function to extract the complex association. The cnetplot() depicts the linkages of genes and biological concepts (e.g. GO terms or KEGG pathways) as a network. GSEA result is also supported with only core enriched genes displayed.\n\n## convert gene ID to Symbol\nedox &lt;- setReadable(edo, 'org.Hs.eg.db', 'ENTREZID')\np1 &lt;- cnetplot(edox, foldChange=geneList)\n## categorySize can be scaled by 'pvalue' or 'geneNum'\np2 &lt;- cnetplot(edox, categorySize=\"pvalue\", foldChange=geneList)\np3 &lt;- cnetplot(edox, foldChange=geneList, circular = TRUE, colorEdge = TRUE) \nplot_list(p1, p2, p3, ncol=3, tag_levels = 'A', widths = c(.8, .8, 1.2))\n\n\n\n\n\n\nFigure¬†13.3: Network plot of enriched terms.\n\n\n\n\nIf you would like label subset of the nodes, you can use the node_label parameter, which supports 4 possible selections (i.e.¬†‚Äúcategory‚Äù, ‚Äúgene‚Äù, ‚Äúall‚Äù and ‚Äúnone‚Äù), as demonstrated in Figure¬†13.4.\n\np1 &lt;- cnetplot(edox, node_label=\"category\") \np2 &lt;- cnetplot(edox, node_label=\"gene\") \np3 &lt;- cnetplot(edox, node_label=\"all\") \np4 &lt;- cnetplot(edox, node_label=\"none\", \n        color_category='firebrick', \n        color_gene='steelblue') \nplot_list(p1, p2, p3, p4, ncol=2, tag_levels = 'A')\n\n\n\n\n\n\nFigure¬†13.4: Labelling nodes by selected subset. gene category (A), gene name (B), both gene category and gene name (C, default) and not to label at all (D).\n\n\n\n\nThe cnetplot function can be used as a general method to visualize data relationships in a network diagram. Users can use a named list as input as demonstrated in Figure¬†13.5.\n\nset.seed(123)\nx &lt;- list(A = letters[1:10], B=letters[5:12], C=letters[sample(1:26, 15)])\np1 &lt;- cnetplot(x)\n\nset.seed(123)\nd &lt;- setNames(rnorm(26), letters)\np2 &lt;- cnetplot(x, foldChange=d) + \n    scale_color_gradient2(name='associated data', low='darkgreen', high='firebrick')\n\nplot_list(p1, p2, ncol=2, tag_levels = 'A')    \n\n\n\n\n\n\nFigure¬†13.5: Using cnetplot to visualize data relationships. relationships as a network diagram (A) and with associated data to color nodes (B).\n\n\n\n\nNote: The cnetplot() function also works with compareCluster() output.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>13</span>¬† <span class='chapter-title'>Visualization of functional enrichment result</span>"
    ]
  },
  {
    "objectID": "enrichplot.html#heatmap-like-functional-classification",
    "href": "enrichplot.html#heatmap-like-functional-classification",
    "title": "13¬† Visualization of functional enrichment result",
    "section": "\n13.4 Heatmap-like functional classification",
    "text": "13.4 Heatmap-like functional classification\nThe heatplot is similar to cnetplot, while displaying the relationships as a heatmap. The gene-concept network may become too complicated if user want to show a large number significant terms. The heatplot can simplify the result and more easy to identify expression patterns.\n\np1 &lt;- heatplot(edox, showCategory=5)\np2 &lt;- heatplot(edox, foldChange=geneList, showCategory=5)\nplot_list(p1, p2, ncol=1, tag_levels = 'A')\n\n\n\n\n\n\nFigure¬†13.6: Heatmap plot of enriched terms. default (A), foldChange=geneList (B)",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>13</span>¬† <span class='chapter-title'>Visualization of functional enrichment result</span>"
    ]
  },
  {
    "objectID": "enrichplot.html#tree-plot",
    "href": "enrichplot.html#tree-plot",
    "title": "13¬† Visualization of functional enrichment result",
    "section": "\n13.5 Tree plot",
    "text": "13.5 Tree plot\nThe treeplot() function performs hierarchical clustering of enriched terms. It relies on the pairwise similarities of the enriched terms calculated by the pairwise_termsim() function, which by default using Jaccard‚Äôs similarity index (JC). Users can also use semantic similarity values if it is supported (e.g., GO, DO and MeSH).\nThe default agglomeration method in treeplot() is ward.D and users can specify other methods via the cluster_method parameter (e.g., ‚Äòaverage‚Äô, ‚Äòcomplete‚Äô, ‚Äòmedian‚Äô, ‚Äòcentroid‚Äô, etc., see also the document of the hclust() function). The treeplot() function will cut the tree into several subtrees (specify by the nCluster parameter (default is 5)) and labels subtrees using high-frequency words. This will reduce the complexity of the enriched result and improve user interpretation ability.\n\nedox2 &lt;- pairwise_termsim(edox)\np1 &lt;- treeplot(edox2)\np2 &lt;- treeplot(edox2, cluster_method = \"average\")\naplot::plot_list(p1, p2, tag_levels='A')\n\n\n\n\n\n\nFigure¬†13.7: Tree plot of enriched terms. default (A), hclust_method = \"average\" (B)",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>13</span>¬† <span class='chapter-title'>Visualization of functional enrichment result</span>"
    ]
  },
  {
    "objectID": "enrichplot.html#enrichment-map",
    "href": "enrichplot.html#enrichment-map",
    "title": "13¬† Visualization of functional enrichment result",
    "section": "\n13.6 Enrichment Map",
    "text": "13.6 Enrichment Map\nEnrichment map organizes enriched terms into a network with edges connecting overlapping gene sets. In this way, mutually overlapping gene sets are tend to cluster together, making it easy to identify functional module.\nThe emapplot function supports results obtained from hypergeometric test and gene set enrichment analysis. The size_category parameter can be used to resize nodes and the layout parameter can adjust the layout, as demonstrated in Figure¬†13.8.\n\nedo &lt;- pairwise_termsim(edo)\np1 &lt;- emapplot(edo)\np2 &lt;- emapplot(edo, size_category=1.5)\np3 &lt;- emapplot(edo, layout=\"kk\")\np4 &lt;- emapplot(edo, size_category=1.5,layout=\"kk\") \nplot_list(p1, p2, p3, p4, ncol=2, tag_levels = 'A')\n\n\n\n\n\n\nFigure¬†13.8: Plot for results obtained from hypergeometric test and gene set enrichment analysis. default (A), size_category=1.5 (B), layout=\"kk\" (C) and size_category=1.5,layout=\"kk\" (D).",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>13</span>¬† <span class='chapter-title'>Visualization of functional enrichment result</span>"
    ]
  },
  {
    "objectID": "enrichplot.html#biological-theme-comparison",
    "href": "enrichplot.html#biological-theme-comparison",
    "title": "13¬† Visualization of functional enrichment result",
    "section": "\n13.7 Biological theme comparison",
    "text": "13.7 Biological theme comparison\nThe emapplot function also supports results obtained from compareCluster function of clusterProfiler package. In addition to size_category and layout parameters, the number of circles in the bottom left corner can be adjusted using the legend_n parameteras, and proportion of clusters in the pie chart can be adjusted using the pie parameter, when pie=\"count\", the proportion of clusters in the pie chart is determined by the number of genes, as demonstrated in Figure¬†13.9.\n\nlibrary(clusterProfiler)\ndata(gcSample)\nxx &lt;- compareCluster(gcSample, fun=\"enrichKEGG\",\n                     organism=\"hsa\", pvalueCutoff=0.05)\nxx &lt;- pairwise_termsim(xx)                     \np1 &lt;- emapplot(xx)\np2 &lt;- emapplot(xx) \np3 &lt;- emapplot(xx, pie=\"count\")\np4 &lt;- emapplot(xx, pie=\"count\", size_category=1.5, layout=\"kk\")\nplot_list(p1, p2, p3, p4, ncol=2, tag_levels = 'A')\n\n\n\n\n\n\nFigure¬†13.9: Plot for results obtained from compareCluster function of clusterProfiler package. default (A), legend_n=2 (B), pie=\"count\" (C) and pie=\"count\", size_category=1.5, layout=\"kk\" (D).",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>13</span>¬† <span class='chapter-title'>Visualization of functional enrichment result</span>"
    ]
  },
  {
    "objectID": "enrichplot.html#upset-plot",
    "href": "enrichplot.html#upset-plot",
    "title": "13¬† Visualization of functional enrichment result",
    "section": "\n13.8 UpSet Plot",
    "text": "13.8 UpSet Plot\nThe upsetplot is an alternative to cnetplot for visualizing the complex association between genes and gene sets. It emphasizes the gene overlapping among different gene sets.\n\nupsetplot(edo)\n\n\n\n\n\n\nFigure¬†13.10: Upsetplot for over-representation analysis.\n\n\n\n\nFor over-representation analysis, upsetplot will calculate the overlaps among different gene sets as demonstrated in Figure¬†13.10. For GSEA result, it will plot the fold change distributions of different categories (e.g.¬†unique to pathway, overlaps among different pathways).\n\nkk2 &lt;- gseKEGG(geneList     = geneList,\n               organism     = 'hsa',\n               minGSSize    = 120,\n               pvalueCutoff = 0.05,\n               verbose      = FALSE)\nupsetplot(kk2) \n\n\n\n\n\n\nFigure¬†13.11: Upsetplot for gene set enrichment analysis.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>13</span>¬† <span class='chapter-title'>Visualization of functional enrichment result</span>"
    ]
  },
  {
    "objectID": "enrichplot.html#ridgeline-plot-for-expression-distribution-of-gsea-result",
    "href": "enrichplot.html#ridgeline-plot-for-expression-distribution-of-gsea-result",
    "title": "13¬† Visualization of functional enrichment result",
    "section": "\n13.9 ridgeline plot for expression distribution of GSEA result",
    "text": "13.9 ridgeline plot for expression distribution of GSEA result\nThe ridgeplot will visualize expression distributions of core enriched genes for GSEA enriched categories. It helps users to interpret up/down-regulated pathways.\n\nridgeplot(edo2)\n\n\n\n\n\n\nFigure¬†13.12: Ridgeplot for gene set enrichment analysis.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>13</span>¬† <span class='chapter-title'>Visualization of functional enrichment result</span>"
    ]
  },
  {
    "objectID": "enrichplot.html#running-score-and-preranked-list-of-gsea-result",
    "href": "enrichplot.html#running-score-and-preranked-list-of-gsea-result",
    "title": "13¬† Visualization of functional enrichment result",
    "section": "\n13.10 running score and preranked list of GSEA result",
    "text": "13.10 running score and preranked list of GSEA result\nRunning score and preranked list are traditional methods for visualizing GSEA result. The enrichplot package supports both of them to visualize the distribution of the gene set and the enrichment score.\n\np1 &lt;- gseaplot(edo2, geneSetID = 1, by = \"runningScore\", title = edo2$Description[1])\np2 &lt;- gseaplot(edo2, geneSetID = 1, by = \"preranked\", title = edo2$Description[1])\np3 &lt;- gseaplot(edo2, geneSetID = 1, title = edo2$Description[1])\nplot_list(p1, p2, p3, ncol=1, tag_levels='A')\n\n\n\n\n\n\nFigure¬†13.13: gseaplot for GSEA result(by = \"runningScore\"). by = \"runningScore\" (A), by = \"preranked\" (B), default (C)\n\n\n\n\nAnother method to plot GSEA result is the gseaplot2 function:\n\ngseaplot2(edo2, geneSetID = 1, title = edo2$Description[1])\n\n\n\n\n\n\nFigure¬†13.14: Gseaplot2 for GSEA result.\n\n\n\n\nThe gseaplot2 also supports multile gene sets to be displayed on the same figure:\n\ngseaplot2(edo2, geneSetID = 1:3)\n\n\n\n\n\n\nFigure¬†13.15: Gseaplot2 for GSEA result of multile gene sets.\n\n\n\n\nUser can also displaying the pvalue table on the plot via pvalue_table parameter:\n\ngseaplot2(edo2, geneSetID = 1:3, pvalue_table = TRUE,\n          color = c(\"#E495A5\", \"#86B875\", \"#7DB0DD\"), ES_geom = \"dot\")\n\n\n\n\n\n\nFigure¬†13.16: Gseaplot2 for GSEA result of multile gene sets(add pvalue_table).\n\n\n\n\nThe pvalue_table can be customized using the following parameters:\n\n\npvalue_table_rownames to specify row names of the table (if NULL, no row names will be displayed)\n\npvalue_table_colnames to specify column names of the table\n\n\ngseaplot2(edo2, geneSetID = 1, pvalue_table = TRUE,\n          pvalue_table_rownames = NULL,\n          pvalue_table_columns = c(\"ID\", \"NES\", \"p.adjust\"))\n\n\n\n\n\n\nFigure¬†13.17: Gseaplot2 with customized pvalue table.\n\n\n\n\nUser can specify subplots to only display a subset of plots:\n\np1 &lt;- gseaplot2(edo2, geneSetID = 1:3, subplots = 1)\np2 &lt;- gseaplot2(edo2, geneSetID = 1:3, subplots = 1:2)\nplot_list(p1, p2, ncol=1, tag_levels = 'A')\n\n\n\n\n\n\nFigure¬†13.18: Gseaplot2 for GSEA result of multile gene sets(add subplots). subplots = 1 (A),subplots = 1:2 (B)\n\n\n\n\nThe gsearank function plot the ranked list of genes belong to the specific gene set.\n\ngsearank(edo2, 1, title = edo2[1, \"Description\"])\n\n\n\n\n\n\nFigure¬†13.19: Ranked list of genes belong to the specific gene set.\n\n\n\n\nMultiple gene sets can be aligned using cowplot:\n\nlibrary(ggplot2)\n\npp &lt;- lapply(1:3, function(i) {\n    anno &lt;- edo2[i, c(\"NES\", \"pvalue\", \"p.adjust\")]\n    lab &lt;- paste0(names(anno), \"=\",  round(anno, 3), collapse=\"\\n\")\n\n    gsearank(edo2, i, edo2[i, 2]) + xlab(NULL) +ylab(NULL) +\n        annotate(\"text\", 10000, edo2[i, \"enrichmentScore\"] * .75, label = lab, hjust=0, vjust=0)\n})\nplot_list(gglist=pp, ncol=1)\n\n\n\n\n\n\nFigure¬†13.20: Gsearank for multiple gene sets.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>13</span>¬† <span class='chapter-title'>Visualization of functional enrichment result</span>"
    ]
  },
  {
    "objectID": "enrichplot.html#pubmed-trend-of-enriched-terms",
    "href": "enrichplot.html#pubmed-trend-of-enriched-terms",
    "title": "13¬† Visualization of functional enrichment result",
    "section": "\n13.11 pubmed trend of enriched terms",
    "text": "13.11 pubmed trend of enriched terms\nOne of the problem of enrichment analysis is to find pathways for further investigation. Here, we provide pmcplot function to plot the number/proportion of publications trend based on the query result from PubMed Central. Of course, users can use pmcplot in other scenarios. All text that can be queried on PMC is valid as input of pmcplot.\n\nterms &lt;- edo$Description[1:5]\np &lt;- pmcplot(terms, 2010:2020)\np2 &lt;- pmcplot(terms, 2010:2020, proportion=FALSE)\nplot_list(p, p2, ncol=2)\n\n\n\n\n\n\nFigure¬†13.21: Pmcplot of enrichment analysis.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>13</span>¬† <span class='chapter-title'>Visualization of functional enrichment result</span>"
    ]
  },
  {
    "objectID": "enrichplot.html#references",
    "href": "enrichplot.html#references",
    "title": "13¬† Visualization of functional enrichment result",
    "section": "References",
    "text": "References\n\n\n\n\nWu, Tianzhi, Erqiang Hu, Shuangbin Xu, Meijun Chen, Pingfan Guo, Zehan Dai, Tingze Feng, et al. 2021. ‚ÄúclusterProfiler 4.0: A Universal Enrichment Tool for Interpreting Omics Data.‚Äù The Innovation 2 (3): 100141. https://doi.org/10.1016/j.xinn.2021.100141.\n\n\nYu, Guangchuang. 2018. ‚ÄúUsing Meshes for MeSH Term Enrichment and Semantic Analyses.‚Äù Bioinformatics 34 (21): 3766‚Äì67. https://doi.org/10.1093/bioinformatics/bty410.\n\n\nYu, Guangchuang, and Qing-Yu He. 2016. ‚ÄúReactomePA: An r/Bioconductor Package for Reactome Pathway Analysis and Visualization.‚Äù Molecular BioSystems 12 (2): 477‚Äì79. https://doi.org/10.1039/C5MB00663E.\n\n\nYu, Guangchuang, Le-Gen Wang, Yanyan Han, and Qing-Yu He. 2012. ‚ÄúclusterProfiler: An r Package for Comparing Biological Themes Among Gene Clusters.‚Äù OMICS: A Journal of Integrative Biology 16 (5): 284‚Äì87. https://doi.org/10.1089/omi.2011.0118.\n\n\nYu, Guangchuang, Li-Gen Wang, Guang-Rong Yan, and Qing-Yu He. 2015. ‚ÄúDOSE: An r/Bioconductor Package for Disease Ontology Semantic and Enrichment Analysis.‚Äù Bioinformatics 31 (4): 608‚Äì9. https://doi.org/10.1093/bioinformatics/btu684.",
    "crumbs": [
      "Enrichment Analysis",
      "<span class='chapter-number'>13</span>¬† <span class='chapter-title'>Visualization of functional enrichment result</span>"
    ]
  },
  {
    "objectID": "dplyr.html",
    "href": "dplyr.html",
    "title": "14¬† dplyr verbs for manipulating enrichment result",
    "section": "",
    "text": "14.1 filter\nfilter(x, p.adjust &lt; .05, qvalue &lt; 0.2)\n\n#\n# over-representation test\n#\n#...@organism    Homo sapiens \n#...@ontology    HDO \n#...@keytype     ENTREZID \n#...@gene    chr [1:100] \"4312\" \"8318\" \"10874\" \"55143\" \"55388\" \"991\" \"6280\" \"2305\" ...\n#...pvalues adjusted by 'BH' with cutoff &lt;0.05 \n#...13 enriched terms found\n'data.frame':   13 obs. of  12 variables:\n $ ID            : chr  \"DOID:11054\" \"DOID:2799\" \"DOID:14004\" \"DOID:3996\" ...\n $ Description   : chr  \"urinary bladder cancer\" \"bronchiolitis obliterans\" \"thoracic aortic aneurysm\" \"urinary system cancer\" ...\n $ GeneRatio     : chr  \"9/57\" \"4/57\" \"4/57\" \"10/57\" ...\n $ BgRatio       : chr  \"180/7865\" \"26/7865\" \"36/7865\" \"370/7865\" ...\n $ RichFactor    : num  0.05 0.1538 0.1111 0.027 0.0327 ...\n $ FoldEnrichment: num  6.9 21.23 15.33 3.73 4.51 ...\n $ zScore        : num  6.84 8.83 7.36 4.59 4.76 ...\n $ pvalue        : num  4.93e-06 3.29e-05 1.23e-04 2.80e-04 3.49e-04 ...\n $ p.adjust      : num  0.00186 0.00622 0.01548 0.02637 0.02637 ...\n $ qvalue        : num  0.0015 0.00501 0.01246 0.02122 0.02122 ...\n $ geneID        : chr  \"4312/6280/6279/7153/6241/983/332/2146/6790\" \"3627/6373/4283/3002\" \"4312/3627/4283/4321\" \"4312/6280/6279/7153/6241/983/332/2146/4321/6790\" ...\n $ Count         : int  9 4 4 10 8 5 5 4 6 6 ...\n#...Citation\nGuangchuang Yu, Li-Gen Wang, Guang-Rong Yan, Qing-Yu He. DOSE: an R/Bioconductor package for Disease Ontology Semantic and Enrichment analysis. Bioinformatics. 2015, 31(4):608-609",
    "crumbs": [
      "Miscellaneous topics",
      "<span class='chapter-number'>14</span>¬† <span class='chapter-title'>dplyr verbs for manipulating enrichment result</span>"
    ]
  },
  {
    "objectID": "dplyr.html#arrange",
    "href": "dplyr.html#arrange",
    "title": "14¬† dplyr verbs for manipulating enrichment result",
    "section": "\n14.2 arrange",
    "text": "14.2 arrange\n\nmutate(x, geneRatio = parse_ratio(GeneRatio)) %&gt;%\n  arrange(desc(geneRatio))\n\n#\n# over-representation test\n#\n#...@organism    Homo sapiens \n#...@ontology    HDO \n#...@keytype     ENTREZID \n#...@gene    chr [1:100] \"4312\" \"8318\" \"10874\" \"55143\" \"55388\" \"991\" \"6280\" \"2305\" ...\n#...pvalues adjusted by 'BH' with cutoff &lt;0.05 \n#...13 enriched terms found\n'data.frame':   13 obs. of  13 variables:\n $ ID            : chr  \"DOID:3996\" \"DOID:11054\" \"DOID:10534\" \"DOID:5041\" ...\n $ Description   : chr  \"urinary system cancer\" \"urinary bladder cancer\" \"stomach cancer\" \"esophageal cancer\" ...\n $ GeneRatio     : chr  \"10/57\" \"9/57\" \"8/57\" \"6/57\" ...\n $ BgRatio       : chr  \"370/7865\" \"180/7865\" \"245/7865\" \"155/7865\" ...\n $ RichFactor    : num  0.027 0.05 0.0327 0.0387 0.0368 ...\n $ FoldEnrichment: num  3.73 6.9 4.51 5.34 5.08 ...\n $ zScore        : num  4.59 6.84 4.76 4.66 4.5 ...\n $ pvalue        : num  2.80e-04 4.93e-06 3.49e-04 8.42e-04 1.09e-03 ...\n $ p.adjust      : num  0.02637 0.00186 0.02637 0.03536 0.04137 ...\n $ qvalue        : num  0.0212 0.0015 0.0212 0.0285 0.0333 ...\n $ geneID        : chr  \"4312/6280/6279/7153/6241/983/332/2146/4321/6790\" \"4312/6280/6279/7153/6241/983/332/2146/6790\" \"4312/2305/10403/259266/8140/81930/332/2146\" \"4312/3868/8140/7850/2146/4321\" ...\n $ Count         : int  10 9 8 6 6 5 5 4 4 4 ...\n $ geneRatio     : num  0.175 0.158 0.14 0.105 0.105 ...\n#...Citation\nGuangchuang Yu, Li-Gen Wang, Guang-Rong Yan, Qing-Yu He. DOSE: an R/Bioconductor package for Disease Ontology Semantic and Enrichment analysis. Bioinformatics. 2015, 31(4):608-609",
    "crumbs": [
      "Miscellaneous topics",
      "<span class='chapter-number'>14</span>¬† <span class='chapter-title'>dplyr verbs for manipulating enrichment result</span>"
    ]
  },
  {
    "objectID": "dplyr.html#select",
    "href": "dplyr.html#select",
    "title": "14¬† dplyr verbs for manipulating enrichment result",
    "section": "\n14.3 select",
    "text": "14.3 select\n\nselect(x, -geneID) %&gt;% head\n\n                   ID              Description GeneRatio  BgRatio RichFactor\nDOID:11054 DOID:11054   urinary bladder cancer      9/57 180/7865 0.05000000\nDOID:2799   DOID:2799 bronchiolitis obliterans      4/57  26/7865 0.15384615\nDOID:14004 DOID:14004 thoracic aortic aneurysm      4/57  36/7865 0.11111111\nDOID:3996   DOID:3996    urinary system cancer     10/57 370/7865 0.02702703\nDOID:10534 DOID:10534           stomach cancer      8/57 245/7865 0.03265306\nDOID:3627   DOID:3627          aortic aneurysm      5/57  89/7865 0.05617978\n           FoldEnrichment   zScore       pvalue    p.adjust      qvalue Count\nDOID:11054       6.899123 6.840550 4.925937e-06 0.001862004 0.001498522     9\nDOID:2799       21.228070 8.826735 3.291471e-05 0.006220880 0.005006500     4\nDOID:14004      15.331384 7.363351 1.228827e-04 0.015483224 0.012460740     4\nDOID:3996        3.729256 4.594609 2.797046e-04 0.026365852 0.021218967    10\nDOID:10534       4.505550 4.762675 3.487547e-04 0.026365852 0.021218967     8\nDOID:3627        7.751823 5.473022 4.365904e-04 0.027505194 0.022135898     5",
    "crumbs": [
      "Miscellaneous topics",
      "<span class='chapter-number'>14</span>¬† <span class='chapter-title'>dplyr verbs for manipulating enrichment result</span>"
    ]
  },
  {
    "objectID": "dplyr.html#sec-mutate",
    "href": "dplyr.html#sec-mutate",
    "title": "14¬† dplyr verbs for manipulating enrichment result",
    "section": "\n14.4 mutate",
    "text": "14.4 mutate\n\n# k/M\ny &lt;- mutate(x, richFactor = Count / as.numeric(sub(\"/\\\\d+\", \"\", BgRatio)))\ny\n\n#\n# over-representation test\n#\n#...@organism    Homo sapiens \n#...@ontology    HDO \n#...@keytype     ENTREZID \n#...@gene    chr [1:100] \"4312\" \"8318\" \"10874\" \"55143\" \"55388\" \"991\" \"6280\" \"2305\" ...\n#...pvalues adjusted by 'BH' with cutoff &lt;0.05 \n#...13 enriched terms found\n'data.frame':   13 obs. of  13 variables:\n $ ID            : chr  \"DOID:11054\" \"DOID:2799\" \"DOID:14004\" \"DOID:3996\" ...\n $ Description   : chr  \"urinary bladder cancer\" \"bronchiolitis obliterans\" \"thoracic aortic aneurysm\" \"urinary system cancer\" ...\n $ GeneRatio     : chr  \"9/57\" \"4/57\" \"4/57\" \"10/57\" ...\n $ BgRatio       : chr  \"180/7865\" \"26/7865\" \"36/7865\" \"370/7865\" ...\n $ RichFactor    : num  0.05 0.1538 0.1111 0.027 0.0327 ...\n $ FoldEnrichment: num  6.9 21.23 15.33 3.73 4.51 ...\n $ zScore        : num  6.84 8.83 7.36 4.59 4.76 ...\n $ pvalue        : num  4.93e-06 3.29e-05 1.23e-04 2.80e-04 3.49e-04 ...\n $ p.adjust      : num  0.00186 0.00622 0.01548 0.02637 0.02637 ...\n $ qvalue        : num  0.0015 0.00501 0.01246 0.02122 0.02122 ...\n $ geneID        : chr  \"4312/6280/6279/7153/6241/983/332/2146/6790\" \"3627/6373/4283/3002\" \"4312/3627/4283/4321\" \"4312/6280/6279/7153/6241/983/332/2146/4321/6790\" ...\n $ Count         : int  9 4 4 10 8 5 5 4 6 6 ...\n $ richFactor    : num  0.05 0.1538 0.1111 0.027 0.0327 ...\n#...Citation\nGuangchuang Yu, Li-Gen Wang, Guang-Rong Yan, Qing-Yu He. DOSE: an R/Bioconductor package for Disease Ontology Semantic and Enrichment analysis. Bioinformatics. 2015, 31(4):608-609 \n\nlibrary(ggplot2)\nlibrary(forcats)\nlibrary(enrichplot)\n\nggplot(y, showCategory = 20, \n  aes(richFactor, fct_reorder(Description, richFactor))) + \n  geom_segment(aes(xend=0, yend = Description)) +\n  geom_point(aes(color=p.adjust, size = Count)) +\n  scale_color_viridis_c(guide=guide_colorbar(reverse=TRUE)) +\n  scale_size_continuous(range=c(2, 10)) +\n  theme_minimal() + \n  xlab(\"rich factor\") +\n  ylab(NULL) + \n  ggtitle(\"Enriched Disease Ontology\")\n\n\n\n\n\n\nFigure¬†14.1: Visualizing rich factor of enriched terms using lolliplot.\n\n\n\n\nA very similar concept is Fold Enrichment, which is defined as the ratio of two proportions, (k/n) / (M/N). Using mutate to add the fold enrichment variable is also easy:\nmutate(x, FoldEnrichment = parse_ratio(GeneRatio) / parse_ratio(BgRatio))\nHere, the calculation of rich factor and fold enrichment is only for demonstration purposes. The enrichplot package provides the dotplot function that can directly visualize these two values without adding them to the enrichment result.",
    "crumbs": [
      "Miscellaneous topics",
      "<span class='chapter-number'>14</span>¬† <span class='chapter-title'>dplyr verbs for manipulating enrichment result</span>"
    ]
  },
  {
    "objectID": "dplyr.html#slice",
    "href": "dplyr.html#slice",
    "title": "14¬† dplyr verbs for manipulating enrichment result",
    "section": "\n14.5 slice",
    "text": "14.5 slice\nWe can use slice to choose rows by their ordinal position in the enrichment result. Grouped result use the ordinal position with the group.\nIn the following example, a GSEA result of Reactome pathway was sorted by the absolute values of NES and the result was grouped by the sign of NES. We then extracted first 5 rows of each groups. The result was displayed in Figure¬†14.2.\n\nlibrary(ReactomePA)\nx &lt;- gsePathway(geneList)\n\n\ny &lt;- arrange(x, abs(NES)) %&gt;% \n        group_by(sign(NES)) %&gt;% \n        slice(1:5)\n\nlibrary(forcats)\nlibrary(ggplot2)\nlibrary(enrichplot)\n\nggplot(y, aes(NES, fct_reorder(Description, NES), fill=qvalue), showCategory=10) + \n    geom_col(orientation='y') + \n    scale_fill_continuous(low='red', high='blue', guide=guide_colorbar(reverse=TRUE)) + \n    theme_minimal() + ylab(NULL)\n\n\n\n\n\n\nFigure¬†14.2: Choose pathways by ordinal positions.",
    "crumbs": [
      "Miscellaneous topics",
      "<span class='chapter-number'>14</span>¬† <span class='chapter-title'>dplyr verbs for manipulating enrichment result</span>"
    ]
  },
  {
    "objectID": "dplyr.html#summarise",
    "href": "dplyr.html#summarise",
    "title": "14¬† dplyr verbs for manipulating enrichment result",
    "section": "\n14.6 summarise",
    "text": "14.6 summarise\n\nlibrary(ggplot2)\n\npbar &lt;- function(x) {\n  pi=seq(0, 1, length.out=11)\n\n  mutate(x, pp = cut(p.adjust, pi)) |&gt;\n    group_by(pp) |&gt;\n    summarise(cnt = n()) |&gt; \n    ggplot(aes(pp, cnt)) + geom_col() + \n    theme_minimal() +\n    xlab(\"p value intervals\") +\n    ylab(\"Frequency\") + \n    ggtitle(\"p value distribution\")\n}    \n\nx &lt;- enrichDO(de, pvalueCutoff=1, qvalueCutoff=1)\nset.seed(2020-09-10)\nrandom_genes &lt;- sample(names(geneList), 100)\ny &lt;- enrichDO(random_genes, pvalueCutoff=1, qvalueCutoff=1)\np1 &lt;- pbar(x)\np2 &lt;- pbar(y)\naplot::plot_list(p1, p2, ncol=1, tag_levels = 'A')",
    "crumbs": [
      "Miscellaneous topics",
      "<span class='chapter-number'>14</span>¬† <span class='chapter-title'>dplyr verbs for manipulating enrichment result</span>"
    ]
  },
  {
    "objectID": "utilities.html",
    "href": "utilities.html",
    "title": "15¬† Useful utilities",
    "section": "",
    "text": "15.1 Translating Biological ID",
    "crumbs": [
      "Miscellaneous topics",
      "<span class='chapter-number'>15</span>¬† <span class='chapter-title'>Useful utilities</span>"
    ]
  },
  {
    "objectID": "utilities.html#id-convert",
    "href": "utilities.html#id-convert",
    "title": "15¬† Useful utilities",
    "section": "",
    "text": "15.1.1 bitr: Biological Id TranslatoR\nThe clusterProfiler package provides the bitr() and bitr_kegg() functions for converting ID types. Both bitr() and bitr_kegg() support many species including model and many non-model organisms.\n\nx &lt;- c(\"GPX3\",  \"GLRX\",   \"LBP\",   \"CRYAB\", \"DEFB1\", \"HCLS1\",   \"SOD2\",   \"HSPA2\",\n       \"ORM1\",  \"IGFBP1\", \"PTHLH\", \"GPC3\",  \"IGFBP3\",\"TOB1\",    \"MITF\",   \"NDRG1\",\n       \"NR1H4\", \"FGFR3\",  \"PVR\",   \"IL6\",   \"PTPRM\", \"ERBB2\",   \"NID2\",   \"LAMB1\",\n       \"COMP\",  \"PLS3\",   \"MCAM\",  \"SPP1\",  \"LAMC1\", \"COL4A2\",  \"COL4A1\", \"MYOC\",\n       \"ANXA4\", \"TFPI2\",  \"CST6\",  \"SLPI\",  \"TIMP2\", \"CPM\",     \"GGT1\",   \"NNMT\",\n       \"MAL\",   \"EEF1A2\", \"HGD\",   \"TCN2\",  \"CDA\",   \"PCCA\",    \"CRYM\",   \"PDXK\",\n       \"STC1\",  \"WARS\",  \"HMOX1\", \"FXYD2\", \"RBP4\",   \"SLC6A12\", \"KDELR3\", \"ITM2B\")\neg = bitr(x, fromType=\"SYMBOL\", toType=\"ENTREZID\", OrgDb=\"org.Hs.eg.db\")\nhead(eg)\n\n  SYMBOL ENTREZID\n1   GPX3     2878\n2   GLRX     2745\n3    LBP     3929\n4  CRYAB     1410\n5  DEFB1     1672\n6  HCLS1     3059\n\n\nUser should provides an annotation package, both fromType and toType can accept any types that supported.\nUser can use keytypes to list all supporting types.\n\nlibrary(org.Hs.eg.db)\nkeytypes(org.Hs.eg.db)\n\n [1] \"ACCNUM\"       \"ALIAS\"        \"ENSEMBL\"      \"ENSEMBLPROT\"  \"ENSEMBLTRANS\"\n [6] \"ENTREZID\"     \"ENZYME\"       \"EVIDENCE\"     \"EVIDENCEALL\"  \"GENENAME\"    \n[11] \"GENETYPE\"     \"GO\"           \"GOALL\"        \"IPI\"          \"MAP\"         \n[16] \"OMIM\"         \"ONTOLOGY\"     \"ONTOLOGYALL\"  \"PATH\"         \"PFAM\"        \n[21] \"PMID\"         \"PROSITE\"      \"REFSEQ\"       \"SYMBOL\"       \"UCSCKG\"      \n[26] \"UNIPROT\"     \n\n\nWe can translate from one type to other types.\n\nlibrary(clusterProfiler)\nids &lt;- bitr(x, fromType=\"SYMBOL\", toType=c(\"UNIPROT\", \"ENSEMBL\"), OrgDb=\"org.Hs.eg.db\")\n\nWarning in bitr(x, fromType = \"SYMBOL\", toType = c(\"UNIPROT\", \"ENSEMBL\"), :\n1.79% of input gene IDs are fail to map...\n\nhead(ids)\n\n  SYMBOL UNIPROT         ENSEMBL\n1   GPX3  P22352 ENSG00000211445\n2   GPX3  O43787 ENSG00000211445\n3   GPX3  Q86W78 ENSG00000211445\n4   GPX3  Q9NZ74 ENSG00000211445\n5   GPX3  Q9UEL1 ENSG00000211445\n6   GLRX  B2R4L2 ENSG00000173221\n\n\nFor GO analysis, user don‚Äôt need to convert ID, all ID type provided by OrgDb can be used in groupGO, enrichGO and gseGO by specifying keyType parameter.\nUsers can use the bitr function to convert IDs using any ID types that available in the OrbDb object. For example, users may want to know the genes in background that are belong to a specific GO term. Such information can be easily accessed using bitr.\n\nm &lt;- bitr(\"GO:0006805\", fromType=\"GO\", toType = \"SYMBOL\", OrgDb=org.Hs.eg.db)\ndim(m)\n\n[1] 170   4\n\nhead(m)\n\n          GO EVIDENCE ONTOLOGY SYMBOL\n1 GO:0006805      TAS       BP   NAT1\n2 GO:0006805      TAS       BP   NAT2\n3 GO:0006805      TAS       BP  AADAC\n4 GO:0006805      TAS       BP    ADA\n5 GO:0006805      IEA       BP    AHR\n6 GO:0006805      TAS       BP    AHR\n\n\nNote: If you want to extract genes in your input gene list that are belong to a specific term/pathway, you can use the geneInCategory function.\n\n15.1.2 bitr_kegg: converting biological IDs using KEGG API\n\ndata(gcSample)\nhg &lt;- gcSample[[1]]\nhead(hg)\n\n[1] \"4597\"  \"7111\"  \"5266\"  \"2175\"  \"755\"   \"23046\"\n\neg2np &lt;- bitr_kegg(hg, fromType='kegg', toType='ncbi-proteinid', organism='hsa')\n\nWarning in bitr_kegg(hg, fromType = \"kegg\", toType = \"ncbi-proteinid\", organism\n= \"hsa\"): 4.17% of input gene IDs are fail to map...\n\nhead(eg2np)\n\n   kegg ncbi-proteinid\n1 10001      NP_005457\n2 10209      NP_005792\n3 10232      NP_037536\n4 10324      NP_006054\n5 10411   NP_001092001\n6 10614      NP_006451\n\n\nThe ID type (both fromType & toType) should be one of ‚Äòkegg‚Äô, ‚Äòncbi-geneid‚Äô, ‚Äòncbi-proteinid‚Äô or ‚Äòuniprot‚Äô. The ‚Äòkegg‚Äô is the primary ID used in KEGG database. The data source of KEGG was from NCBI. A rule of thumb for the ‚Äòkegg‚Äô ID is entrezgene ID for eukaryote species and Locus ID for prokaryotes.\nMany prokaryote species don‚Äôt have entrezgene ID available. For example we can check the gene information of ece:Z5100 in http://www.genome.jp/dbget-bin/www_bget?ece:Z5100, which have NCBI-ProteinID and UnitProt links in the Other DBs Entry, but not NCBI-GeneID.\nIf we try to convert Z5100 to ncbi-geneid, bitr_kegg will throw error of ncbi-geneid is not supported.\n\nbitr_kegg(\"Z5100\", fromType=\"kegg\", toType='ncbi-geneid', organism='ece')\n\n## Error in KEGG_convert(fromType, toType, organism) :\n## ncbi-geneid is not supported for ece ...\n\nWe can of course convert it to ncbi-proteinid and uniprot:\n\nbitr_kegg(\"Z5100\", fromType=\"kegg\", toType='ncbi-proteinid', organism='ece')\n\n   kegg ncbi-proteinid\n1 Z5100       AAG58814\n\nbitr_kegg(\"Z5100\", fromType=\"kegg\", toType='uniprot', organism='ece')\n\n   kegg    uniprot\n1 Z5100 A0A9Q7EE73",
    "crumbs": [
      "Miscellaneous topics",
      "<span class='chapter-number'>15</span>¬† <span class='chapter-title'>Useful utilities</span>"
    ]
  },
  {
    "objectID": "utilities.html#setReadable",
    "href": "utilities.html#setReadable",
    "title": "15¬† Useful utilities",
    "section": "\n15.2 setReadable: translating gene IDs to human readable symbols",
    "text": "15.2 setReadable: translating gene IDs to human readable symbols\nSome of the functions, especially those internally supported for DO, GO, and Reactome Pathway, support a parameter, readable. If readable = TRUE, all the gene IDs will be translated to gene symbols. The readable parameter is not available for enrichment analysis of KEGG or using user‚Äôs own annotation. KEGG analysis using enrichKEGG and gseKEGG, which internally query annotation information from KEEGG database and thus support all species if it is available in the KEGG database. However, KEGG database doesn‚Äôt provide gene ID to symbol mapping information. For analysis using user‚Äôs own annotation data, we even don‚Äôt know what species is in analyzed. Translating gene IDs to gene symbols is partly supported using the setReadable function if and only if there is an OrgDb available. The setReadable() function also works with compareCluster() output.\n\ndata(geneList, package=\"DOSE\")\nde &lt;- names(geneList)[1:100]\nx &lt;- enrichKEGG(de)\n## The geneID column is ENTREZID\nhead(x, 3)\n\n                   category           subcategory       ID         Description\nhsa04110 Cellular Processes Cell growth and death hsa04110          Cell cycle\nhsa04218 Cellular Processes Cell growth and death hsa04218 Cellular senescence\nhsa04814 Cellular Processes         Cell motility hsa04814      Motor proteins\n         GeneRatio  BgRatio RichFactor FoldEnrichment    zScore       pvalue\nhsa04110     12/59 158/9500 0.07594937      12.229135 11.251512 1.679507e-10\nhsa04218      7/59 157/9500 0.04458599       7.179100  6.171458 4.885886e-05\nhsa04814      7/59 197/9500 0.03553299       5.721414  5.293582 2.029593e-04\n             p.adjust       qvalue\nhsa04110 2.116179e-08 1.944693e-08\nhsa04218 3.078108e-03 2.828671e-03\nhsa04814 6.610189e-03 6.074527e-03\n                                                             geneID Count\nhsa04110 8318/991/9133/10403/890/983/4085/81620/7272/9212/1111/9319    12\nhsa04218                          2305/4605/9133/890/983/51806/1111     7\nhsa04814                     9493/1062/81930/3832/3833/146909/10112     7\n\ny &lt;- setReadable(x, OrgDb = org.Hs.eg.db, keyType=\"ENTREZID\")\n## The geneID column is translated to symbol\nhead(y, 3)\n\n                   category           subcategory       ID         Description\nhsa04110 Cellular Processes Cell growth and death hsa04110          Cell cycle\nhsa04218 Cellular Processes Cell growth and death hsa04218 Cellular senescence\nhsa04814 Cellular Processes         Cell motility hsa04814      Motor proteins\n         GeneRatio  BgRatio RichFactor FoldEnrichment    zScore       pvalue\nhsa04110     12/59 158/9500 0.07594937      12.229135 11.251512 1.679507e-10\nhsa04218      7/59 157/9500 0.04458599       7.179100  6.171458 4.885886e-05\nhsa04814      7/59 197/9500 0.03553299       5.721414  5.293582 2.029593e-04\n             p.adjust       qvalue\nhsa04110 2.116179e-08 1.944693e-08\nhsa04218 3.078108e-03 2.828671e-03\nhsa04814 6.610189e-03 6.074527e-03\n                                                                        geneID\nhsa04110 CDC45/CDC20/CCNB2/NDC80/CCNA2/CDK1/MAD2L1/CDT1/TTK/AURKB/CHEK1/TRIP13\nhsa04218                             FOXM1/MYBL2/CCNB2/CCNA2/CDK1/CALML5/CHEK1\nhsa04814                          KIF23/CENPE/KIF18A/KIF11/KIFC1/KIF18B/KIF20A\n         Count\nhsa04110    12\nhsa04218     7\nhsa04814     7\n\n\nFor those functions that internally support readable parameter, user can also use setReadable for translating gene IDs.",
    "crumbs": [
      "Miscellaneous topics",
      "<span class='chapter-number'>15</span>¬† <span class='chapter-title'>Useful utilities</span>"
    ]
  },
  {
    "objectID": "utilities.html#read-gmt",
    "href": "utilities.html#read-gmt",
    "title": "15¬† Useful utilities",
    "section": "\n15.3 Parsing GMT files",
    "text": "15.3 Parsing GMT files\nThe GMT (Gene Matrix Transposed) file format is a tab delimited file format that is widely used to describe gene sets. Each row in the GMT format represents one gene set and each gene set is described by a name (or ID), a description and the genes in the gene set as illustrated in Figure¬†15.1.\n\n\n\n\n\n\n\nFigure¬†15.1: The GMT format. Figure taken from https://software.broadinstitute.org/cancer/software/gsea/wiki/index.php/Data_formats.\n\n\n\n\nThe clusterProfiler package implemented a function, read.gmt(), to parse GMT file into a data.frame. The WikiPathway GMT file encodes information of version, wpid and species into the Description column. The clusterProfiler provides the read.gmt.wp() function to parse WikiPathway GMT file and supports parsing information that encoded in the Description column.\n\n# use `wget -c` in `download.file`\nwget::wget_set()\nurl &lt;- \"https://maayanlab.cloud/Enrichr/geneSetLibrary?mode=text&libraryName=COVID-19_Related_Gene_Sets\"\ndownload.file(url, destfile = \"COVID19_GeneSets.gmt\")\n\ncovid19_gs &lt;- read.gmt(\"COVID19_GeneSets.gmt\")\nhead(covid19_gs)\n\n                                    term    gene\n1 COVID19-E protein host PPI from Krogan    BRD4\n2 COVID19-E protein host PPI from Krogan    BRD2\n3 COVID19-E protein host PPI from Krogan SLC44A2\n4 COVID19-E protein host PPI from Krogan  ZC3H18\n5 COVID19-E protein host PPI from Krogan   AP3B1\n6 COVID19-E protein host PPI from Krogan   CWC27\n\n\nGene set resources:\n\nhttps://maayanlab.cloud/Enrichr/#stats\nhttp://ge-lab.org/#/data\n\nThere are many gene sets available online. After parsing by the read.gmt() function, the data can be directly used to perform enrichment analysis using enricher() and GSEA() functions (see also Chapter 12).",
    "crumbs": [
      "Miscellaneous topics",
      "<span class='chapter-number'>15</span>¬† <span class='chapter-title'>Useful utilities</span>"
    ]
  },
  {
    "objectID": "utilities.html#go-utilities",
    "href": "utilities.html#go-utilities",
    "title": "15¬† Useful utilities",
    "section": "\n15.4 GO utilities",
    "text": "15.4 GO utilities\n\n15.4.1 drop specific GO terms or level\nThe enrichGO() function tests the whole GO corpus and enriched result may contains very general terms. With dropGO function, user can remove specific GO terms or GO level from results obtained from both enrichGO() and compareCluster().\n\n15.4.2 test GO at sepcific level\nThe enrichGO() doesn‚Äôt contain parameter to restrict the test at specific GO level. Instead, we provide a function, gofilter(), to restrict the result at specific GO level. It works with results obtained from both enrichGO() and compareCluster().\n\n15.4.3 reduce redundancy of enriched GO terms\nGO is organized in parent-child structure, thus a parent term can be overlapped with a large proportion with all its child terms. This can result in redundant findings. To solve this issue, clusterProfiler implements simplify method to reduce redundant GO terms from the outputs of enrichGO() and gseGO(). The function internally called GOSemSim (Yu et al. 2010) to calculate semantic similarity among GO terms and remove those highly similar terms by keeping one representative term. The simplify() method apply select_fun (which can be a user defined function) to feature by to select one representative term from redundant terms (which have similarity higher than cutoff).\nIn Figure¬†15.2(A), we can found that there are many redundant terms form a highly condense network. After removing redundant terms using the simplify() method, the result is more clear to view the whole story.\n\nlibrary(enrichplot)\ndata(geneList, package=\"DOSE\")\nde &lt;- names(geneList)[abs(geneList) &gt; 2]\nbp &lt;- enrichGO(de, ont=\"BP\", OrgDb = 'org.Hs.eg.db')\nbp &lt;- pairwise_termsim(bp)\nbp2 &lt;- simplify(bp, cutoff=0.7, by=\"p.adjust\", select_fun=min)\np1 &lt;- emapplot(bp)\np2 &lt;- emapplot(bp2)\nplot_list(p1, p2, ncol=2, tag_levels = 'A')\n\n\n\n\n\n\nFigure¬†15.2: Visualize enriched terms by EnrichmentMap using the emapplot() function. (A) original result. (B) simplify result.\n\n\n\n\nAlternatively, users can use slim version of GO and use the enricher() o r gseGO() functions to analyze.",
    "crumbs": [
      "Miscellaneous topics",
      "<span class='chapter-number'>15</span>¬† <span class='chapter-title'>Useful utilities</span>"
    ]
  },
  {
    "objectID": "utilities.html#data-frame-interface-for-accessing-enriched-results",
    "href": "utilities.html#data-frame-interface-for-accessing-enriched-results",
    "title": "15¬† Useful utilities",
    "section": "\n15.5 Data frame interface for accessing enriched results",
    "text": "15.5 Data frame interface for accessing enriched results\nThe [ and [[ (asis parameter).",
    "crumbs": [
      "Miscellaneous topics",
      "<span class='chapter-number'>15</span>¬† <span class='chapter-title'>Useful utilities</span>"
    ]
  },
  {
    "objectID": "utilities.html#references",
    "href": "utilities.html#references",
    "title": "15¬† Useful utilities",
    "section": "References",
    "text": "References\n\n\n\n\nYu, Guangchuang, Fei Li, Yide Qin, Xiaochen Bo, Yibo Wu, and Shengqi Wang. 2010. ‚ÄúGOSemSim: An r Package for Measuring Semantic Similarity Among GO Terms and Gene Products.‚Äù Bioinformatics 26 (7): 976‚Äì78. https://doi.org/10.1093/bioinformatics/btq064.",
    "crumbs": [
      "Miscellaneous topics",
      "<span class='chapter-number'>15</span>¬† <span class='chapter-title'>Useful utilities</span>"
    ]
  },
  {
    "objectID": "FAQ.html",
    "href": "FAQ.html",
    "title": "16¬† Frequently asked questions",
    "section": "",
    "text": "16.1 How to prepare your own geneList\nGSEA analysis requires a ranked gene list, which contains three features:\nIf you import your data from a csv file, the file should contains two columns, one for gene ID (no duplicated ID allowed) and another one for fold change. You can prepare your own geneList via the following command:",
    "crumbs": [
      "Appendix",
      "<span class='chapter-number'>16</span>¬† <span class='chapter-title'>Frequently asked questions</span>"
    ]
  },
  {
    "objectID": "FAQ.html#genelist",
    "href": "FAQ.html#genelist",
    "title": "16¬† Frequently asked questions",
    "section": "",
    "text": "numeric vector: fold change or other type of numerical variable\nnamed vector: every number has a name, the corresponding gene ID\nsorted vector: number should be sorted in decreasing order\n\n\nd = read.csv(your_csv_file)\n## assume 1st column is ID\n## 2nd column is FC\n\n## feature 1: numeric vector\ngeneList = d[,2]\n\n## feature 2: named vector\nnames(geneList) = as.character(d[,1])\n\n## feature 3: decreasing orde\ngeneList = sort(geneList, decreasing = TRUE)",
    "crumbs": [
      "Appendix",
      "<span class='chapter-number'>16</span>¬† <span class='chapter-title'>Frequently asked questions</span>"
    ]
  },
  {
    "objectID": "FAQ.html#no-gene-can-be-mapped",
    "href": "FAQ.html#no-gene-can-be-mapped",
    "title": "16¬† Frequently asked questions",
    "section": "\n16.2 No gene can be mapped",
    "text": "16.2 No gene can be mapped\n\nhttps://www.biostars.org/p/431270/\nhttps://github.com/YuLab-SMU/clusterProfiler/issues/280",
    "crumbs": [
      "Appendix",
      "<span class='chapter-number'>16</span>¬† <span class='chapter-title'>Frequently asked questions</span>"
    ]
  },
  {
    "objectID": "FAQ.html#showing-specific-pathways",
    "href": "FAQ.html#showing-specific-pathways",
    "title": "16¬† Frequently asked questions",
    "section": "\n16.3 Showing specific pathways",
    "text": "16.3 Showing specific pathways\nBy default, all the visualization methods provided by enrichplot display most significant pathways. If users are interested to show some specific pathways (e.g.¬†excluding some unimportant pathways among the top categories), users can pass a vector of selected pathways to the showCategory parameter in dotplot(), barplot(), treeplot(), cnetplot() and emapplot() etc.\n(ref:selectedPathsscap) Showing specific pathways.\n(ref:selectedPathscap) Showing specific pathways. Top ten most significant pathways (A), selected ten pathways (B).\n\nlibrary(DOSE)\nlibrary(enrichplot)\ndata(geneList)\nde &lt;- names(geneList)[1:100]\n\nx &lt;- enrichDO(de)\n\n## show top 10 most significant pathways and want to exclude the second one\n## dotplot(x, showCategory = x$Description[1:10][-2])\n\nset.seed(2020-10-27)\nselected_pathways &lt;- sample(x$Description, 10)\nselected_pathways\n\n [1] \"thoracic aortic aneurysm\"                \n [2] \"bronchiolitis obliterans\"                \n [3] \"stomach cancer\"                          \n [4] \"primary autosomal recessive microcephaly\"\n [5] \"aortic aneurysm\"                         \n [6] \"microcephaly\"                            \n [7] \"primary microcephaly\"                    \n [8] \"aortic disease\"                          \n [9] \"interstitial lung disease\"               \n[10] \"urinary bladder cancer\"                  \n\np1 &lt;- dotplot(x, showCategory = 10, font.size=14)\np2 &lt;- dotplot(x, showCategory = selected_pathways, font.size=14)\n\n\ncowplot::plot_grid(p1, p2, labels=LETTERS[1:2])\n\n\n\n(ref:selectedPathscap)\n\n\n\nNote: Another solution is using the filter verb to extract a subset of the result as described in Chapter 16.",
    "crumbs": [
      "Appendix",
      "<span class='chapter-number'>16</span>¬† <span class='chapter-title'>Frequently asked questions</span>"
    ]
  },
  {
    "objectID": "FAQ.html#how-to-extract-genes-of-a-specific-termpathway",
    "href": "FAQ.html#how-to-extract-genes-of-a-specific-termpathway",
    "title": "16¬† Frequently asked questions",
    "section": "\n16.4 How to extract genes of a specific term/pathway",
    "text": "16.4 How to extract genes of a specific term/pathway\n\nid &lt;- x$ID[1:3]\nid\n\n[1] \"DOID:11054\" \"DOID:2799\"  \"DOID:14004\"\n\nx[[id[1]]]\n\n[1] \"4312\" \"6280\" \"6279\" \"7153\" \"6241\" \"983\"  \"332\"  \"2146\" \"6790\"\n\ngeneInCategory(x)[id]\n\n$`DOID:11054`\n[1] \"4312\" \"6280\" \"6279\" \"7153\" \"6241\" \"983\"  \"332\"  \"2146\" \"6790\"\n\n$`DOID:2799`\n[1] \"3627\" \"6373\" \"4283\" \"3002\"\n\n$`DOID:14004`\n[1] \"4312\" \"3627\" \"4283\" \"4321\"",
    "crumbs": [
      "Appendix",
      "<span class='chapter-number'>16</span>¬† <span class='chapter-title'>Frequently asked questions</span>"
    ]
  },
  {
    "objectID": "FAQ.html#label-format",
    "href": "FAQ.html#label-format",
    "title": "16¬† Frequently asked questions",
    "section": "\n16.5 Wrap long axis labels",
    "text": "16.5 Wrap long axis labels\nMost of the functions in enrichplot can automatically split long labels across multiple lines. Users can passed a line width to the label_format parameter (default is 30). It also supports user defined function to format label strings.\n(ref:formatLabelscap) Wrap long axis labels.\n(ref:formatLabelcap) Wrap long axis labels. Passing a numeric value to specify string width (A), a user specifiable labeller function (B).\n\nlibrary(ReactomePA)\ny &lt;- enrichPathway(de)\n\np1 &lt;- dotplot(y, label_format = 20) \np2 &lt;- dotplot(y, label_format = function(x) stringr::str_wrap(x, width=20))\ncowplot::plot_grid(p1, p2, ncol=2, labels=c(\"A\", \"B\")) \n\n\n\n(ref:formatLabelcap)\n\n\n\nThe label_format option works with barplot(), dotplot(), heatplot(), treeplot and ridgeplot().",
    "crumbs": [
      "Appendix",
      "<span class='chapter-number'>16</span>¬† <span class='chapter-title'>Frequently asked questions</span>"
    ]
  }
]